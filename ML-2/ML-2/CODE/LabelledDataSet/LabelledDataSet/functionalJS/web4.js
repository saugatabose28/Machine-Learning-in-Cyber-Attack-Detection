ISQ.Widget=initializeNS("ISQ.Widget");ISQ.Widget.enumState={questions:1,autoQuestions:2,allQuestions:3,chat:4,chatSurvey:8,chatEnded:20,allChat:28,contactForm:32,customLink:64,nonChatEscalations:96,allEscalations:124};ISQ.Widget.enumMobileHandlingMode={none:0,inactive:1,normalWidget:2};ISQ.Widget.account="";ISQ.Widget.configId="";ISQ.Widget.cdcFrame="";ISQ.Widget.sendingCDCMessages=false;ISQ.Widget.cdcVersion="1";ISQ.Widget.onloadQuestion="";ISQ.Widget.onloadQuestionId="";ISQ.Widget.isFloat=false;ISQ.Widget.isContained=false;ISQ.Widget.spriteLoaded=false;ISQ.Widget.referer={normal:"",escaped:"",encoded:false};ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.userActive=false;ISQ.Widget.lastQueryKeyTime=0;ISQ.Widget.updateQueryDiff_ms=2000;ISQ.Widget.customTitle="";ISQ.Widget.customTeaserText="";ISQ.Widget.dynamicSize=false;ISQ.Widget.dynamicMaxSize=0;ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.none;ISQ.Widget.isPreview=ISQ.Http.hashArguments.preview==="true"||ISQ.Http.urlArguments.preview==="true";ISQ.Widget.reportEvents=ISQ.Http.hashArguments.reportevents==="true";ISQ.Widget.Log=initializeNS("ISQ.Widget.Log");ISQ.Widget.Log.statusEnum={RED:1,GREEN:2};ISQ.Widget.Log.openPopup=function(){if(!ISQ.Widget.Debug.enabled){return}if(ISQ.Widget.Log.window&&!ISQ.Widget.Log.window.closed){ISQ.Widget.Log.window.focus()}else{ISQ.Widget.Log.on()}};ISQ.Widget.Log.on=function(){var c=560;var b=screen.width-c-20;ISQ.Widget.Debug.enabled=false;var d=window.open("","nanoRepLog","width="+c+",height=330,left="+b+",top=0,scrollbars=yes");if(!d){return}if(!d.document){return}try{d.document.open();d.document.write("<html><title>widget log</title>");d.document.write("<body style='margin:10px; font-size:12px; font-family:arial;'>");d.document.write("<div id='logComments' style='width:95%; height:100%;'>");if(ISQ.Widget.Log.messages){d.document.write(ISQ.Widget.Log.messages.join(""));ISQ.Widget.Log.messages=null}d.document.write("</div></body></html>");d.document.close();ISQ.Widget.Log.window=d;ISQ.Widget.Log.element=d.document.getElementById("logComments");
ISQ.Widget.Debug.enabled=true;ISQ.Widget.Log.autoScroll()}catch(a){ISQ.Widget.Debug.enabled=false}};ISQ.Widget.Log.add=function(k,j){try{if(!ISQ.Widget.Debug.enabled){return}j=j||ISQ.Widget.Log.statusEnum.GREEN;var b="";if(j===ISQ.Widget.Log.statusEnum.GREEN){b="#006600"}else{if(j===ISQ.Widget.Log.statusEnum.RED){b="#BB0000";ISQ.Widget.Log.openPopup()}}var c=new Date();var h=[];h.push(c.ToString("%d/%m/%y %H:%M:%S"));h.push("  -  ");h.push(k);if(ISQ.Widget.Log.element){var g=ISQ.Widget.Log.window.document.createElement("span");g.style.color=b;g.innerHTML=h.join("");ISQ.Widget.Log.element.appendChild(g);var a=ISQ.Widget.Log.window.document.createElement("br",ISQ.Widget.Log.element);ISQ.Widget.Log.element.appendChild(a);ISQ.Widget.Log.autoScroll()}else{if(!ISQ.Widget.Log.messages){ISQ.Widget.Log.messages=[]}ISQ.Widget.Log.messages.push('<span style="color:');ISQ.Widget.Log.messages.push(b);ISQ.Widget.Log.messages.push('">');ISQ.Widget.Log.messages.push(h.join(""));ISQ.Widget.Log.messages.push("</span>");ISQ.Widget.Log.messages.push("<br/>")}}catch(f){}};ISQ.Widget.Log.autoScroll=function(){var a=ISQ.Widget.Log.window.document.body.scrollHeight;var b=ISQ.Widget.Log.window.document.body.offsetHeight;if(a>b){ISQ.Widget.Log.window.document.body.scrollTop=a-b}};ISQ.Widget.Log.element=null;ISQ.Widget.Log.window=null;ISQ.Widget.Log.alwaysOn=false;ISQ.Widget.Log.messages=null;ISQ.Widget.Debug=initializeNS("ISQ.Widget.Debug");ISQ.Widget.Debug.enabled=false;ISQ.Widget.Debug.register=function(){if(document.addEventListener){document.addEventListener("keyup",ISQ.Widget.Debug.keyUpEvent,true)}else{if(document.attachEvent){document.attachEvent("onkeyup",ISQ.Widget.Debug.keyUpEvent)}}};ISQ.Widget.Debug.keyUpEvent=function(b){var a=b||window.event;if(a.shiftKey&&a.ctrlKey){if(a.keyCode==81||a.keyCode==87){ISQ.Widget.Log.openPopup()}else{if(a.keyCode===90){ISQ.Widget.Debug.togglePopup()}}}};ISQ.Widget.Debug.togglePopup=function(){var a=_("debugPopup").style.display;if(a==="block"){_("debugPopup").style.display="none"}else{_("debugPopup").style.display="block"
}};ISQ.Widget.Debug.closeSession=function(){_session().closeSession();ISQ.Widget.Debug.togglePopup()};ISQ.Debug.insertText=function(a,b){if(!debugLevel){return}b=b||ISQ.Widget.Log.statusEnum.RED;ISQ.Widget.Log.add(a,b)};ISQ.Widget.init=function(){var debug=ISQ.Http.hashArguments.debug;if(debugLevel||(typeof(debug)!=="undefined"&&(debug==="true"||debug==="isq"))){ISQ.Widget.Debug.register();ISQ.Widget.Debug.enabled=true;if(ISQ.Widget.Log.alwaysOn){ISQ.Widget.Log.on()}}if(ISQ.Http.browser.isFF3){eval("[0,1]")}var refencoded=false;if(ISQ.Http.hashArguments.referer){ISQ.Widget.referer.normal=ISQ.Http.hashArguments.referer;ISQ.Widget.referer.encoded=ISQ.Http.hashArguments.refencoded=="true"}else{if(ISQ.Http.urlArguments.referer){ISQ.Widget.referer.normal=ISQ.Http.urlArguments.referer;ISQ.Widget.referer.encoded=ISQ.Http.urlArguments.refencoded=="true"}else{ISQ.Widget.referer.normal=""}}if(ISQ.Widget.referer.normal&&ISQ.Widget.referer.encoded){ISQ.Widget.referer.normal=ISQ.Http.Cookies.decode64(ISQ.Widget.referer.normal)}var ndx=ISQ.Widget.referer.normal.toLowerCase().indexOf("%3a");if(ndx>6||ndx===-1){ISQ.Widget.referer.escaped=escape(ISQ.Widget.referer.normal)}else{ISQ.Widget.referer.escaped=ISQ.Widget.referer.normal;ISQ.Widget.referer.normal=unescape(ISQ.Widget.referer.normal)}ISQ.Widget.account=ISQ.Http.hashArguments.account||ISQ.Http.urlArguments.account;ISQ.Widget.configId=ISQ.Http.hashArguments.configid||ISQ.Http.urlArguments.configid;ISQ.Widget.Log.add("Initiating a widget for <u>"+ISQ.Widget.account+"</u> account");ISQ.Widget.Log.add("Server URL <u>"+ISQ.Http.domain(true)+"</u>");ISQ.Widget.Log.add("Widget Referer <u>"+ISQ.Widget.referer.normal+"</u>");ISQ.Widget.cdcFrame=ISQ.Widget.getInnerFrameUrl(ISQ.Http.hashArguments.cdcframe,ISQ.Widget.referer.normal,true);if(ISQ.Widget.cdcFrame){ISQ.Widget.cdcVersion=ISQ.Http.hashArguments.cdcversion||"1"}ISQ.Widget.splitTestGroup=ISQ.Http.hashArguments.splittestgroup;ISQ.Widget.isFloat=ISQ.Http.hashArguments.isfloat==="true";ISQ.Widget.dynamicSize=!ISQ.Widget.isFloat&&ISQ.Http.hashArguments.dynamicsize==="true";
ISQ.Widget.dynamicMaxSize=parseInt(ISQ.Http.hashArguments.dynamicmaxsize)||0;if(isNaN(ISQ.Widget.dynamicMaxSize)){ISQ.Widget.dynamicMaxSize=0}ISQ.Widget.HTML.Mobile.adjustableEmbedWidth=ISQ.Http.browser.isMobile&&!ISQ.Http.browser.oldAndroid&&!ISQ.Widget.isFloat&&window.top!==window;ISQ.Widget.sendingCDCMessages=window.top!==window&&(ISQ.Widget.supportsPostMessage||(ISQ.Widget.cdcFrame&&(ISQ.Widget.dynamicSize||ISQ.Widget.isFloat)));ISQ.Widget.CDC.init();var resetCDC=ISQ.Http.Cookies._read("resetcdc");if(resetCDC==="1"){ISQ.Http.Cookies._delete("resetcdc","/widget",ISQ.Http.domain());ISQ.Widget.CDC.sendMessage("subject=reset")}if(!ISQ.Widget.Protocol.init()){return}ISQ.Widget.Cnf.load();var htmlCollapseHeight=ISQ.Http.hashArguments.htmlcollapseheight;if(typeof(htmlCollapseHeight)!=="undefined"){ISQ.Widget.HTML.htmlCollapseHeight=parseInt(htmlCollapseHeight)}_("footerNanoRepLink").href=ISQ.Widget.buildNRLinkUrl(ISQ.Widget.account,ISQ.Widget.referer.normal,ISQ.Widget.isFloat?"float":"embed")};ISQ.Widget.pageUnload=function(){ISQ.Widget.Chat.pageUnload();if(ISQ.Widget.Log.element){ISQ.Widget.Log.element.innerHTML=""}};ISQ.Widget.Cnf=initializeNS("ISQ.Widget.Cnf");ISQ.Widget.Cnf.load=function(){if(ISQ.Widget.supportsPostMessage&&(window.top!==window&&self!==self.top)&&ISQ.Http.hashArguments.cnf=="true"){ISQ.Widget.isContained=true;ISQ.Cnf=null;ISQ.Widget.CDC.sendMessage("subject=cnf")}else{var b=ISQ.Http.hashArguments.kb||ISQ.Http.urlArguments.kb;var a=!ISQ.Widget.supportsPostMessage&&window.top!==window;ISQ.Tools.FileLoader.load(ISQ.Widget.buildCNFSource(null,ISQ.Widget.account,ISQ.Widget.isFloat,b,ISQ.Widget.referer.escaped,a,ISQ.Widget.splitTestGroup),new ISQ.Handler(function(){setTimeout(function(){if(ISQ.Widget.isFloat){ISQ.Cnf=ISQ.Cnf_Float}else{ISQ.Cnf=ISQ.Cnf_Embed}ISQ.Widget.Cnf.postDownload()},0)}))}};ISQ.Widget.Cnf.postDownload=function(){ISQ.Widget.loadHandler(true)};ISQ.Widget.EndUserTracking=initializeNS("ISQ.Widget.EndUserTracking");ISQ.Widget.EndUserTracking.init=function(){var cookieVal;var hasValue;ISQ.Cnf.endUserTracking=eval("("+ISQ.Cnf.endUserTracking+")");
iteration(ISQ.Cnf.endUserTracking,function(item){hasValue=false;if(item.type==="kb"){cookieVal=ISQ.Http.Cookies._read(item.id);if(cookieVal){ISQ.Widget.EndUserTracking.deleteCookie(item.id);ISQ.Tools.Storage.set(item.id,cookieVal)}}else{if(item.type==="conv"){var lcObject={};cookieVal=ISQ.Http.Cookies._read(item.id);if(cookieVal){hasValue=true;lcObject.traffic=cookieVal;ISQ.Widget.EndUserTracking.deleteCookie(item.id)}iteration(item.s,function(stepId){cookieVal=ISQ.Http.Cookies._read(stepId);if(cookieVal){hasValue=true;lcObject.stepId=cookieVal;ISQ.Widget.EndUserTracking.deleteCookie(stepId)}});delete item.s;if(hasValue){ISQ.Tools.Storage.set(item.id,ISQ.Data.jsonToString(lcObject))}}}})};ISQ.Widget.EndUserTracking.trackUser=function(){_session().trackUser(new ISQ.Handler(ISQ.Widget.EndUserTracking.trackUserResponse))};ISQ.Widget.EndUserTracking.trackUserResponse=function(a){};ISQ.Widget.EndUserTracking.parseResponse=function(){};ISQ.Widget.EndUserTracking.appendToRequest=function(a){iteration(ISQ.Cnf.endUserTracking,function(b){b.data=ISQ.Tools.Storage.get(b.id)});a.push(ISQ.Data.jsonToString(ISQ.Cnf.endUserTracking))};ISQ.Widget.EndUserTracking.deleteCookie=function(a){ISQ.Http.Cookies._delete(a,"/",ISQ.Http.domain(false),false)};ISQ.Widget.Css=initializeNS("ISQ.Widget.Css");ISQ.Widget.Css.RTL_CSS_identifier="html.rtl_css_file";ISQ.Widget.Css.dynamic_RTL_CSS_identifier="html.dynamic_rtl_css_file";ISQ.Widget.loadHandler=function(loadFAQ){if(ISQ.Widget.isFloat&&ISQ.Cnf.limited){return}var ctxStr=ISQ.Http.hashArguments.context;if(ctxStr){var contextObject={};var ctxSplit=ctxStr.split(",");iteration(ctxSplit,function(item){var itemSplit=item.split(":");if(itemSplit.length!=2){return}contextObject[itemSplit[0]]=itemSplit[1]});ISQ.Widget.API.updateContext(contextObject,true)}var newContexts=ISQ.Widget.combineContext(ISQ.Cnf.contextAttributes,_session().mContexts,ISQ.Widget.API.getCustomParams());if(newContexts){if(ISQ.Http.browser.isMobile){var tmp=[];ISQ.Widget.CDC_appendKeyValueToMessage(newContexts,tmp);ISQ.Widget.HTML.Mobile.context=tmp.join("")
}if(!ISQ.Http.browser.isMobile||ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){ISQ.Widget.API.updateContext(newContexts,false)}}if(loadFAQ){ISQ.Widget.FAQ.handleCnfData()}var size=ISQ.Html.screenSize();if(size.h===0&&(ISQ.Http.browser.isMobile||!ISQ.Widget.isFloat||!ISQ.Http.browser.isIE7)){setTimeout(ISQ.Widget.loadHandler,10);return}ISQ.Widget.addCssStyles(ISQ.Cnf.skinCSS);ISQ.Widget.addCssStyles(ISQ.Cnf.skinCSS_rtl);ISQ.Widget.addCssStyles(ISQ.Cnf.skinCSS_unescaped);if(typeof(ISQ.Cnf.customCSS)==="string"){var customCssProcessed=false;var ndx=ISQ.Cnf.customCSS.indexOf("@import");if(ndx!==-1&&!ISQ.Http.browser.isAndroid){var customCssErr=false;var customCSS=[];var endNdx=-1;var imports=[];do{customCSS.push(ISQ.Cnf.customCSS.substring(0,ndx));ndx=ISQ.Cnf.customCSS.indexOf("(",ndx);if(ndx===-1){customCssErr=true;break}endNdx=ISQ.Cnf.customCSS.indexOf(")",ndx);if(endNdx===-1){customCssErr=true;break}imports.push(ISQ.Cnf.customCSS.substring(ndx+2,endNdx-1));endNdx=ISQ.Cnf.customCSS.indexOf(";",endNdx);if(endNdx++===-1){customCssErr=true;break}ndx=ISQ.Cnf.customCSS.indexOf("@import",endNdx)}while(ndx!==-1);if(!customCssErr){if(endNdx!==ISQ.Cnf.customCSS.length){customCSS.push(ISQ.Cnf.customCSS.substring(endNdx))}ISQ.CSS.addNewStyle(customCSS.join(""));customCssProcessed=true;for(i=0;i<imports.length;++i){var lnk=createElement("link");lnk.rel="stylesheet";lnk.setAttribute("rel","stylesheet");lnk.href=imports[i];lnk.setAttribute("href",imports[i]);document.getElementsByTagName("HEAD")[0].appendChild(lnk)}}}if(!customCssProcessed){ISQ.CSS.addNewStyle(ISQ.Cnf.customCSS)}}if(ISQ.Cnf.applyLabelToTickets){var parts=ISQ.Cnf.applyLabelToTickets.split(",");for(i=0;i<parts.length;i++){ISQ.Widget.ContactForm.reportPreDefinedValue("label_"+parts[i],parts[i],"label")}}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){setTimeout(function(){document.body.style.position="relative";document.body.style.left=0;document.body.style.top=0},0)}ISQ.Widget.Localize={};if(!ISQ.Cnf.ignoreScriptCustomValues){if(ISQ.Http.hashArguments.languagecode){ISQ.Cnf.initialUiLanguage=ISQ.Tools.getUniformLanguageCode(ISQ.Http.hashArguments.languagecode)
}else{if(ISQ.Http.urlArguments.languagecode){ISQ.Cnf.initialUiLanguage=ISQ.Tools.getUniformLanguageCode(ISQ.Http.urlArguments.languagecode)}}}if(!ISQ.Cnf.initialUiLanguage){if(ISQ.Cnf.uiLanguageCode){ISQ.Cnf.initialUiLanguage=ISQ.Cnf.uiLanguageCode}else{ISQ.Cnf.initialUiLanguage=ISQ.Cnf.kbLanguageCode}}nanoRep.FAQ.init(ISQ.Cnf.initialUiLanguage,window.location.protocol+"//"+ISQ.Http.domain(true));ISQ.Widget.Localize.array=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage];if(!ISQ.Widget.Localize.array){ISQ.Cnf.initialUiLanguage="en";ISQ.Widget.Localize.array=ISQ.Widget.Texts.en}ISQ.Cnf.currentUiLanguage=ISQ.Cnf.initialUiLanguage;ISQ.Widget.Log.add("<b>UI</b> Language code:<u>"+ISQ.Cnf.currentUiLanguage+"</u>");ISQ.Widget.Log.add("<b>KB</b> Language code:<u>"+ISQ.Cnf.kbLanguageCode+"</u>");if(ISQ.Widget.Localize.array.dir!=="rtl"){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,false);ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,false);ISQ.Widget.HTML.dynamicRTLCssLoaded=false}if(ISQ.Http.browser.app==="chrome"){window.onbeforeunload=ISQ.Widget.pageUnload}else{window.onunload=ISQ.Widget.pageUnload}ISQ.Widget.HTML.setPointers();ISQ.Widget.HTML.enablePIE();_("txtChatInput").value="";ISQ.Widget.HTML.queryField.value="";if(ISQ.Http.browser.isIPad||ISQ.Http.browser.isIPhone){ISQ.Widget.HTML.queryField.className+=" apple"}if(window.top===window){ISQ.CSS.addClass(_("widgetContainer"),"fullScreen")}if(!ISQ.Cnf.ignoreScriptCustomValues){if(ISQ.Http.hashArguments.bgcolor||ISQ.Http.urlArguments.bgcolor){var color;if(ISQ.Http.hashArguments.bgcolor){color=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.bgcolor)}else{color=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.bgcolor)}_("widgetTitleWrapper").style.backgroundColor=color;ISQ.Widget.HTML.footerWrapper.style.backgroundColor=color;_("widgetMinimizedFooter").style.backgroundColor=color}if(ISQ.Http.hashArguments.teaser){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.teaser)}else{if(ISQ.Http.urlArguments.teaser){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.teaser)
}}if(ISQ.Http.hashArguments.title){ISQ.Widget.customTitle=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.title)}else{if(ISQ.Http.urlArguments.title){ISQ.Widget.customTitle=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.title)}}if(ISQ.Http.hashArguments.color){_("widgetTitleText").style.color=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.color)}else{if(ISQ.Http.urlArguments.color){_("widgetTitleText").style.color=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.color)}}}ISQ.Widget.HTML.widgetContainer.style.display="block";_("widgetLoading").style.display="none";ISQ.Widget.setInitialTexts();if(ISQ.Cnf.floatTeaser_width){ISQ.Cnf.floatTeaser_WidgetSize[0]=ISQ.Cnf.floatTeaser_width}if(!ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="none"}var footerResult=ISQ.Data.getDBAnswerAsHtml(ISQ.Cnf.answerFooter,true,null,null,null,ISQ.Widget.referer.normal);ISQ.Cnf.answerFooter=footerResult.text;ISQ.Cnf.answerFooterScript=footerResult.script;if(ISQ.Cnf.translationEnabled){var staticTexts=[ISQ.Cnf.answerFooter,ISQ.Widget.Localize.array.searchMsgNOResults,ISQ.Widget.Localize.array.searchMsgResults,ISQ.Widget.Localize.array.newSearch,ISQ.Widget.Localize.array.askBy,ISQ.Widget.Localize.array.email,ISQ.Widget.Localize.array.chat,"Translating","Translated from "+ISQ.Tools.getLanguageName(ISQ.Cnf.kbLanguageCode)+", click to turn on or off"];try{var apiKeys=eval("({"+ISQ.Cnf.translationApiKey+"})");ISQ.Widget.TranslationHelper.init(staticTexts,ISQ.Cnf.kbLanguageCode,apiKeys,ISQ.Cnf.translationLanguages);ISQ.Translation.Infra.failureEvent.addHandler(ISQ.Widget.Translation.translationFailedHandler)}catch(ex){ISQ.Widget.Log.add("Exception initializing translations: "+ex,ISQ.Widget.Log.statusEnum.RED);ISQ.Cnf.translationEnabled=false}}if(ISQ.Widget.isFloat&&ISQ.Cnf.customerBrandingLogo&&ISQ.CSS.getElementStyle(_("customerLogo"),"visibility")!=="hidden"){var img=new Image();img.onload=function(){this.loaded=true;ISQ.Widget.onCustomerLogoLoad()};ISQ.Cnf.customerBrandingLogo_img=img;img.src=ISQ.Cnf.customerBrandingLogo;ISQ.Cnf.customerBrandingLogo_img.loaded=false
}else{ISQ.Cnf.customerBrandingLogo=null}ISQ.Widget.HTML.Mobile.setMode();ISQ.Widget.Query.init();if(ISQ.Cnf.limited){ISQ.Widget.HTML.limitedMode()}else{if(ISQ.Http.hashArguments.chatenabled){ISQ.Cnf.chatEnabled&=(ISQ.Http.hashArguments.chatenabled.toLowerCase()==="true")}if(ISQ.Cnf.chatConfiguration&&ISQ.Cnf.chatEnabled&&ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.inactive){ISQ.Widget.Chat.init()}if(((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)&&!ISQ.Widget.onloadQuestion&&!ISQ.Widget.onloadQuestionId&&ISQ.Cnf.autoQuestions){ISQ.Widget.AutoQuestions.init(ISQ.Cnf.autoQuestions,ISQ.Cnf.autoQuestionsInterval,ISQ.Cnf.repeatAutoQuestions)}var initialText=ISQ.Cnf.initialText||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId;if(initialText&&((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)){ISQ.Widget.HTML.queryField.className+=" initialText";ISQ.Widget.HTML.queryField.value=ISQ.Cnf.initialText;ISQ.Widget.HTML.queryField.setAttribute("arial-lable",initialText)}if(ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions||initialText){ISQ.Widget.Query.setFocus()}if(ISQ.Http.hashArguments.onloadquestion){ISQ.Widget.onloadQuestion=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.onloadquestion)}else{if(ISQ.Http.urlArguments.onloadquestion){ISQ.Widget.onloadQuestion=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.onloadquestion)}}if(ISQ.Http.hashArguments.onloadquestionid){ISQ.Widget.onloadQuestionId=ISQ.Http.hashArguments.onloadquestionid;if(((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)&&ISQ.Widget.onloadQuestionId){ISQ.Widget.state=ISQ.Widget.enumState.questions}}else{if(ISQ.Http.urlArguments.onloadquestionid){ISQ.Widget.onloadQuestionId=ISQ.Http.urlArguments.onloadquestionid;if(((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)&&ISQ.Widget.onloadQuestionId){ISQ.Widget.state=ISQ.Widget.enumState.questions}}else{if(((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)&&ISQ.Cnf.onloadQuestionId&&ISQ.Cnf.onloadQuestionId!="-1"){ISQ.Widget.onloadQuestionId=ISQ.Cnf.onloadQuestionId;
ISQ.Widget.state=ISQ.Widget.enumState.autoQuestions}else{if(((ISQ.Widget.state&ISQ.Widget.enumState.allChat)==0)&&(!ISQ.Widget.isFloat||ISQ.Http.browser.isMobile)&&!ISQ.Cnf.autoQuestions){ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnWidgetLoad)}}}}}ISQ.Widget.HTML.resizeHandler();if(ISQ.Cnf.hideBranding){_("footerNanoRepLink").style.display="none";_("logoInCollapsedMode").style.display="none"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="block";_("customerBrandingText").innerHTML=ISQ.Cnf.customerBrandingText}if(ISQ.Cnf.hideByEmailIcon){_("repByEmail").className="noActionBarIcon"}if(ISQ.Cnf.faqWidgetConfig&&ISQ.Cnf.faqWidgetConfig!="[]"){_("footerNanoRepLink").style.visibility="hidden";ISQ.Widget.HTML.widgetFooter.className="widgetFooter"}if(!ISQ.Http.browser.isIE6&&(!ISQ.Http.browser.usesViewport||ISQ.Http.browser.isIOS7)){ISQ.Html.ReSize.init(ISQ.Html.ReSize.enumListenTo.both,true);var lastTime=0;var prevSize={w:0,h:0};var ignoreNext=false;var ios7SizeFix=ISQ.Http.browser.isIOS7&&!ISQ.Widget.isFloat&&window!==window.top;ISQ.Html.ReSize.Event.addHandler(function(){if(ios7SizeFix){viewportSize=ISQ.Html.screenSize();var now=new Date().getTime();if(ignoreNext&&viewportSize.h<prevSize.h){lastTime=now;if(now-lastTime<100){return}}prevSize=viewportSize;ignoreNext=false;lastTime=now}ISQ.Widget.HTML.resizeHandler(null,true);if(ios7SizeFix){ignoreNext=true}})}else{if(ISQ.Http.browser.isTablet||ISQ.Http.browser.isIE6||ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){setInterval(ISQ.Widget.HTML.resizePollingHandler,20)}if(!ISQ.Http.browser.isIE6&&ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.inactive){window.addEventListener("orientationchange",ISQ.Widget.HTML.Mobile.orientationChanged)}}var notifyClick=ISQ.Http.hashArguments.notifyclick||false;if(notifyClick==="true"&&!ISQ.Http.browser.isMobile){if(!ISQ.Http.browser.isTablet){document.onclick=function(){if(ISQ.Widget.HTML.ignoreNextClickEvent){ISQ.Widget.HTML.ignoreNextClickEvent=false;return}if(ISQ.Http.browser.isIE6){setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=click")
},0)}else{ISQ.Widget.CDC.sendMessage("subject=click")}}}else{_("chatStatusWrapper").addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")});_("widgetTitleWrapper").addEventListener("click",function(evt){if(ISQ.Widget.HTML.Mobile.ignoreClickEvent){ISQ.Widget.HTML.Mobile.ignoreClickEvent=false;return}ISQ.Widget.CDC.sendMessage("subject=click")});ISQ.Widget.HTML.queryField.addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")});_("contentAreaWrapper").addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")});_("actionBarWrapper").addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")})}}if(ISQ.Cnf.answerPeeksEnabled){if(document.addEventListener){ISQ.Widget.HTML.contentWrapper.addEventListener("scroll",ISQ.Widget.Query.contentWrapperScroll)}else{if(document.attachEvent){ISQ.Widget.HTML.contentWrapper.attachEvent("onscroll",ISQ.Widget.Query.contentWrapperScroll)}}}if(ISQ.Widget.sendingCDCMessages){var msg=null;if(ISQ.Widget.isFloat){msg="subject=load";if(typeof(ISQ.Cnf.dockRTL)!=="undefined"){msg+="&dockrtl="+ISQ.Cnf.dockRTL}if(ISQ.Cnf.floatOpenOnLoad===true||ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!=0)||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId){msg+="&stateonload=";if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!=0){msg+="chat"}else{if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId){msg+="expand"}else{if(ISQ.Cnf.floatOpenOnLoad===true){msg+="collapse"}else{msg+="teaser"}}}}if(typeof(ISQ.Cnf.floatAutoMinimizeTimeout)!=="undefined"&&ISQ.Widget.state!==ISQ.Widget.enumState.chat&&!ISQ.Widget.onloadQuestion&&!ISQ.Widget.onloadQuestionId){msg+="&autominimize="+ISQ.Cnf.floatAutoMinimizeTimeout}if(typeof(ISQ.Cnf.floatOpenOnHover)!=="undefined"){msg+="&openonhover="+ISQ.Cnf.floatOpenOnHover}if(ISQ.Cnf.titleTeaserText){msg+="&teasertext="+ISQ.Http.Cookies.encode64(ISQ.Cnf.titleTeaserText)
}if(ISQ.Cnf.generatedTeaser_textFont){msg+="&teaserfont="+ISQ.Http.Cookies.encode64(ISQ.Cnf.generatedTeaser_textFont)}if(ISQ.Cnf.titleColor){msg+="&teasercolor="+ISQ.Http.Cookies.encode64(ISQ.Cnf.titleColor)}msg+="&teaserdir="+ISQ.Widget.Localize.array.dir;if(ISQ.Cnf.generatedTeaser_textPosition){msg+="&teaserposition="+ISQ.Cnf.generatedTeaser_textPosition[0]+","+ISQ.Cnf.generatedTeaser_textPosition[1]}if(ISQ.Cnf.generatedTeaser_textSize){msg+="&teasersize="+ISQ.Cnf.generatedTeaser_textSize[0]+","+ISQ.Cnf.generatedTeaser_textSize[1]}if(ISQ.Cnf.floatMarginSide){msg+="&marginside="+ISQ.Cnf.floatMarginSide}if(ISQ.Cnf.floatMarginBottom){msg+="&marginbottom="+ISQ.Cnf.floatMarginBottom}if(ISQ.Cnf.floatTeaser_width){msg+="&teaserwidth="+ISQ.Cnf.floatTeaser_width}if(ISQ.Cnf.containerBoxShadow){msg+="&containerBoxShadow="+ISQ.Http.Cookies.encode64(ISQ.Cnf.containerBoxShadow)}if(ISQ.Cnf.ignoreScriptCustomValues){msg+="&ignorescriptcustomvalues="+ISQ.Cnf.ignoreScriptCustomValues}ISQ.Widget.CDC.sendMessage(msg)}else{if(ISQ.Widget.dynamicSize){ISQ.Widget.HTML.dynamicSize_sendMessage()}}}ISQ.Widget.reportEvents|=(ISQ.Cnf.integrateWithGA===true);if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=load&integrate_ga="+(ISQ.Cnf.integrateWithGA===true))}if(!ISQ.Cnf.limited){if(ISQ.Widget.onloadQuestion){ISQ.Widget.state=ISQ.Widget.enumState.questions;if(ISQ.Cnf.autoQuestionsTypeEffect){ISQ.Widget.Query.typeTimer=new ISQ.Timer(new ISQ.Handler(ISQ.Widget.Query.typeQuestion),false,ISQ.Widget.onloadQuestion,0);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval)}else{ISQ.Widget.HTML.queryField.value=ISQ.Widget.onloadQuestion}ISQ.Widget.Query.analyzeQuery(ISQ.Widget.onloadQuestion,ISQ.Widget.Query.enumTextQuerySource.linkedAnswer);ISQ.Widget.Query.clearTextboxOnInteraction=true}else{if(ISQ.Widget.onloadQuestionId){ISQ.Widget.Query.tempQuestionTrailId=ISQ.Widget.onloadQuestionId;ISQ.Widget.Query.getAnswerById(ISQ.Widget.onloadQuestionId,false,"onload");ISQ.Widget.Query.clearTextboxOnInteraction=true}else{if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.go()
}}}}};ISQ.Widget.setUiLanguage=function(b){b=b||ISQ.Cnf.currentUiLanguage;var a=ISQ.Translation.Infra.getLanguageDirection(b);if(a==="rtl"&&!ISQ.Widget.HTML.dynamicRTLCssLoaded){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,true);ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,true);ISQ.Widget.HTML.dynamicRTLCssLoaded=true;if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=directionchanged&rtl=true")}}else{if(a==="ltr"&&ISQ.Widget.HTML.dynamicRTLCssLoaded){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,false);ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,false);ISQ.Widget.HTML.dynamicRTLCssLoaded=false;if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=directionchanged&rtl=false")}}}if(ISQ.Cnf.currentUiLanguage===b){return}if(ISQ.Widget.Texts[b]){ISQ.Cnf.currentUiLanguage=b;ISQ.Widget.Localize.array=ISQ.Widget.Texts[b];return}if(ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage]){ISQ.Cnf.currentUiLanguage=ISQ.Cnf.initialUiLanguage;ISQ.Widget.Localize.array=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage];return}ISQ.Cnf.currentUiLanguage="en";ISQ.Widget.Localize.array=ISQ.Widget.Texts.en};ISQ.Widget.HTML={};ISQ.Widget.HTML.setPointers=function(){ISQ.Widget.HTML.widgetContainer=_("widgetContainer");ISQ.Widget.HTML.queryField=_("txtSearch");ISQ.Widget.HTML.searchContainer=_("searchContainer");ISQ.Widget.HTML.answerPane=_("answerPane");ISQ.Widget.HTML.chatPane=_("chatPane");ISQ.Widget.HTML.contentWrapper=_("contentAreaWrapper");ISQ.Widget.HTML.contentArea=_("contentArea");ISQ.Widget.HTML.titleWrapper=_("widgetTitleWrapper");ISQ.Widget.HTML.titleText=_("widgetTitleText");ISQ.Widget.HTML.actionBarWrapper=_("actionBarWrapper");ISQ.Widget.HTML.actionBarContainer=_("actionBarContainer");ISQ.Widget.HTML.actionBarQuery=_("actionBarQuery");ISQ.Widget.HTML.contactForm=_("contactForm");ISQ.Widget.HTML.searchWrapper=_("searchContainerWrapper");ISQ.Widget.HTML.chatStatus=_("chatStatus");ISQ.Widget.HTML.chatInputWrapper=_("chatInputWrapper");ISQ.Widget.HTML.txtEmailChat=_("txtEmailChat");
ISQ.Widget.HTML.footerWrapper=_("widgetFooterWrapper");ISQ.Widget.HTML.widgetFooter=_("widgetFooter")};ISQ.Widget.HTML.fixBrandingColor=function(){var e=ISQ.Widget.HTML.footerWrapper;var b=ISQ.CSS.getSelectorStyle("#widgetFooterWrapper");if(!b){return}var c=ISQ.Tools.stringToPairArray(b.cssText,":",";",true,true);if(c.display==="none"||c.visibility==="hidden"){return}var a=b.backgroundColor;if(!a){a=b["background-color"]}alert(a)};ISQ.Widget.HTML.Mobile={};ISQ.Widget.HTML.Mobile.ignoreClickEvent=false;ISQ.Widget.HTML.Mobile.formPredefinedData=null;ISQ.Widget.HTML.Mobile.context=null;ISQ.Widget.HTML.Mobile.positionSet=false;ISQ.Widget.HTML.Mobile.incrementedBottom=0;ISQ.Widget.HTML.Mobile.incrementedBottom_withChat=0;ISQ.Widget.HTML.Mobile.adjustableEmbedWidth=null;ISQ.Widget.HTML.Mobile.setMode=function(){if(!ISQ.Http.browser.isMobile){return}document.body.style.webkitTextSizeAdjust="100%";if(ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.normalWidget;ISQ.Widget.HTML.Mobile.setWidths();return}ISQ.Http.Cookies._delete("nouserstats","/",ISQ.Http.domain(false),false);if(window.top===window){ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.normalWidget;document.body.parentNode.style.overflow="visible";document.body.parentNode.style.height="auto";document.body.style.overflow="visible";document.body.style.height="auto";ISQ.Widget.HTML.contentWrapper.style.overflow="visible";ISQ.Widget.HTML.contentWrapper.style.overflowY="visible";ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.queryField.style.display="block";ISQ.Widget.setTitle();_("minimizeButtonWrapper").style.display="none";var a=null;if(window.localStorage&&!ISQ.Http.browser.isIOS7){a=window.localStorage.getItem("nanorep.api."+ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped))}if(!a){a=ISQ.Http.Cookies._readCaseSensitive(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped));if(a){ISQ.Http.Cookies._delete(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),"/widget",ISQ.Http.domain(false),false)
}}if(a){var a=ISQ.Tools.stringToPairArray(unescape(a),"=","&",false,false);if(a.f){ISQ.WebForms.PreviewContact.incomingPreDefinedValuesFromMessage(a.f)}if(a.c){_session().setContext(ISQ.Widget.CDC_getKeyValueArrayFromMessage(a.c))}}ISQ.Widget.HTML.Mobile.setWidths();ISQ.Widget.HTML.Mobile.setPositions()}else{ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.inactive;ISQ.Widget.HTML.queryField.onclick=null;_("minimizeButtonWrapper").style.display="block";ISQ.Widget.HTML.showMinimizeIcon();_("txtSearch").disabled=true}};ISQ.Widget.HTML.Mobile.orientationChanged=function(){var a=ISQ.Html.screenSize();if(a.h==ISQ.Widget.HTML.currentHeight||a.w===ISQ.Widget.HTML.currentWidth){setTimeout(ISQ.Widget.HTML.Mobile.orientationChanged,20);return}ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.resizeHandler(a,true);ISQ.Widget.Query.resizeAnswerElements()};ISQ.Widget.HTML.Mobile.setPositions=function(){if(ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget||ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){return}if(ISQ.Cnf.customerBrandingLogo&&(!ISQ.Cnf.customerBrandingLogo_img||!ISQ.Cnf.customerBrandingLogo_img.loaded)){return}if(ISQ.Widget.HTML.Mobile.positionSet){return}ISQ.Widget.HTML.Mobile.positionSet=true;var b=new Array();b.push(ISQ.Widget.HTML.footerWrapper);b.push(_("actionBarWrapper"));b.push(_("chatInputWrapper"));iteration(b,function(f){f.style.position="fixed";f.style.zIndex=1;f.style.bottom=ISQ.Widget.HTML.Mobile.incrementedBottom+"px";f.style.width="100%";ISQ.Widget.HTML.Mobile.incrementedBottom+=ISQ.CSS.getElementHeight(f,true);if(ISQ.CSS.getElementStyle(f,"display")==="none"){f.style.display="none"}});ISQ.Widget.HTML.Mobile.incrementedBottom_withChat=ISQ.Widget.HTML.Mobile.incrementedBottom;_("chatInputWrapper").style.display="block";ISQ.Widget.HTML.Mobile.incrementedBottom_withChat+=ISQ.CSS.getElementHeight(_("chatInputWrapper"),true);_("chatInputWrapper").style.display="none";if(window==window.top){ISQ.Widget.HTML.contentWrapper.style.minHeight=(window.outerHeight+ISQ.Widget.HTML.Mobile.incrementedBottom)+"px"
}var c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.footerWrapper,"background-color");var d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.footerWrapper,"opacity");if(ISQ.Tools.getOpacityFromRGBA(c)===0||d===0){var a=ISQ.CSS.getElementStyle(document.body,"background-color");if(ISQ.Tools.getOpacityFromRGBA(a)===0){ISQ.Widget.HTML.footerWrapper.style.backgroundColor="#fff"}else{ISQ.Widget.HTML.footerWrapper.style.backgroundColor=a}}if(ISQ.Http.browser.oldAndroid){var e=null;window.addEventListener("touchmove",function(){iteration(b,function(f){if(f.style.display!=="none"){f.style.display="none";f.toShow=true}});clearTimeout(e)});window.addEventListener("touchend",function(){clearTimeout(e);e=setTimeout(function(){iteration(b,function(f){if(f.toShow){f.style.display="block"}f.toShow=false})},200)})}if(ISQ.Http.browser.isIPhone){window.addEventListener("touchstart",function(){ISQ.Widget.HTML.queryField.blur()})}ISQ.Widget.HTML.Mobile.setScrollPaddingHeight()};ISQ.Widget.HTML.Mobile.setScrollPaddingHeight=function(a){if(ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget||ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){return}_("mobileScrollPadding").style.display="block";var b;if(a){b=ISQ.Widget.HTML.Mobile.incrementedBottom_withChat}else{b=ISQ.Widget.HTML.Mobile.incrementedBottom}_("mobileScrollPadding").style.height=b+"px"};ISQ.Widget.HTML.Mobile.beforeOpeningWidget=function(){ISQ.Http.Cookies._write("nouserstats","1","/",ISQ.Http.domain(false),false);var a=[];if(ISQ.Widget.HTML.Mobile.formPredefinedData){a.push("f=");a.push(ISQ.Widget.HTML.Mobile.formPredefinedData)}if(ISQ.Widget.HTML.Mobile.context){if(a.length!==0){a.push("&")}a.push("c=");a.push(ISQ.Widget.HTML.Mobile.context)}if(a.length===0){return}if(window.localStorage&&!ISQ.Http.browser.isIOS7){window.localStorage.setItem("nanorep.api."+ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),a.join(""))}else{ISQ.Http.Cookies._write(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),a.join(""),"/widget",ISQ.Http.domain(false),false)}};ISQ.Widget.HTML.Mobile.hideAddressbar=function(a){if(ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget){return
}setTimeout(function(){window.scrollTo(0,1)},a||0)};ISQ.Widget.HTML.Mobile.setWidths=function(a){if(!ISQ.Http.browser.usesViewport){return}if(ISQ.Widget.HTML.currentlyResizing&&!a){return}if(ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget){return}var b;b=ISQ.CSS.getElementWidth(_("widgetTitleWrapper"),true);b-=ISQ.CSS.getElementWidth(_("widgetTitleLeft"),true);b-=ISQ.CSS.getElementWidth(_("widgetTitleRight"),true);b-=ISQ.CSS.getElementWidth(_("minimizeButtonWrapper"),true);ISQ.CSS.setWidthIncludingPadding(ISQ.Widget.HTML.titleText,b-20);if(_("searchContainer").offsetWidth!==0&&ISQ.Widget.HTML.searchContainer.firstChild!==null){b=ISQ.CSS.getElementWidth(_("searchContainerWrapper"),true);ISQ.CSS.setWidthIncludingPadding(_("txtSearch"),b-20);b-=ISQ.CSS.getElementWidth(_("searchContainerLeft"),true);ISQ.Widget.HTML.searchContainer.firstChild.style.display="block";b-=ISQ.CSS.getElementWidth(ISQ.Widget.HTML.searchContainer.firstChild,true);b-=ISQ.CSS.getElementWidth(_("searchContainerRight"),true);b-=ISQ.CSS.getHorizonalMargin(_("txtSearch"));ISQ.CSS.setWidthIncludingPadding(_("txtSearch"),b-20);ISQ.Widget.HTML.searchContainer.firstChild.style.display="none"}if(_("chatStatusContainer").offsetWidth!==0){b=ISQ.CSS.getElementWidth(_("chatStatusContainer"),true);b-=ISQ.CSS.getElementWidth(_("chatStatusIcon"),true);b-=ISQ.CSS.getElementWidth(_("closeChat"),true);b-=ISQ.CSS.getHorizonalMargin(_("chatStatus"));ISQ.CSS.setWidthIncludingPadding(_("chatStatus"),b-20)}if(_("chatInputContainer").offsetWidth!==0){b=ISQ.CSS.getElementWidth(_("chatInputContainer"),true);b-=ISQ.CSS.getElementWidth(_("btnSendChat"),true);b-=ISQ.CSS.getHorizonalMargin(_("btnSendChat"));b-=ISQ.CSS.getHorizonalMargin(_("txtChatInput"));ISQ.CSS.setWidthIncludingPadding(_("txtChatInput"),b-40)}};ISQ.Widget.HTML.enablePIE=function(){if(!ISQ.Http.browser.isIE6&&!ISQ.Http.browser.isIE7&&!ISQ.Http.browser.isIE8){return}if(typeof(ISQ.Cnf.roundedCornersIEEnabled)!=="undefined"&&!ISQ.Cnf.roundedCornersIEEnabled){return
}if(ISQ.Http.browser.isIE6&&!ISQ.Widget.isFloat){return}if(ISQ.Http.browser.isIE6&&window.location.href.startsWith("https://")){return}PIE_init();if(typeof(PIE)==="undefined"){return}setTimeout(function(){PIE.attach(ISQ.Widget.HTML.titleWrapper)},0);setTimeout(function(){PIE.attach(ISQ.Widget.HTML.footerWrapper)},0);setTimeout(function(){PIE.attach(_("widgetMinimizedFooter"))},0);setTimeout(function(){PIE.attach(_("searchContainer"))},0);setTimeout(function(){PIE.attach(_("actionBarWrapper"))},0)};ISQ.Widget.HTML.disablePIE=function(){if(!ISQ.Http.browser.isIE6&&!ISQ.Http.browser.isIE7&&!ISQ.Http.browser.isIE8){return}if(typeof(ISQ.Cnf.roundedCornersIEEnabled)!=="undefined"&&!ISQ.Cnf.roundedCornersIEEnabled){return}if(typeof(PIE)==="undefined"){return}if(ISQ.Http.browser.isIE6&&!ISQ.Widget.isFloat){return}if(ISQ.Http.browser.isIE6&&window.location.href.startsWith("https://")){return}PIE.detach(ISQ.Widget.HTML.titleWrapper);PIE.detach(ISQ.Widget.HTML.footerWrapper);PIE.detach(_("widgetMinimizedFooter"));PIE.detach(_("searchContainer"));PIE.detach(_("actionBarWrapper"))};ISQ.Widget.HTML.highlightSearchFieldError=function(c,a){var b=ISQ.Widget.HTML.searchContainer;if(a){if(b.className.indexOf("error")==-1){b.oldClassName=b.className}b.className+=" error";c--}else{b.className=b.oldClassName}if(c){setTimeout(function(){ISQ.Widget.HTML.highlightSearchFieldError(c,!a)},150)}};ISQ.Widget.HTML.resizeHandler=function(h,a){if(!h){h=ISQ.Html.screenSize()}ISQ.Widget.HTML.currentHeight=h.h;ISQ.Widget.HTML.currentWidth=h.w;if(ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode==ISQ.Widget.enumMobileHandlingMode.normalWidget){ISQ.Widget.HTML.Mobile.setWidths();if(ISQ.Http.browser.oldAndroid){return}}if(a&&!ISQ.Widget.HTML.resizeTimer){ISQ.Widget.HTML.currentlyResizing=true;ISQ.Widget.HTML.resizeTimer=setInterval(ISQ.Widget.HTML.resizeTimerElapsed,ISQ.Widget.HTML.resizeTimerInterval)}if(!ISQ.Widget.dynamicSize){if(ISQ.Widget.HTML.currentHeight<=ISQ.Widget.HTML.htmlCollapseHeight){ISQ.Widget.HTML.toTeaser()}else{if(ISQ.Widget.HTML.isTeaser){ISQ.Widget.HTML.toNormal()
}}}if(ISQ.Http.browser.isMobile){_("minimizeButtonWrapper").style.display="none";ISQ.Widget.setTitle()}if(!ISQ.Http.browser.isMobile||window.top!==window){var e=h.h;e-=_("widgetTitleWrapper").offsetHeight;e-=ISQ.Widget.HTML.searchWrapper.offsetHeight;if(ISQ.Widget.HTML.isTeaser){e-=_("widgetMinimizedFooter").offsetHeight;e-=_("chatStatusWrapper").offsetHeight}else{e-=ISQ.Widget.HTML.footerWrapper.offsetHeight;var d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.widgetFooter,"margin-top");if(d){e-=parseInt(d)}if(ISQ.CSS.getElementStyle(ISQ.Widget.HTML.actionBarWrapper,"position")!=="absolute"){e-=ISQ.Widget.HTML.actionBarWrapper.offsetHeight}if(_("searchSuggestions").offsetHeight>0){e-=_("searchSuggestions").offsetHeight}if(_("chatStatusWrapper").style.display!=="none"){e-=_("chatStatusWrapper").offsetHeight}e-=ISQ.Widget.HTML.chatInputWrapper.offsetHeight;var g=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.contentWrapper,"margin-top");if(g){e-=parseInt(g)}var f=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.contentWrapper,"margin-bottom");if(f){e-=parseInt(f)}}var b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.widgetContainer,"border-top-width",true);var c=parseInt(b);if(!isNaN(c)){e-=c}b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.widgetContainer,"border-bottom-width");c=parseInt(b);if(!isNaN(c)){e-=c}if(e<10){e=0}ISQ.Widget.HTML.contentWrapper.style.height=e+"px"}if(ISQ.Cnf.showLogoInCollapsedMode){if(!ISQ.Cnf.hideBranding&&ISQ.Widget.HTML.currentWidth===ISQ.Cnf.floatCollapsed_WidgetSize[0]&&ISQ.Widget.HTML.currentHeight===ISQ.Cnf.floatCollapsed_WidgetSize[1]){_("logoInCollapsedMode").style.display="block"}else{_("logoInCollapsedMode").style.display="none"}}ISQ.Widget.HTML.Mobile.setWidths(true)};ISQ.Widget.HTML.actionBarIsShown=false;ISQ.Widget.HTML.showActionBar=function(){if(ISQ.Widget.HTML.currentlyResizing||ISQ.Widget.HTML.isTeaser){ISQ.Widget.HTML.pendingShowActionBar=true;return}ISQ.Widget.HTML.pendingShowActionBar=false;ISQ.Widget.HTML.actionBarIsShown=true;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.actionBarContainer)){if(ISQ.Widget.HTML.actionBarFader===null){ISQ.Widget.HTML.actionBarFader=new VisualEffects.Fade(ISQ.Widget.HTML.actionBarContainer);
ISQ.Widget.HTML.actionBarFader.fadeOutEvent.addHandler(ISQ.Widget.HTML.post_hideActionBarFader);ISQ.Widget.HTML.actionBarFader.fadeInEvent.addHandler(ISQ.Widget.HTML.post_showActionBar)}ISQ.Widget.HTML.actionBarFader.setOpacity(0);ISQ.Widget.HTML.actionBarWrapper.style.display="block";ISQ.Widget.HTML.actionBarContainer.style.display="block";ISQ.Widget.HTML.actionBarFader.fadeIn(500,true);ISQ.Widget.HTML.resizeHandler()}else{ISQ.Widget.HTML.actionBarWrapper.style.display="block";ISQ.Widget.HTML.actionBarContainer.style.display="block";ISQ.Widget.HTML.resizeHandler()}};ISQ.Widget.HTML.hide_finishFunction=null;ISQ.Widget.HTML.hideActionBar=function(a,b){ISQ.Widget.HTML.pendingShowActionBar=false;ISQ.Widget.Log.add("hide action bar");ISQ.Widget.HTML.actionBarIsShown=false;if(a){ISQ.Widget.HTML.hide_finishFunction=a}if(!b&&ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.actionBarContainer)){if(ISQ.Widget.HTML.actionBarFader===null){ISQ.Widget.HTML.post_hideActionBarFader();return}ISQ.Widget.HTML.actionBarFader.fadeOut(200)}else{ISQ.Widget.HTML.post_hideActionBarFader()}};ISQ.Widget.HTML.post_hideActionBarFader=function(){ISQ.Widget.HTML.actionBarWrapper.style.display="none";ISQ.Widget.HTML.actionBarContainer.style.display="none";ISQ.Widget.HTML.resizeHandler();if(ISQ.Widget.HTML.hide_finishFunction){ISQ.Widget.HTML.hide_finishFunction();ISQ.Widget.HTML.hide_finishFunction=null}};ISQ.Widget.HTML.post_showActionBar=function(){};ISQ.Widget.HTML.scrollContentToBottom=function(){ISQ.Widget.HTML.contentWrapper.scrollTop=ISQ.Widget.HTML.contentWrapper.scrollHeight-ISQ.Widget.HTML.contentWrapper.offsetHeight};ISQ.Widget.HTML.limitedMode=function(){ISQ.Widget.Log.add("Widget is running in limited mode");ISQ.Widget.HTML.queryField.style.display="none";ISQ.Widget.HTML.queryField.style.visibility="hidden";ISQ.Widget.HTML.queryField.value="Limited mode";ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email,null,true);ISQ.Widget.HTML.queryField.value=""};ISQ.Widget.HTML.resizePollingHandler=function(){var a=ISQ.Html.screenSize();
if(a.h==ISQ.Widget.HTML.currentHeight&&a.w===ISQ.Widget.HTML.currentWidth){return}ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.resizeHandler(a,true)};ISQ.Widget.HTML.timeoutFixContent=0;ISQ.Widget.HTML.fixContentWidths=function(){ISQ.Widget.HTML.timeoutFixContent=0;ISQ.Widget.HTML.fixContentWidths_internal()};ISQ.Widget.HTML.fixContentWidths_internal=function(){if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){if(ISQ.Widget.HTML.contentWrapper.scrollHeight>ISQ.Widget.HTML.contentWrapper.offsetHeight){var a,c,b;if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){a=(ISQ.Widget.HTML.contentWrapper.offsetWidth-ISQ.Html.scrollBarWidth())-2;b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.chatPane,"padding-left");c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.chatPane,"padding-right")}else{a=(ISQ.Widget.HTML.searchWrapper.offsetWidth-ISQ.Html.scrollBarWidth())-2;b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.answerPane,"padding-left");c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.answerPane,"padding-right")}if(a<=0){if(++ISQ.Widget.HTML.timeoutFixContent<40){setTimeout(ISQ.Widget.HTML.fixContentWidths_internal,50)}return}if(b){a-=parseInt(b)}if(c){a-=parseInt(c)}a+="px";_("answerPane").style.width=a;_("contentArea").style.width=a;if(ISQ.Http.browser.isIE6&&ISQ.Widget.Localize.array.dir==="rtl"){var d=ISQ.Widget.HTML.searchWrapper.offsetWidth;if(d){d=d+"px"}else{d="auto"}setTimeout(function(){ISQ.Widget.HTML.searchWrapper.style.width=d},0)}}else{_("answerPane").style.width="auto";_("contentArea").style.width="100%"}}};ISQ.Widget.HTML.hasContent=function(){if((ISQ.Widget.state&ISQ.Widget.enumState.allEscalations)!==0){return true}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){return _query(true,true).length!==0}if(ISQ.Widget.state&ISQ.Widget.enumState.questions){return _query(true,false).length!==0}return false};ISQ.Widget.HTML.minimizeBtnClicked=function(){ISQ.Widget.HTML.Mobile.ignoreClickEvent=true;var a=ISQ.Widget.HTML.hasContent();ISQ.Widget.HTML.ignoreNextClickEvent=true;ISQ.Widget.CDC.sendMessage("subject=minimize&openExpand="+a,true);
if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.AutoQuestions.stop_()}};ISQ.Widget.HTML.toTeaser=function(){ISQ.Widget.HTML.isTeaser=true;ISQ.Widget.HTML.contentWrapper.className="empty";ISQ.Widget.HTML.footerWrapper.style.display="none";_("widgetMinimizedFooter").style.display="block";if(ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="none"}if(_("searchSuggestions").childNodes.length>0){_("searchSuggestions").style.display="none"}ISQ.Widget.HTML.actionBarWrapper.style.display="none";if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){if(!ISQ.Widget.HTML.chatStatus.originalText){ISQ.Widget.HTML.chatStatus.originalText=ISQ.Widget.HTML.chatStatus.innerHTML;ISQ.Data.autoEllipseText(ISQ.Widget.HTML.chatStatus.innerHTML,ISQ.Widget.HTML.chatStatus.offsetWidth,ISQ.Widget.HTML.chatStatus)}_("closeChat").style.display="none";_("chatPane").style.display="none";ISQ.Widget.HTML.chatInputWrapper.style.display="none";_("chatStatusContainer").className="chatStatusContainerMinimized"}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){_("contactForm").style.display="none"}else{_("answerPane").style.display="none"}}ISQ.Widget.setTitle()};ISQ.Widget.HTML.showMinimizeIcon=function(){if(!ISQ.Widget.spriteLoaded){_("minimizeButton").className+="widgetActive";ISQ.Widget.spriteLoaded=true}};ISQ.Widget.HTML.toNormal=function(){ISQ.Widget.HTML.isTeaser=false;ISQ.Widget.HTML.contentWrapper.className="";_("widgetMinimizedFooter").style.display="none";if(ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="inline";ISQ.Widget.HTML.showMinimizeIcon()}if(ISQ.Widget.HTML.hasContent()&&ISQ.Widget.Query.numberOfTopics!==0&&(ISQ.Widget.state&ISQ.Widget.enumState.nonChatEscalations)===0){ISQ.Widget.HTML.actionBarWrapper.style.display="block"}if(_("searchSuggestions").childNodes.length>0){_("searchSuggestions").style.display="block"}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0){_("answerPane").style.display="block"}if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){if(ISQ.Widget.HTML.chatStatus.originalText){ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.HTML.chatStatus.originalText;
ISQ.Widget.HTML.chatStatus.originalText=null}_("chatPane").style.display="block";_("closeChat").style.display="block";if(ISQ.Widget.state!==ISQ.Widget.enumState.chatSurvey){ISQ.Widget.HTML.chatInputWrapper.style.display="block"}_("chatStatusContainer").className=""}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){_("contactForm").style.display="block"}}if(ISQ.Widget.state!==ISQ.Widget.enumState.contactForm||ISQ.Cnf.showFooterWithContactForm!==false){ISQ.Widget.HTML.footerWrapper.style.display="block"}ISQ.Widget.setTitle();if(ISQ.Widget.HTML.answerPane.restorePagerScroll){ISQ.Widget.HTML.answerPane.restorePagerScroll()}};ISQ.Widget.HTML.canPerformFade=function(b){if(typeof(b.isFadeAvailable)==="bool"){return b.isFadeAvailable}if(ISQ.Http.browser.app!=="ie"||ISQ.Http.browser.isIE11){b.isFadeAvailable=true;return b.isFadeAvailable}var a=ISQ.CSS.getElementStyle(b,"background-color");if(!a||a.toLowerCase()=="transparent"){b.isFadeAvailable=false}else{b.isFadeAvailable=true}return b.isFadeAvailable};ISQ.Widget.HTML.resizeTimerElapsed=function(){if(!ISQ.Widget.HTML.lastWindowSize){ISQ.Widget.HTML.lastWindowSize={};ISQ.Widget.HTML.resizeStarted()}if(ISQ.Widget.HTML.currentHeight==ISQ.Widget.HTML.lastWindowSize.h&&ISQ.Widget.HTML.currentWidth==ISQ.Widget.HTML.lastWindowSize.w){clearInterval(ISQ.Widget.HTML.resizeTimer);ISQ.Widget.HTML.resizeTimer=null;ISQ.Widget.HTML.lastWindowSize=null;ISQ.Widget.HTML.currentlyResizing=false;ISQ.Widget.HTML.resizeStopped();return}ISQ.Widget.HTML.lastWindowSize.h=ISQ.Widget.HTML.currentHeight;ISQ.Widget.HTML.lastWindowSize.w=ISQ.Widget.HTML.currentWidth};ISQ.Widget.HTML.resizeStarted=function(){if(!ISQ.Widget.dynamicSize&&!ISQ.Http.browser.isMobile){ISQ.Widget.HTML.actionBarWrapper.style.display="none";ISQ.Widget.HTML.actionBarContainer.style.display="none"}};ISQ.Widget.HTML.resizeStopped=function(){if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){ISQ.Widget.HTML.disablePIE();ISQ.Widget.HTML.enablePIE()}if(ISQ.Widget.dynamicSize&&ISQ.Http.browser.app=="ff"&&ISQ.Http.browser.version.indexOf("3.")===0){document.body.scrollTop=0
}if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.pendingShowActionBar){if(ISQ.Widget.state==ISQ.Widget.enumState.questions){ISQ.Widget.Query.showActionBar()}else{if(ISQ.Widget.state==ISQ.Widget.enumState.chat){ISQ.Widget.HTML.showActionBar();if(ISQ.Widget.iChat.instance&&ISQ.Widget.iChat.instance.resumingChat()){ISQ.Widget.HTML.scrollContentToBottom()}}else{if(ISQ.Widget.state==ISQ.Widget.enumState.chatSurvey){ISQ.Widget.HTML.showActionBar()}}}}else{if(ISQ.Widget.HTML.actionBarIsShown){if(ISQ.Http.browser.isMobile){ISQ.Widget.Query.showActionBar()}else{if(!ISQ.Widget.dynamicSize){ISQ.Widget.HTML.showActionBar();ISQ.Widget.HTML.resizeHandler()}}}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm&&(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6)&&_("clientFormTabDivs")){_("clientFormTabDivs",true).style.display="none";_("clientFormTabDivs").style.display="block"}}}if(_("customerLogo").pendingResize){ISQ.Widget.onCustomerLogoLoad()}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0){ISQ.Widget.Query.resizeAnswerElements()}ISQ.Widget.HTML.Mobile.setWidths();if(ISQ.Widget.HTML.answerPane.restorePagerScroll){ISQ.Widget.HTML.answerPane.restorePagerScroll()}ISQ.Widget.HTML.dynamicSize_sendMessage();if(ISQ.Widget.ContactForm.mResizeContactForm){var a=ISQ.Widget.ContactForm.mResizeContactForm;ISQ.Widget.ContactForm.mResizeContactForm=null;a();a=null}};ISQ.Widget.HTML.dynamicSize_sendMessageTimer=null;ISQ.Widget.HTML.dynamicSize_sendMessage=function(b,c){if(!ISQ.Widget.dynamicSize&&!c){return}if(ISQ.Widget.HTML.dynamicSize_sendMessageTimer){clearTimeout(ISQ.Widget.HTML.dynamicSize_sendMessageTimer)}var a=function(){var j=ISQ.Widget.HTML.contentWrapper;j.style.overflowY="hidden";var g=0;if(ISQ.Http.browser.app==="chrome"||ISQ.Http.browser.app==="safari"||ISQ.Http.browser.isMobile||(ISQ.Http.browser.isAndroid&&ISQ.Http.browser.isTablet)){var d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.widgetContainer,"border-top-width");var e=parseInt(d);if(!isNaN(e)){g+=e}d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.widgetContainer,"border-bottom-width");
e=parseInt(d);if(!isNaN(e)){g+=e}g+=ISQ.Widget.HTML.widgetContainer.scrollHeight}else{var h=ISQ.Html.pageSize(false,true);g+=h.h}if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){var f=250;if(ISQ.Widget.Chat.chatConfig.heightInDynamicEmbed){f=ISQ.Widget.Chat.chatConfig.heightInDynamicEmbed}g+=f-j.offsetHeight}else{g+=_("contentArea").scrollHeight-j.offsetHeight}if(ISQ.Widget.dynamicMaxSize&&g>ISQ.Widget.dynamicMaxSize){if(!ISQ.Widget.FAQ.shown&&ISQ.Widget.state!=ISQ.Widget.enumState.contactForm){j.style.overflowY="auto";g=ISQ.Widget.dynamicMaxSize}}if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){j.style.overflowY="auto"}ISQ.Widget.CDC.sendMessage("subject=setSize&height="+g)};if(b===true){a()}else{ISQ.Widget.HTML.dynamicSize_sendMessageTimer=setTimeout(function(){a()},0)}};ISQ.Widget.HTML.currentHeight=0;ISQ.Widget.HTML.currentWidth=0;ISQ.Widget.HTML.isTeaser=false;ISQ.Widget.HTML.htmlCollapseHeight=85;ISQ.Widget.HTML.searchAnim=null;ISQ.Widget.HTML.actionBarFader=null;ISQ.Widget.HTML.ignoreNextClickEvent=false;ISQ.Widget.HTML.currentlyResizing=false;ISQ.Widget.HTML.resizeTimerInterval=100;ISQ.Widget.HTML.resizeTimer=null;ISQ.Widget.HTML.lastWindowSize=null;ISQ.Widget.HTML.pendingShowActionBar=false;ISQ.Widget.HTML.dynamicRTLCssLoaded=true;ISQ.Widget.AutoQuestions=initializeNS("ISQ.Widget.AutoQuestions");ISQ.Widget.AutoQuestions.array=null;ISQ.Widget.AutoQuestions.interval=10000;ISQ.Widget.AutoQuestions.currentIndex=-1;ISQ.Widget.AutoQuestions.timeout=null;ISQ.Widget.AutoQuestions.repeatMode=true;ISQ.Widget.AutoQuestions.init=function(e,b,f){if(!e){return false}ISQ.Widget.AutoQuestions.array=new Array();var d=e.split(";");var c=d.length;for(var a=0;a<c;++a){if(d[a].Trim()!=""){ISQ.Widget.AutoQuestions.array.push(d[a])}}ISQ.Widget.AutoQuestions.interval=!isNaN(b)?parseInt(b):ISQ.Widget.AutoQuestions.interval;ISQ.Widget.AutoQuestions.repeatMode=f===true&&ISQ.Widget.AutoQuestions.array.length>1;ISQ.Widget.Log.add("Initiated "+ISQ.Widget.AutoQuestions.array.length+" auto questions with "+ISQ.Widget.AutoQuestions.interval+" interval between them");
ISQ.Widget.state=ISQ.Widget.enumState.autoQuestions;return true};ISQ.Widget.AutoQuestions.showNext=function(){ISQ.Widget.AutoQuestions.timeout=setTimeout(ISQ.Widget.AutoQuestions.go,ISQ.Widget.AutoQuestions.interval)};ISQ.Widget.AutoQuestions.go=function(){if(ISQ.Widget.AutoQuestions.array===null||ISQ.Widget.AutoQuestions.array.length<1){return}var a=ISQ.Widget.AutoQuestions.array.length;var b=ISQ.Widget.AutoQuestions.currentIndex+1;if(b===a){if(!ISQ.Widget.AutoQuestions.repeatMode){return}b=0}var c=ISQ.Widget.AutoQuestions.array[b];ISQ.Widget.AutoQuestions.currentIndex=b;ISQ.Widget.Query.ask(c,ISQ.Widget.Query.enumTextQuerySource.linkedAnswer);if(ISQ.Cnf.initialText===""){ISQ.Widget.HTML.queryField.blur()}};ISQ.Widget.AutoQuestions.stop_=function(){ISQ.Widget.state=ISQ.Widget.enumState.questions;clearTimeout(ISQ.Widget.AutoQuestions.timeout);if(ISQ.Widget.Query.typeTimer!==null){ISQ.Widget.Query.typeTimer.cancel();ISQ.Widget.Query.typeTimer.dispose();ISQ.Widget.Query.typeTimer=null}ISQ.Widget.Query.lastQuerySent=""};ISQ.Widget.AutoQuestions.getCurrentQuestion=function(){return ISQ.Widget.AutoQuestions.array[ISQ.Widget.AutoQuestions.currentIndex]};ISQ.Widget.FAQ=initializeNS("ISQ.Widget.FAQ");ISQ.Widget.FAQ.behavior={OnWidgetLoad:1,OnNoResuls:2,OnClearSearchField:4};ISQ.Widget.FAQ.shown=false;ISQ.Widget.FAQ.handleCnfData=function(){var a=ISQ.Cnf.faqData;if(!a||typeof(a)!=="string"){return}if(ISQ.Widget.isContained){return}nanoRep.FAQ.requestFaqLists({serverUrl:window.location.protocol+"//"+ISQ.Http.domain(true),account:ISQ.Widget.account,kb:ISQ.Http.hashArguments.kb||ISQ.Http.urlArguments.kb,referer:ISQ.Widget.referer.normal,context:_session().mContexts,isFloat:ISQ.Widget.isFloat,faqData:a,callback:ISQ.Widget.FAQ.dataReady,disableContextCombine:true,configId:ISQ.Widget.configId})};ISQ.Widget.FAQ.dataReady=function(data){if(!data){return}var callback=ISQ.Cnf.faqData.callback;if(typeof(data)==="string"){ISQ.Cnf.faqData=eval("("+data+")")}else{ISQ.Cnf.faqData=data}if(callback){callback()}};ISQ.Widget.FAQ.show=function(g){var b=ISQ.Cnf.faqData;
if(!b){return}if(typeof(b)==="string"){ISQ.Cnf.faqData={callback:function(){ISQ.Widget.FAQ.show(g)}};return}var f=[];for(var d in b){if(b[d].behavior!=null&&((b[d].behavior&g)==0)){continue}if(!b[d].data.length||!b[d].data[0].data.length){continue}f[0]=true;if(b[d].title){createDiv(ISQ.Widget.HTML.answerPane,".faqTitle").innerHTML="<h2>"+b[d].title+"</h2>"}for(var e in b[d].data[0].data){var c=b[d].data[0].data[e];if(f[c.objectId]){continue}f[c.objectId]=true;var a={title:c.label,id:c.objectId,likes:c.likes,summary:null,answerNum:e};ISQ.Widget.Query.appendSingleAnswer({answerObject:a,footer:null,visible:true,collapsed:true,isFAQ:true,style:".faq",direction:ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage||ISQ.Cnf.initialUiLanguage)})}}if(f.length>0&&(ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0){ISQ.Widget.FAQ.shown=true;ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.Query.displayAnswers(_query(true).length===0)}};ISQ.Widget.FAQ.BuildThumbsForFAQarticle=function(g,k,d){var j=k;var e=d.parentNode;var b=e.parentNode;while(k.nodeName!="TBODY"&&k.parentNode){k=k.parentNode}var h=createRow(k);var l=createTd(h,"","",".likesDefaultPadding&.faqLikesPadding");var f=createDiv(l,".articlelikeContainer");var c=createDiv(f,".iLike");var a=createDiv(f,".iDontLike");j.likes={};j.likes.results=g;j.likes.currentContainer=h;j.likes.likeContainer=c;j.likes.likeIcon=d;j.likes.initialContainer=b;c.appendChild(e);nanoRep.FAQ.Likes.buildThumbDownIcon(g[0].id,a,d,false,ISQ.Cnf.cacheVar,ISQ.Widget.account,ISQ.Cnf.kbId,ISQ.Widget.isPreview,null,ISQ.Widget.referer.normal)};ISQ.Widget.FAQ.removeThumbsForFAQarticle=function(b){if(b.likes){var a=b.likes.initialContainer;a.appendChild(b.likes.likeContainer);b.likes.currentContainer.parentNode.removeChild(b.likes.currentContainer)}};ISQ.Widget.FAQ.buildAnswer=function(d,g,a){ISQ.Widget.HTML.searchAnim.hide();var e=new Array();var b=ISQ.Data.getDBAnswerAsHtml(d[0].summary,false,ISQ.Widget.Query.appendQuestionTag,null,"ISQ.Widget.Query.namedAnchorClick",ISQ.Widget.referer.normal);
var c=ISQ.Widget.replacePlaceholders(b.text,ISQ.Widget.API.getCustomParams(),"{{","}}");if(c.success){b.text=c.text}e.push(b.text);ISQ.Widget.Query.appendAttachments(d[0].attachments,e);var f=createDiv(g.summaryTd,".faqText");f.innerHTML=e.join("");g.className="answerTitle expanded";g.summaryTr.className="summaryRow expanded";if(a){ISQ.Widget.FAQ.BuildThumbsForFAQarticle(d,g.summaryTr,a)}ISQ.Widget.Query.resizeSingleAnswerElements(f,true,f.offsetWidth);ISQ.Widget.HTML.dynamicSize_sendMessage()};ISQ.Widget.Protocol={};ISQ.Widget.Protocol.client=null;ISQ.Widget.Protocol.isEstablished=false;var _session=function(){return ISQ.Widget.Protocol.client};ISQ.Widget.Protocol.init=function(){try{ISQ.Widget.Log.add("Creating Protocol Client");var a=true;if(ISQ.Widget.isPreview){a=false}ISQ.Widget.Protocol.client=new ISQ.Protocol.WidgetClient({server:"/~"+ISQ.Widget.account.toLowerCase()+"/KB",ttl:10000,connections:1,referer:ISQ.Widget.referer.normal,account:ISQ.Widget.account,enableStats:a,pageId:ISQ.Http.hashArguments.pageid,requestedKb:ISQ.Http.hashArguments.kb||ISQ.Http.urlArguments.kb,doctype:ISQ.Http.hashArguments.doctype,configId:ISQ.Widget.configId});ISQ.Widget.Protocol.client.connectionStateChangeEvent.addHandler(this.onConnectionStateChange)}catch(b){var c=b.message||b;ISQ.Widget.Log.add("Exception in protocol.init(): "+c);return false}return true};ISQ.Widget.Protocol.onConnectionStateChange=function(a,b){var c;switch(a){case ISQ.Protocol.connectionStateEnum.DISCONNECTED:ISQ.Widget.Log.add("connectionState has changed: Disconnected");if(ISQ.Widget.ContactForm.preview){ISQ.Widget.ContactForm.preview.sessionEnded()}break;case ISQ.Protocol.connectionStateEnum.CONNECTED:ISQ.Widget.Log.add("connectionState has changed: Connected to account "+ISQ.Widget.account+". sid: "+_session().id());ISQ.Widget.Query.popularSuggestions_process();break;case ISQ.Protocol.connectionStateEnum.CONNECTING:ISQ.Widget.Log.add("connectionState has changed: Connecting");if(ISQ.Widget.ContactForm.preview){ISQ.Widget.ContactForm.preview.sessionEnded()
}break;case ISQ.Protocol.connectionStateEnum.RECONNECTING:ISQ.Widget.Log.add("connectionState has changed: Re-Connecting");break;case ISQ.Protocol.connectionStateEnum.LOGIN_FAILD:ISQ.Widget.Log.add("connectionState has changed: Login has failed",ISQ.Widget.Log.statusEnum.RED);break;case ISQ.Protocol.connectionStateEnum.CONNECTION_LOST:ISQ.Widget.Log.add("connectionState has changed: connection lost",ISQ.Widget.Log.statusEnum.GREEN);break}};ISQ.Widget.Query={};ISQ.Widget.Query.isSameQuery=false;ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.Query.lastSuggestionSent="";ISQ.Widget.Query.lastWrittenQuery=null;ISQ.Widget.Query.lastQuerySent_time=null;ISQ.Widget.Query.pendingRequest=false;ISQ.Widget.Query.timer=null;ISQ.Widget.Query.activeRequestId=-1;ISQ.Widget.Query.popularSuggestionsRequestId=-1;ISQ.Widget.Query.ignoreKeyCodes=new Array();ISQ.Widget.Query.kbLanguageCode="";ISQ.Widget.Query.numberOfTopics=0;ISQ.Widget.Query.currentAnswers=null;ISQ.Widget.Query.currentAnswersForComparison=null;ISQ.Widget.Query.firstAnswerId=-1;ISQ.Widget.Query.chatEscalationAction=null;ISQ.Widget.Query.chatInviteContent=null;ISQ.Widget.Query.chatPushAnswers={pushed:false};ISQ.Widget.Query.fader=null;ISQ.Widget.Query.cachedAnswerTranslationDelimiter=":";ISQ.Widget.Query.previousDetectedLanguage=null;ISQ.Widget.Query.previousResponseWasAutoQuestion=false;ISQ.Widget.Query.queryTranslator=null;ISQ.Widget.Query.answerTranslator=null;ISQ.Widget.Query.queryChangedEvent=null;ISQ.Widget.Query.typeTimer=null;ISQ.Widget.Query.typeInterval=50;ISQ.Widget.Query.questionsTrail=null;ISQ.Widget.Query.tempQuestionTrailId=null;ISQ.Widget.Query.gettingAnswerById=false;ISQ.Widget.Query.setFocusByScript=false;ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.clearTextboxOnInteraction=false;ISQ.Widget.Query.searchDelay_min=250;ISQ.Widget.Query.searchDelay_max=2500;ISQ.Widget.Query.searchDelay_history=new ISQ.Infra.LinkedList();ISQ.Widget.Query.elementsToResize=null;ISQ.Widget.Query.resizeableTags=["IMG","OBJECT","EMBED","IFRAME"];ISQ.Widget.Query.lastQueryTranslation=null;
ISQ.Widget.Query.resizeToWidth=0;ISQ.Widget.Query.mobile_previousValue=null;ISQ.Widget.Query.mobile_ignoreNextChange=false;ISQ.Widget.Query.userActiveReported=false;ISQ.Widget.Query.lastAutoQuestionRequestId=-1;ISQ.Widget.Query.contextCategories=null;ISQ.Widget.Query.scrollInterval=null;ISQ.Widget.Query.peekElementHeight=27;var _query=function(b,a){var c=ISQ.Widget.HTML.queryField.value;if(!ISQ.Widget.userActive&&!a){return""}if(b===true){c=c.Trim()}return c};ISQ.Widget.Query.init=function(){ISQ.Widget.Query.ignoreKeyCodes[13]=true;ISQ.Widget.Query.ignoreKeyCodes[16]=true;ISQ.Widget.Query.ignoreKeyCodes[17]=true;ISQ.Widget.Query.ignoreKeyCodes[18]=true;ISQ.Widget.Query.ignoreKeyCodes[20]=true;ISQ.Widget.Query.ignoreKeyCodes[37]=true;ISQ.Widget.Query.ignoreKeyCodes[38]=true;ISQ.Widget.Query.ignoreKeyCodes[39]=true;ISQ.Widget.Query.ignoreKeyCodes[40]=true;ISQ.Widget.Query.ignoreKeyCodes[91]=true;ISQ.Widget.Query.ignoreKeyCodes[92]=true;ISQ.Widget.HTML.searchAnim=new ISQ.GUI.ProgressAnimation({container:createDiv(ISQ.Widget.HTML.searchContainer,".searchAnim"),onShow:function(){ISQ.CSS.addClass(ISQ.Widget.HTML.contentArea,"busy")},onHide:function(){ISQ.CSS.removeClass(ISQ.Widget.HTML.contentArea,"busy")}});ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Query.queryChangedEvent=new ISQ.Event();var a=ISQ.Http.hashArguments.searchdelay||ISQ.Http.urlArguments.searchdelay;if(a){a=parseInt(a)}if(!isNaN(a)){ISQ.Widget.Query.searchDelay_min=a}if((ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode===ISQ.Widget.enumMobileHandlingMode.normalWidget)||ISQ.Http.browser.isTablet||((ISQ.Cnf.kbLanguageCode=="ja"||ISQ.Cnf.kbLanguageCode=="zh")&&ISQ.Http.browser.app=="ff")){ISQ.Widget.Query.mobile_previousValue=ISQ.Cnf.initialText||null;setInterval(ISQ.Widget.Query.queryInterval_mobile,100);ISQ.Widget.HTML.queryField.onkeyup=null}ISQ.Widget.Query.popularSuggestions_init()};ISQ.Widget.Query.queryInterval_mobile=function(){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){return}if(ISQ.Widget.Query.typeTimer&&!ISQ.Widget.Query.typeTimer.isDisposed()){return
}var b=_query(false,true);if(b===ISQ.Widget.Query.mobile_previousValue){return}ISQ.Widget.Query.mobile_previousValue=b;if(ISQ.Widget.Query.mobile_ignoreNextChange){ISQ.Widget.Query.mobile_ignoreNextChange=false;return}ISQ.Widget.userActive=true;var a={keyCode:b.charCodeAt(b.length-1)};ISQ.Widget.Query.keyUpHandler(a)};ISQ.Widget.Query.onFocusHandler=function(a){if(ISQ.Http.browser.isMobile){if(ISQ.Widget.mobileHandlingMode===ISQ.Widget.enumMobileHandlingMode.inactive){ISQ.Widget.HTML.queryField.blur()}else{if(ISQ.Http.browser.isAndroid&&(ISQ.Widget.Query.gettingAnswerById||!ISQ.Widget.userActive)){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.Query.userInteractionHandler(a)}ISQ.Widget.HTML.Mobile.hideAddressbar(20)}return}if(!ISQ.Widget.sendingCDCMessages){ISQ.Widget.HTML.queryField.onfocus=null;return false}else{if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=textfieldFocus")}}};var forceBlur=function(){document.activeElement.blur();window.focus()};ISQ.Widget.onBlurHandler=function(){if(ISQ.Http.browser.isIPad&&document.activeElement==ISQ.Widget.HTML.queryField){document.getElementById("ipadFocusOut").focus()}if(!ISQ.Widget.sendingCDCMessages){return}ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=blur")}};ISQ.Widget.Query.onBlurHandler=function(){if(!ISQ.Widget.sendingCDCMessages){ISQ.Widget.HTML.queryField.onblur=null;return false}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=blur")}};ISQ.Widget.Query.setFocus=function(){if(ISQ.Http.hashArguments.autograbfocusinembed){ISQ.Cnf.autoGrabFocusInEmbed&=ISQ.Http.hashArguments.autograbfocusinembed==="true"}if(ISQ.Widget.isPreview||ISQ.Cnf.autoGrabFocusInEmbed===false||ISQ.Cnf.autoGrabFocusInEmbed===0||ISQ.Widget.isFloat||ISQ.Http.browser.isMobile){return}ISQ.Widget.Query.setFocusByScript=true;try{ISQ.Widget.HTML.queryField.focus();ISQ.Widget.Log.add("Focus:  was added to query field")}catch(a){setTimeout(function(){try{ISQ.Widget.HTML.queryField.focus();ISQ.Widget.Log.add("Focus: was added to query field with timeout")
}catch(b){}},0)}};ISQ.Widget.Query.onclickHandler=function(b,a){if(ISQ.Http.browser.isAndroid){return}ISQ.Widget.Query.userInteractionHandler(b,a)};ISQ.Widget.Query.userInteractionHandler=function(b,a){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Cnf.initialText||ISQ.Widget.Query.clearTextboxOnInteraction){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.stop_()}if((a&&!ISQ.Widget.userActive)||ISQ.Widget.Query.clearTextboxOnInteraction){ISQ.Widget.HTML.queryField.value="";ISQ.Widget.HTML.queryField.className=ISQ.Widget.HTML.queryField.className.replace("initialText","");ISQ.Widget.Query.mobile_ignoreNextChange=true;if(ISQ.Widget.Query.typeTimer){ISQ.Widget.Query.typeTimer.cancel()}}ISQ.Widget.Query.clearTextboxOnInteraction=false}return false};ISQ.Widget.Query.keyPressHandler=function(b){var a=b||window.event;if(a.keyCode===13){return false}ISQ.Widget.userActive=true};ISQ.Widget.Query.keyDownHandler=function(a){ISQ.Widget.Query.userInteractionHandler(a,true);ISQ.Widget.userActive=true;ISQ.Widget.HTML.queryField.onkeydown=null};ISQ.Widget.Query.pasteHandler=function(a){ISQ.Widget.Query.userInteractionHandler(a,true);ISQ.Widget.userActive=true;setTimeout(function(){ISQ.Widget.Query.keyUpHandler(a)},0)};ISQ.Widget.Query.keyUpHandler=function(b){var a=b||window.event;if(!ISQ.Widget.userActive){return}if(typeof(a.keyCode)!="unknown"&&ISQ.Widget.Query.ignoreKeyCodes[a.keyCode]){return false}if(ISQ.Cnf.limited&&ISQ.Widget.state!==ISQ.Widget.enumState.contactForm){return false}if(ISQ.Widget.state===ISQ.Widget.enumState.customLink){ISQ.Widget.state=ISQ.Widget.enumState.questions}ISQ.Widget.Query.searchDelay_history.addLast(new Date());if(ISQ.Widget.Query.searchDelay_history.count()===6){ISQ.Widget.Query.searchDelay_history.remove(ISQ.Widget.Query.searchDelay_history.head())}ISQ.Widget.Query.analyzeQuery(_query(false),ISQ.Widget.Query.enumTextQuerySource.regular);return false};ISQ.Widget.Query.ask=function(b,c){var a=(!ISQ.Cnf.initialText||ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions);
if(ISQ.Cnf.autoQuestionsTypeEffect&&a&&c!==ISQ.Widget.Query.enumTextQuerySource.api){ISQ.Widget.Query.analyzeQuery(b,c);ISQ.Widget.Query.typeTimer=new ISQ.Timer(new ISQ.Handler(ISQ.Widget.Query.typeQuestion),false,b,0);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval)}else{if(a){ISQ.Widget.HTML.queryField.value=b}ISQ.Widget.Query.analyzeQuery(b,c)}};ISQ.Widget.Query.questionLinkClicked=function(b,a){if(ISQ.Widget.Query.tempQuestionTrailId===b){return}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.state=ISQ.Widget.enumState.questions}ISQ.Widget.userActive=true;ISQ.Widget.Query.appendQuestionToTrail();ISQ.Widget.Query.tempQuestionTrailId=b;ISQ.Widget.Query.getAnswerById(b,a)};ISQ.Widget.Query.clearQuestionTrail=function(){if(ISQ.Widget.Query.questionsTrail){ISQ.Widget.Query.questionsTrail.dispose();ISQ.Widget.Query.questionsTrail=null}ISQ.Widget.Query.tempQuestionTrailId=null};ISQ.Widget.Query.appendQuestionTag=function(b,a,c){b.push("<a href='javascript:void(0)' onclick='ISQ.Widget.Query.questionLinkClicked(\"");b.push(a);b.push("\")'>");b.push(c);b.push("</a>")};ISQ.Widget.Query.namedAnchorClick=function(b){var d=document.getElementsByTagName("A");b=b.substring(1);for(var c in d){try{if(d[c].getAttribute("name")===b){if(ISQ.Widget.isFloat||ISQ.Widget.HTML.contentWrapper.scrollHeight>ISQ.Widget.HTML.contentWrapper.offsetHeight){ISQ.Widget.HTML.contentWrapper.scrollTop=ISQ.Html.position(d[c]).y-ISQ.Widget.HTML.searchContainer.offsetHeight}else{d[c].scrollIntoView()}break}}catch(a){}}return false};ISQ.Widget.Query.appendQuestionToTrail=function(){if(!ISQ.Widget.Query.questionsTrail){ISQ.Widget.Query.questionsTrail=new ISQ.Infra.Stack()}if(!ISQ.Widget.Query.tempQuestionTrailId){var a=ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions?ISQ.Widget.AutoQuestions.getCurrentQuestion():_query(true,true);ISQ.Widget.Query.questionsTrail.push({tag:a,isTagAnId:false})}else{ISQ.Widget.Query.questionsTrail.push({tag:ISQ.Widget.Query.tempQuestionTrailId,isTagAnId:true})}ISQ.Widget.Query.tempQuestionTrailId=null
};ISQ.Widget.Query.popQuestionFromTrail=function(){if(!ISQ.Widget.Query.questionsTrail){return null}return ISQ.Widget.Query.questionsTrail.pop()};ISQ.Widget.Query.getCurrentQuestionFromTrail=function(){if(!ISQ.Widget.Query.questionsTrail){return null}return ISQ.Widget.Query.questionsTrail.peek()};ISQ.Widget.Query.typeQuestion=function(b,a){if(a===b.length){ISQ.Widget.Query.typeTimer.dispose();return}ISQ.Widget.HTML.queryField.value=b.substr(0,a+1);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval,b,a+1)};ISQ.Widget.Query.enumTextQuerySource={regular:1,api:2,linkedAnswer:3,suggestion:4};ISQ.Widget.Query.analyzeQuery=function(f,h){f=f.replace(/\n/g," ");var n=f.Trim();ISQ.Widget.Query.clearQuestionTrail();ISQ.Widget.Query.gettingAnswerById=false;if(ISQ.Widget.state===ISQ.Widget.enumState.questions){if(n.length===0){if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}if(ISQ.Widget.Query.acTimer){clearTimeout(ISQ.Widget.Query.acTimer)}ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.Query.lastSuggestionSent="";ISQ.Widget.Query.hideAnswers(null,!ISQ.Widget.dynamicSize);ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.HTML.hideActionBar();ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.currentAnswers=null;ISQ.Widget.Query.currentAnswersForComparison=null;ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));if(ISQ.Cnf.faqData){clearNode(ISQ.Widget.HTML.answerPane);ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnClearSearchField)}return}if(ISQ.Cnf.autocompleteEnabled&&h===ISQ.Widget.Query.enumTextQuerySource.regular){var g=ISQ.Widget.Query.getLastWords(n,ISQ.Cnf.autocomplete_maxQueryLength);if(!g){ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"))}if(ISQ.Widget.Query.acTimer){clearTimeout(ISQ.Widget.Query.acTimer)}ISQ.Widget.Query.acTimer=setTimeout(function(){ISQ.Widget.Query.acTimer=null;if(ISQ.Widget.Query.lastSuggestionSent===g){return}ISQ.Widget.Query.lastSuggestionSent=g;ISQ.Widget.Query.popularSuggestions(g,{container:_("searchSuggestions"),eventsHandler:function(r,o,q,p){if(r!="click"){return
}ISQ.Widget.HTML.queryField.value=q;ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.Query.analyzeQuery(q,ISQ.Widget.Query.enumTextQuerySource.suggestion)},documentEventsHandler:function(q,o,p){ISQ.Widget.HTML.queryField.value=p||n},includeAnswers:false})},200)}var a=ISQ.Widget.Query.previousResponseWasAutoQuestion||h!==ISQ.Widget.Query.enumTextQuerySource.regular;if(!a&&n===ISQ.Widget.Query.lastQuerySent){if(!ISQ.Widget.Query.pendingRequest){if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Query.firstUserTyping=true}return}if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}ISQ.Widget.HTML.searchAnim.show()}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||h!==ISQ.Widget.Query.enumTextQuerySource.regular){++ISQ.Widget.Query.popularSuggestionsRequestId;ISQ.Widget.Query.lastSuggestionSent="";ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));ISQ.Widget.Query.isSameQuery=h===ISQ.Widget.Query.enumTextQuerySource.suggestion;ISQ.Widget.Query.send(n,false,h);if(ISQ.Widget.Query.enumTextQuerySource.suggestion===h){ISQ.Widget.Query.lastWrittenQuery=n}}else{if(ISQ.Widget.Query.firstUserTyping&&ISQ.Widget.state===ISQ.Widget.enumState.questions){if(ISQ.Widget.reportEvents){if(!ISQ.Widget.Query.userActiveReported){ISQ.Widget.CDC.sendMessage("subject=event&type=useractive");ISQ.Widget.Query.userActiveReported=true}ISQ.Widget.CDC.sendMessage("subject=event&type=userstartedtyping")}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=userWrites")}ISQ.Widget.Query.firstUserTyping=false}var d=new Date().getTime();var b=d-ISQ.Widget.lastQueryKeyTime;ISQ.Widget.lastQueryKeyTime=new Date().getTime();if(ISQ.Widget.Query.isSameQuery&&b>ISQ.Widget.updateQueryDiff_ms){ISQ.Widget.Query.isSameQuery=false}var j;if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){j=0}else{if(ISQ.Widget.Query.searchDelay_history.count()>2){var m=0;var e=ISQ.Widget.Query.searchDelay_history.head();var c=e.next();while(c){var b=(c.data()-e.data());
if(b<ISQ.Widget.Query.searchDelay_min){b=ISQ.Widget.Query.searchDelay_min}else{if(b>ISQ.Widget.Query.searchDelay_max){b=ISQ.Widget.Query.searchDelay_max}}m+=b;e=c;c=c.next()}j=m/ISQ.Widget.Query.searchDelay_history.count()*2}else{j=ISQ.Widget.Query.searchDelay_min*2}}ISQ.Widget.Query.lastWrittenQuery=n;var l=function(){ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.timerElapsedHandler(n,a);ISQ.Widget.Query.timer=null};var k=0;if(ISQ.Widget.Query.lastQuerySent_time){k=d-ISQ.Widget.Query.lastQuerySent_time}else{if(ISQ.Widget.Query.searchDelay_history.count()!==0){k=d-ISQ.Widget.Query.searchDelay_history.tail().data()}}if(k>=5000){l()}else{ISQ.Widget.Query.timer=setTimeout(l,j)}}};ISQ.Widget.Query.getLastWords=function(h,c){var f=0;var j=0;var e=false;h=h.replacer([{from:"",to:" "},{from:"\\",to:" "},{from:"-",to:" "},{from:"=",to:" "},{from:"(",to:" "},{from:")",to:" "},{from:"[",to:" "},{from:"]",to:" "},{from:"{",to:" "},{from:"}",to:" "},{from:"<",to:" "},{from:">",to:" "},{from:"#",to:" "},{from:"@",to:" "},{from:"^",to:" "},{from:"!",to:" "},{from:"?",to:" "},{from:"/",to:" "},{from:"&",to:" "},{from:"%",to:" "},{from:"$",to:" "},{from:"*",to:" "},{from:"",to:" "},{from:"\t",to:" "},{from:"\r",to:" "},{from:"\n",to:" "}]);var d=h.length-1;var b=true;while(h.charAt(d)===" "){--d}var g=d;var k=d;var a=false;for(;d>=0;--d){b=h.charAt(d)===" ";if(e){if(!b){e=false;k=d}}else{if(b){if(++j===c){break}k=-1;e=true}}}if(j<c){return h.Trim()}if(d===-1){return h.Trim()}if(!a){return h.substring(1+d).Trim()}k=d=g;j=0;e=false;words=[];for(;d>=0;--d){b=h.charAt(d)===" ";if(e){if(!b){e=false;k=d}}else{if(b){if(k-d>1){if(g==h.length){words.push(h.substring(d+1))}else{words.push(h.substring(d+1,k+1))}if(++j===c){k=-1;break}}k=-1;e=true}}}if(k!=-1){words.push(h.substring(0,k+1))}return words.reverse().join(" ")};ISQ.Widget.Query.countWords=function(c){var a=0;while(c.charAt(a)===" "&&a<c.length){++a}if(a===c.length){return 0}var b=false;var d=1;for(;a<c.length;++a){if(c.charAt(a)!==" "){b=false;continue}else{if(b){continue
}b=true;++d}}return d};ISQ.Widget.Query.popularSuggestions_init=function(){var a=_("searchSuggestions");ISQ.Data.copyElementFontStyle(_("txtSearch"),a)};ISQ.Widget.Query.hidePopularSuggestions=function(a){clearNode(a).style.display="none";document.onkeyup=null;ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()};ISQ.Widget.Query.hidePopularSuggestions_detectedLanguage=function(a,b){if(!a){return false}if(ISQ.Widget.Query.countWords(b)<2){return false}if(ISQ.Widget.Query.kbLanguageCode){if(a!=ISQ.Widget.Query.kbLanguageCode){ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));return true}}else{if(a!=ISQ.Cnf.kbLanguageCode){ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));return true}}return false};ISQ.Widget.Query.popularSuggestions_pendingQuery=null;ISQ.Widget.Query.popularSuggestions_running=false;ISQ.Widget.Query.popularSuggestions_clicked=false;ISQ.Widget.Query.popularSuggestions=function(b,a){if(!b.length){return}if(_session().state()===ISQ.Protocol.connectionStateEnum.CONNECTED){if(!ISQ.Widget.Query.popularSuggestions_running){ISQ.Widget.Query.popularSuggestions_sendInternal(b,a,ISQ.Widget.Query.kbLanguageCode)}else{ISQ.Widget.Query.popularSuggestions_pendingQuery={q:b,obj:a,kbLanguageCode:ISQ.Widget.Query.kbLanguageCode}}}else{ISQ.Widget.Query.popularSuggestions_pendingQuery={q:b,obj:a,kbLanguageCode:ISQ.Widget.Query.kbLanguageCode,sendContext:true};_session().login()}};ISQ.Widget.Query.popularSuggestions_process=function(){ISQ.Widget.Query.popularSuggestions_running=false;if(!ISQ.Widget.Query.popularSuggestions_pendingQuery){return}var a=ISQ.Widget.Query.popularSuggestions_pendingQuery;ISQ.Widget.Query.popularSuggestions_pendingQuery=null;ISQ.Widget.Query.popularSuggestions_sendInternal(a.q,a.obj,a.kbLanguageCode,a.sendContext)};ISQ.Widget.Query.popularSuggestions_sendInternal=function(g,f,e,j){ISQ.Widget.Query.popularSuggestions_running=true;var h=++ISQ.Widget.Query.popularSuggestionsRequestId;var a="ISQ.Widget.Query.popularSuggestions_callback_"+h;ISQ.Widget.Query["popularSuggestions_callback_"+h]=function(m,l){if(ISQ.Widget.Query.hidePopularSuggestions_detectedLanguage(e,ISQ.Widget.Query.lastQuerySent)){return
}if(l){if(!ISQ.Widget.Query.popularSuggestions_pendingQuery){ISQ.Widget.Query.popularSuggestions_pendingQuery={q:g,obj:f}}}else{ISQ.Widget.Query.popularSuggestions_response(m,f);ISQ.Widget.Query.popularSuggestions_process()}delete ISQ.Widget.Query["popularSuggestions_callback_"+h]};var k=[];k.push("/common/api/autocomplete.json?q=");k.push(encodeURI(g));k.push("&rid=");k.push(h);k.push("&s=");k.push(_session().id());k.push("&c=");k.push(a);k.push("&qsg=true");if(f.verbose){k.push("&v=true")}if(f.maxResults){k.push("&mr=");k.push(f.maxResults)}if(j){var b=_session().mContexts;var c=[];for(var d in b){c.push(d);c.push(":");c.push(b[d]);c.push(",")}if(c.length!=0){k.push("&ctx=");k.push(ISQ.Http.Cookies.encode64(c.join("")))}}ISQ.Tools.appendScript(k.join(""))};ISQ.Widget.Query.popularSuggestions_response=function(c,d){ISQ.Widget.Query.hidePopularSuggestions(d.container);if(ISQ.Widget.state===ISQ.Widget.enumState.questions&&!_query(true,false)){return}try{if(c.rid!=ISQ.Widget.Query.popularSuggestionsRequestId){return}var a=ISQ.Translation.Infra.getLanguageDirection(c.lc);d.container.style.direction=a;if(a=="rtl"){d.container.style.textAlign="right"}else{d.container.style.textAlign="left"}var k=d.container.parentNode.offsetWidth;var g=ISQ.Widget.Query.parseStemming(c.q,false);var h=[];var j=-1;var f=-1;iteration(c.a,function(p,o){var q,e=null,n="-1";if(typeof(p)==="string"){q=p}else{q=p.w;n=p.i}var l=ISQ.Widget.Query.parseStemming(q,true);if(!l.text.Trim()){return}var m=createDiv(d.container,".autoCompleteDiv");if(ISQ.Http.browser.isIOS7){m.style.maxWidth=k+"px"}m.index=h.length;h.push(m);m.innerHTML=ISQ.Widget.Query.epmphasizeText(l,g);m.answerTitle=l.text;m.id=n;m.setAttribute("tabindex","4");m.onmouseover=function(){var t=this.parentNode;for(var s in t.childNodes){var r=t.childNodes[s];if(r.nodeName!="DIV"||r==this||r.className.indexOf(" autoCompleteDiv_hover")==-1){continue}r.ignoreMouseout=false;r.onmouseout()}j=this.index;if(this.className.indexOf(" autoCompleteDiv_hover")==-1){this.className+=" autoCompleteDiv_hover"
}if(d.eventsHandler){d.eventsHandler("mouseover",this.id,m.answerTitle)}};m.onmouseout=function(){if(this.ignoreMouseout){return}f=this.index;this.className=this.className.replace(" autoCompleteDiv_hover","");if(d.eventsHandler){d.eventsHandler("mouseout",this.id,m.answerTitle)}};m.onclick=function(){ISQ.Widget.Query.popularSuggestions_clicked=true;if(d.eventsHandler){d.eventsHandler("click",this.id,m.answerTitle)}ISQ.Widget.Query.hidePopularSuggestions(d.container)}});d.container.style.display="block";d.container.style.overflow="hidden";ISQ.Widget.Query.ellipseSuggestionsText(d.container,d.container.offsetWidth-15);if(ISQ.Widget.state===ISQ.Widget.enumState.questions){ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()}document.onkeyup=function(m){var e=ISQ.Html.getDomEvent(m);var l;switch(e.domEvent.keyCode){case 40:if(j!==-1){l=h[j];l.ignoreMouseout=false;l.onmouseout()}++j;if(j===h.length){j=-1;return}l=h[j];l.ignoreMouseout=true;if(d.documentEventsHandler){d.documentEventsHandler("down",j,l.answerTitle)}l.onmouseover();break;case 38:if(j!==-1){l=h[j];l.ignoreMouseout=false;l.onmouseout()}if(j===-1){j=h.length-1}else{--j}var n=null;if(j!==-1){l=h[j];l.ignoreMouseout=true;n=l.answerTitle;l.onmouseover()}if(d.documentEventsHandler){d.documentEventsHandler("up",j,n)}break;case 13:if(j===-1||j==f){ISQ.Widget.Query.hidePopularSuggestions(d.container);return}h[j].onclick();break;case 27:ISQ.Widget.Query.hidePopularSuggestions(d.container);break}};if(d.onDrawHandler){d.onDrawHandler()}}catch(b){}};ISQ.Widget.Query.insertPopuplarSuggestionToTextbox=function(b){var a=_query(false,false);if(!b.startsWith(a)){return false}ISQ.Widget.HTML.queryField.value=b;if(ISQ.Widget.HTML.queryField.setSelectionRange){ISQ.Widget.HTML.queryField.setSelectionRange(a.length,b.length)}else{if(ISQ.Widget.HTML.queryField.createTextRange){var c=ISQ.Widget.HTML.queryField.createTextRange();c.moveStart("character",a.length);c.moveEnd("character",b.length);c.select()}}return true};ISQ.Widget.Query.ellipseSuggestionsText=function(a,g){var f={};
var e=parseInt(ISQ.CSS.getElementStyle(a,"font-size"));var d=12;var b=false;for(var c=0;c<a.childNodes.length;++c){if(!f[c]){f[c]=a.childNodes[c];f[c].origText=f[c].innerHTML}f[c].style.fontSize=e+"px";ISQ.Data.autoEllipseText(f[c].origText,g,f[c]);if(f[c].origText!=f[c].innerHTML&&e>d){b=true;--e;--c}}if(!b){return}for(var c in f){f[c].origText=null;f[c].style.fontSize=e+"px";f[c].title=ISQ.Data.htmlEncode(f[c].title,"b",true)}};ISQ.Widget.Query.parseStemming=function(b,a){var e={stemmingData:{},text:[],lastWord:""};var d=function(m){var h=0;var f=[];var l=5;var k=0;for(var j=0;j<m.length;j++){var g=m.charAt(j);if(g=="|"){if(h==0){f.push(g)}continue}if(isNaN(g)){if(h>0){if(h<=l){f.push(m.substring(k,j))}h=0}f.push(g);continue}if(h==0){k=j}h++}if(h>0&&h<=l){f.push(m.substring(k,j))}return f.join("")};b=d(b);var c=b.split("|");iteration(c,function(f){var g=f.split(",");if(a){e.stemmingData[g[0]]=g[0]}else{e.stemmingData[g[0]]=[]}iteration(g,function(k,j){if(j!=0&&g[0]===k){return}var h=false;iteration(ISQ.Widget.Query.suggestionsBlacklist,function(l,m){if(l==k){h=true;return}});if(h){return}if(j==0){e.lastWord=k;e.text.push(k);return}if(a){e.stemmingData[k]=g[0]}else{e.stemmingData[g[0]].push(k)}})});e.text=e.text.join(" ");return e};ISQ.Widget.Query.epmphasizeText=function(a,f){var b=a.text.toLowerCase();var e=[];foreach(f.stemmingData,function(h,l){var j=ISQ.Widget.Query.searchForWord(e,l,b);if(j.status===ISQ.Widget.Query.enumSearchWord.word){e.push(j);return}var k;var g=false;iteration(h,function(m){k=ISQ.Widget.Query.searchForWord(e,m,b);if(k.status===ISQ.Widget.Query.enumSearchWord.word){e.push(k);g=true;return}});if(g){return}var k=null;if(a.stemmingData[l]){k=ISQ.Widget.Query.searchForWord(e,a.stemmingData[l],b);if(k.status===ISQ.Widget.Query.enumSearchWord.word){e.push(k);g=true;return}}if(g){return}iteration(h,function(m){k=ISQ.Widget.Query.searchForWord(e,a.stemmingData[m],b);if(k.status===ISQ.Widget.Query.enumSearchWord.word){e.push(k);g=true;return}});if(g){return}if(j.status===ISQ.Widget.Query.enumSearchWord.subword&&f.lastWord===l){e.push(j);
return}});var d=new Array(a.text.length);iteration(e,function(h){for(var g=h.ndx;g<h.endNdx;++g){d[g]=1}});e=[];var c=null;iteration(d,function(g,h){if(c===null){if(g){c={ndx:h}}}else{if(!g){c.endNdx=h;e.push(c);c=null}}});if(c){c.endNdx=a.text.length;e.push(c)}return ISQ.Widget.Query.emphasizeFinalizer(a.text,e)};ISQ.Widget.Query.enumSearchWord={none:0,word:1,subword:2};ISQ.Widget.Query.searchForWord=function(b,f,a){var e={status:ISQ.Widget.Query.enumSearchWord.none};var d=-1;for(var c=b.length-1;c>=0&&d===-1;--c){d=a.indexOf(" "+f+" ",b[c].endNdx);if(d!==-1){d++}}if(d===-1){d=a.indexOf(" "+f+" ");if(d!==-1){d++}}if(d!==-1){e.status=ISQ.Widget.Query.enumSearchWord.word}if(d===-1){d=a.indexOf(f+" ");if(d===0){e.status=ISQ.Widget.Query.enumSearchWord.word}else{if(d>0){e.status=ISQ.Widget.Query.enumSearchWord.subword}}}if(d===-1){d=a.indexOf(" "+f);if(d!==-1){d++;if(d+f.length===a.length){e.status=ISQ.Widget.Query.enumSearchWord.word}else{e.status=ISQ.Widget.Query.enumSearchWord.subword}}}if(d===-1){for(var c=b.length-1;c>=0&&d===-1;--c){d=a.indexOf(f,b[c].endNdx)}if(d===-1){d=a.indexOf(f)}if(d!==-1){e.status=ISQ.Widget.Query.enumSearchWord.word}}if(d!==-1){e.ndx=d;e.endNdx=d+f.length;e.word=f}return e};ISQ.Widget.Query.emphasizeFinalizer=function(e,b){var d=0;var a=[];for(var c=0;c<b.length;++c){if(b[c].ndx!=d){a.push(e.substring(d,b[c].ndx))}a.push("<b>");a.push(e.substring(b[c].ndx,b[c].endNdx));a.push("</b>");d=b[c].endNdx}if(d!=e.length){a.push(e.substring(d))}return a.join("")};ISQ.Widget.Query.timerElapsedHandler=function(b,a){ISQ.Widget.Query.queryChangedEvent.dispatch(b);if((!a&&b===ISQ.Widget.Query.lastQuerySent)||b.length===0){ISQ.Widget.HTML.searchAnim.hide();if(!b.length){ISQ.Widget.Query.hideAnswers(null,true)}return}if(ISQ.Cnf.limited){return}if(ISQ.Widget.state===ISQ.Widget.enumState.questions){ISQ.Widget.Query.send(b)}else{ISQ.Widget.HTML.searchAnim.hide()}};ISQ.Widget.Query.send=function(b,d,c){if(ISQ.Cnf.limited){return}if(!d){if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=query&isAutoQuestion="+(ISQ.Widget.state==ISQ.Widget.enumState.autoQuestions)+"&data="+ISQ.Tools.Base64.encodeString(b))
}if(b===""){ISQ.Widget.Log.add("empty query");return}ISQ.Widget.Log.add("Is same query: "+ISQ.Widget.Query.isSameQuery)}ISQ.Widget.Query.lastQuerySent=b;ISQ.Widget.Query.lastQuerySent_time=new Date();++ISQ.Widget.Query.activeRequestId;if(ISQ.Widget.state==ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.lastAutoQuestionRequestId=ISQ.Widget.Query.activeRequestId}if(c===ISQ.Widget.Query.enumTextQuerySource.suggestion){var a=ISQ.Widget.Query.kbLanguageCode!==ISQ.Widget.TranslationHelper.defaultLanguage?ISQ.Widget.Query.kbLanguageCode:null;ISQ.Widget.Query.send_internal(ISQ.Widget.Query.lastQuerySent,ISQ.Widget.Query.activeRequestId,null,a,c)}else{if(ISQ.Cnf.translationEnabled&&ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.queryTranslator=new ISQ.Widget.TranslationHelper.QueryTranslator({query:ISQ.Widget.Query.lastQuerySent,handler:new ISQ.Handler(ISQ.Widget.Query.send_internal),queryId:ISQ.Widget.Query.activeRequestId})}else{ISQ.Widget.Query.send_internal(ISQ.Widget.Query.lastQuerySent,ISQ.Widget.Query.activeRequestId,null,null,c)}}ISQ.Widget.Query.pendingRequest=true};ISQ.Widget.Query.send_internal=function(d,b,e,a,c){if(b!=ISQ.Widget.Query.activeRequestId){return}a=ISQ.Tools.getUniformLanguageCode(a);ISQ.Widget.Query.hidePopularSuggestions_detectedLanguage(a,d);ISQ.Widget.setUiLanguage(a);ISQ.Widget.Query.lastQueryTranslation=e;ISQ.Widget.setTitle();if(e&&ISQ.Widget.state===ISQ.Widget.enumState.questions){ISQ.Widget.HTML.searchAnim.show("searchAnim searchAnimTranslating")}_session().sendQuestion(ISQ.Widget.Query.responseHandler,d,b,ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions,ISQ.Widget.Query.isSameQuery,e,a,c===ISQ.Widget.Query.enumTextQuerySource.suggestion);ISQ.Widget.Query.isSameQuery=true;ISQ.Widget.Query.elementsToResize=null};ISQ.Widget.Query.getAnswerById=function(a,b,c){ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));ISQ.Widget.Query.hideAnswers(null,true);ISQ.Widget.Query.currentAnswersForComparison=ISQ.Widget.Query.currentAnswers=null;++ISQ.Widget.Query.activeRequestId;
ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.HTML.queryField.value="";ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.HTML.searchAnim.show();ISQ.Widget.Query.gettingAnswerById=true;ISQ.Widget.Query.pendingRequest=true;_session().getAnswerById(ISQ.Widget.Query.responseHandler,a,ISQ.Widget.Query.activeRequestId,ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||b,c);ISQ.Widget.Query.elementsToResize=null};ISQ.Widget.Query.responseHandler=function(response,handler){ISQ.Widget.Log.add("Query response received. parsing answers");var results=null;var similiarAnswers=false;var isAutoQuestion=false;var xml=response.xml;if(xml===null){ISQ.Widget.Log.add("Query: Illegal xml");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: illegal XML")}else{if(xml.childNodes.length==0){ISQ.Widget.Log.add("Query: Answer XML - empty");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: XML is empty")}else{if(xml.childNodes[0].nodeName==="parsererror"||(xml.childNodes.length>1&&xml.childNodes[1].nodeName==="parsererror")){ISQ.Widget.Log.add("Query: Illegal xml");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: error parsing XML")}else{var contextCategories=ISQ.Data.Xml.getFirstElementByName(xml,"contextCategories");if(contextCategories){try{var jsonData=eval("("+(contextCategories.firstChild.nodeValue)+")");ISQ.Widget.Query.contextCategories=[];for(var i=0;i<jsonData.values.length;++i){ISQ.Widget.Query.contextCategories[jsonData.values[i].id]=jsonData.values[i]}}catch(e){ISQ.Widget.Query.contextCategories=null}}var resultsNode=xml.getElementsByTagName("Results")[0];if(ISQ.Widget.Query.activeRequestId!=resultsNode.getAttribute("requestId")){ISQ.Widget.Log.add("Query: Request Id doesn't match. sent: "+ISQ.Widget.Query.activeRequestId+", received: "+resultsNode.getAttribute("requestId"));return}else{if(resultsNode.getAttribute("detectLanguage")==="true"){ISQ.Widget.Query.send(ISQ.Widget.Query.lastQuerySent,true);
return}ISQ.Widget.Query.kbLanguageCode=resultsNode.getAttribute("kbLanguageCode");var differentLanguage=ISQ.Widget.Query.previousDetectedLanguage&&ISQ.Widget.Query.previousDetectedLanguage!==ISQ.Widget.TranslationHelper.detectedLanguage;ISQ.Widget.Query.previousDetectedLanguage=ISQ.Widget.TranslationHelper.detectedLanguage;var topicsArr=resultsNode.getElementsByTagName("Topic");ISQ.Widget.Query.numberOfTopics=topicsArr.length;results=new Array();for(var i=0;i<ISQ.Widget.Query.numberOfTopics;++i){results.push(ISQ.Widget.Query.getResultObject(topicsArr[i]))}if(!handler&&!ISQ.Widget.Query.previousResponseWasAutoQuestion&&!differentLanguage&&ISQ.Widget.Query.currentAnswersForComparison&&results.length&&results.length===ISQ.Widget.Query.currentAnswersForComparison.length){var i=0;for(i=0;i<ISQ.Widget.Query.currentAnswersForComparison.length;++i){if(!ISQ.Widget.Query.compareResults(ISQ.Widget.Query.currentAnswersForComparison[i],results[i])){break}}similiarAnswers=i===ISQ.Widget.Query.currentAnswersForComparison.length}ISQ.Widget.Query.currentAnswersForComparison=results;ISQ.Widget.Query.previousResponseWasAutoQuestion=ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Widget.Query.gettingAnswerById;isAutoQuestion=ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||resultsNode.getAttribute("requestId")<=ISQ.Widget.Query.lastAutoQuestionRequestId}}}}if(ISQ.Widget.reportEvents){var msg=[];msg.push("subject=event&type=incomingsearchresults&hasresults=");msg.push((results.length!==0));msg.push("&isAutoQuestion=");msg.push(isAutoQuestion);msg.push("&query=");msg.push(ISQ.Tools.Base64.encodeString(ISQ.Widget.Query.lastQuerySent));msg.push("&results=");var evtResults=[];for(var i=0;i<results.length;++i){evtResults.push({answerId:results[i].id,title:results[i].translatedTitle?results[i].translatedTitle:results[i].title,body:results[i].translatedSummary?results[i].translatedSummary:results[i].summary,attachments:ISQ.Widget.buildAttachmentUrls_forEvent(results[i].attachments)})}msg.push(ISQ.Tools.Base64.encodeString(ISQ.Data.jsonToString(evtResults)));
ISQ.Widget.CDC.sendMessage(msg.join(""))}if(!similiarAnswers){if(ISQ.Cnf.faqData&&!ISQ.Widget.isFloat&&!ISQ.Widget.userActive&&ISQ.Widget.Query.gettingAnswerById&&((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0)&&results.length){ISQ.Widget.Query.fader_callback=function(){if(ISQ.Widget.userActive){return}ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnWidgetLoad)}}if(typeof(handler)!=="function"){handler=ISQ.Widget.Query.hideAnswers}handler(results,true)}else{ISQ.Widget.HTML.searchAnim.hide()}ISQ.Widget.Query.pendingRequest=false};ISQ.Widget.Query.replacePlaceholders_answerObject=function(c){var b=ISQ.Widget.replacePlaceholders(c.title,ISQ.Widget.API.getCustomParams(),"{{","}}");if(b.success){c.title=b.text;b=ISQ.Widget.replacePlaceholders(c.summary,ISQ.Widget.API.getCustomParams(),"{{","}}");if(b.success){c.summary=b.text}}if(!b.success){ISQ.Widget.Query.numberOfTopics--;return}if(c.translatedTitle){var b=ISQ.Widget.replacePlaceholders(c.translatedTitle,ISQ.Widget.API.getCustomParams(),"{{","}}");if(b.success){c.translatedTitle=b.text;b=ISQ.Widget.replacePlaceholders(c.translatedSummary,ISQ.Widget.API.getCustomParams(),"{{","}}");if(b.success){c.translatedSummary=b.text}}if(!b.success){ISQ.Widget.Query.numberOfTopics--;return}}var d={};ISQ.Tools.extend(true,d,c);if(!ISQ.Widget.Query.currentAnswers){ISQ.Widget.Query.currentAnswers=[]}ISQ.Widget.Query.currentAnswers.push(d);var a=ISQ.Data.getDBAnswerAsHtml(d.summary,false,ISQ.Widget.Query.appendQuestionTag,null,"ISQ.Widget.Query.namedAnchorClick",ISQ.Widget.referer.normal);d.summary=a.text;d.summaryScript=a.script;if(d.translatedTitle){a=ISQ.Data.getDBAnswerAsHtml(d.translatedSummary,false,ISQ.Widget.Query.appendQuestionTag,null,"ISQ.Widget.Query.namedAnchorClick",ISQ.Widget.referer.normal);d.translatedSummary=a.text}};ISQ.Widget.Query.processAnswers=function(results){if(!results||((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0)){ISQ.Widget.HTML.searchAnim.hide();return}if(ISQ.Widget.HTML.queryField.value===""&&ISQ.Widget.state===ISQ.Widget.enumState.questions&&!ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.HTML.searchAnim.hide();
return}try{var noActionBar=false;ISQ.Widget.Query.firstAnswerId=-1;ISQ.Widget.Query.chatEscalationAction=ISQ.Widget.Query.numberOfTopics==0?ISQ.Widget.enumChatEscalationActions.normal:ISQ.Widget.enumChatEscalationActions.hide;ISQ.Widget.Query.chatPushAnswers.pushed=false;ISQ.Widget.Query.currentAnswers=null;if(ISQ.Widget.Query.numberOfTopics>0){for(var i=0;i<results.length;++i){ISQ.Widget.Query.replacePlaceholders_answerObject(results[i])}}if(ISQ.Widget.Query.numberOfTopics>0){var resultObject;for(var i=0;i<ISQ.Widget.Query.numberOfTopics;i++){resultObject=ISQ.Widget.Query.currentAnswers[i];resultObject.answerNum=i;var answerLanguage=resultObject.languageCode||ISQ.Widget.Query.kbLanguageCode;if(i===0){ISQ.Widget.Query.firstAnswerId=resultObject.id;if(ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.Query.lastQuerySent=resultObject.title;if(!ISQ.Widget.userActive&&ISQ.Cnf.initialText){ISQ.Widget.HTML.queryField.value=ISQ.Cnf.initialText}else{if(ISQ.Cnf.autoQuestionsTypeEffect){ISQ.Widget.Query.typeTimer=new ISQ.Timer(new ISQ.Handler(ISQ.Widget.Query.typeQuestion),false,resultObject.translatedTitle||resultObject.title,0);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval)}else{ISQ.Widget.HTML.queryField.value=resultObject.translatedTitle||resultObject.title}}if(!ISQ.Widget.Query.lastWrittenQuery){ISQ.Widget.Query.lastWrittenQuery=resultObject.translatedTitle||resultObject.title}if(ISQ.Http.browser.isMobile&&window.top===window){document.body.scrollTop=0}}if(typeof(ISQ.Widget.iChat.instance)!=="undefined"&&ISQ.Widget.iChat.instance!=null){var skill="";if(resultObject.chatRequiredSkill){skill=resultObject.chatRequiredSkill}else{if(ISQ.Widget.Chat.chatConfig.skill){skill=ISQ.Widget.Chat.chatConfig.skill}}noActionBar=ISQ.Widget.iChat.instance.getAvailabilityPerAnswer(skill)}}ISQ.Widget.Query.chatEscalationAction=Math.max(ISQ.Widget.Query.chatEscalationAction,resultObject.chatEscalationAction);if(!ISQ.Widget.Query.chatInviteContent){ISQ.Widget.Query.chatInviteContent=resultObject.chatInviteContent
}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.pushChat){ISQ.Widget.Query.chatEscalationAction=ISQ.Widget.enumChatEscalationActions.normal}if(ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.pushChat){if(ISQ.Widget.Query.chatPushAnswers[resultObject.id]){ISQ.Widget.Query.chatEscalationAction=ISQ.Widget.enumChatEscalationActions.normal}ISQ.Widget.Query.chatPushAnswers[resultObject.id]=true}if(resultObject.translatedTitle){ISQ.Widget.Query.appendSingleAnswer({answerObject:resultObject,footer:ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum.footer),direction:ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage),showTranslateIcon:true,visible:true,translationProvider:resultObject.translationProvider,translated:true});ISQ.Widget.Query.appendSingleAnswer({answerObject:resultObject,footer:ISQ.Cnf.answerFooter,direction:ISQ.Translation.Infra.getLanguageDirection(ISQ.Cnf.initialUiLanguage),showTranslateIcon:true,visible:false,translationProvider:resultObject.translationProvider})}else{var answerTable=ISQ.Widget.Query.appendSingleAnswer({answerObject:resultObject,footer:ISQ.Cnf.answerFooter,direction:ISQ.Translation.Infra.getLanguageDirection(answerLanguage),showTranslateIcon:false,visible:true});resultObject.answerTable=answerTable}}}else{var previousQuestion=ISQ.Widget.Query.getCurrentQuestionFromTrail();if(previousQuestion){var backDiv=createDiv(ISQ.Widget.HTML.answerPane,".answerBackLinkContainer");var backLink=createLink({text:ISQ.Widget.getStaticText("back"),parent:backDiv,onclick:function(){ISQ.Widget.Query.popQuestionFromTrail();ISQ.Widget.Query.tempQuestionTrailId=null;if(ISQ.Widget.Query.typeTimer){ISQ.Widget.Query.typeTimer.cancel()}if(!this.question.isTagAnId){ISQ.Widget.Query.ask(this.question.tag,ISQ.Widget.Query.enumTextQuerySource.linkedAnswer)}else{ISQ.Widget.Query.tempQuestionTrailId=this.question.tag;ISQ.Widget.Query.getAnswerById(this.question.tag)
}}});backLink.question=previousQuestion}var direction=ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.kbLanguageCode)?ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage):ISQ.Widget.Localize.array.dir;var d=createDiv(ISQ.Widget.HTML.answerPane,".noResults &direction:"+direction);var noResultsMessage=ISQ.Widget.getStaticText("searchMsgNOResults");noResultsMessage=ISQ.Widget.replacePlaceholders(noResultsMessage,ISQ.Widget.API.getCustomParams(),"{{","}}",true).text;noResultsMessage=noResultsMessage.replace("{QUERY}",ISQ.Data.unHTML(_query(true)));d.innerHTML=noResultsMessage;try{var noResultsScript=ISQ.Widget.getStaticText("searchMsgNOResultsScript");if(noResultsScript){noResultsScript=ISQ.Widget.replacePlaceholders(noResultsScript,ISQ.Widget.API.getCustomParams(),"{{","}}",true).text;eval(noResultsScript)}if(ISQ.Cnf.faqData){ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnNoResuls)}}catch(e){}}ISQ.Widget.Query.displayAnswers(noActionBar)}catch(e){ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Log.add("Query.parseAnswers:"+e,ISQ.Widget.Log.statusEnum.RED)}};ISQ.Widget.Query.getResultObject=function(a){var b=a.getElementsByTagName("Translation");if(b.length!=0){b=b[0]}else{b=null}return{title:ISQ.Data.htmlEncode(a.getElementsByTagName("title")[0].firstChild.nodeValue),summary:a.getElementsByTagName("Summary")[0].firstChild.nodeValue,attachments:a.getElementsByTagName("attachments").length!=0?a.getElementsByTagName("attachments")[0].firstChild.nodeValue:"",id:a.getAttribute("id"),languageCode:a.getAttribute("languageCode")||null,externalSourceType:a.getAttribute("externalSourceType"),externalSourceId:a.getAttribute("externalSourceId"),translatedTitle:b?b.firstChild.nodeValue:null,translatedSummary:b?b.lastChild.nodeValue:null,translationProvider:a.getElementsByTagName("Translation").length>0?parseInt(a.getElementsByTagName("Translation")[0].getAttribute("provider")):null,chatEscalationAction:parseInt(a.getAttribute("chatAction")||ISQ.Widget.enumChatEscalationActions.normal),chatInviteContent:a.getElementsByTagName("ChatInvite").length!=0?a.getElementsByTagName("ChatInvite")[0].firstChild.nodeValue:null,chatRequiredSkill:a.getAttribute("chatRequiredSkill")||null,context:a.getElementsByTagName("context").length>0?ISQ.Data.parseArticleContext(a.getElementsByTagName("context")[0].firstChild.nodeValue):null,offline:a.getAttribute("offline")==="True",keywordsetId:a.getAttribute("keywordsetId"),likes:a.getAttribute("likes")?parseInt(a.getAttribute("likes")):0}
};ISQ.Widget.Query.compareResults=function(a,b){return a.title===b.title&&a.summary===b.summary&&a.id===b.id&&a.attachments===b.attachments&&a.externalSourceType===b.externalSourceType&&a.externalSourceId===b.externalSourceId&&a.translatedTitle===b.translatedTitle&&a.translatedSummary===b.translatedSummary&&a.translationProvider===b.translationProvider&&a.chatEscalationAction===b.chatEscalationAction&&a.chatInviteContent===b.chatInviteContent&&a.chatRequiredSkill===b.chatRequiredSkill&&ISQ.Tools.compareArrays(a.context,b.context)};ISQ.Widget.Query.appendSingleAnswer=function(obj){var summaryBuilder=[];var summary,title;var direction=ISQ.Widget.Localize.array.dir;if(obj.translated&&obj.answerObject.translatedTitle&&obj.answerObject.translatedSummary){summary=obj.answerObject.translatedSummary;title=obj.answerObject.translatedTitle;direction=obj.direction||ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage)}else{summary=obj.answerObject.summary;title=obj.answerObject.title;var directionByLanguage=(ISQ.Widget.HTML.dynamicRTLCssLoaded)?"rtl":"ltr";direction=(directionByLanguage!="")?directionByLanguage:obj.direction}var padding;var tbody=createTable(ISQ.Widget.HTML.answerPane,"",direction,".answerTable &"+(obj.style||""));var tableId="tblAnswer_"+obj.answerObject.id;tbody.parentNode.setAttribute("id",tableId+obj.visible);var textAlign=direction==="rtl"?"right":"left";var textAlignOpp=direction==="rtl"?"left":"right";if(title&&title.Trim()!==""){var tr=createRow(tbody,".TRanswerOnMouseout");tr.onmouseover=function(){this.className="TRanswerOnMouseover"};tr.onmouseout=function(){this.className="TRanswerOnMouseout"};var td=createTd(tr,"","top");var titleText;var titleTable=createTable(td,"100%",direction);var titleTr=createRow(titleTable);var titleTd=createTd(titleTr,"",(obj.isFAQ?"middle":"top"),".answerTitle &.expanded");var externalSourceIconShown=false;if(obj.answerObject.externalSourceType){var result=ISQ.Widget.Query.parseExternalSourceTitle(title,obj.answerObject.externalSourceType,obj.answerObject.externalSourceId);
titleText=result.title;if(result.sourceIcon!==null){externalSourceIconShown=true;td=createTd(titleTr,"","top",".answerIcon");td.appendChild(result.sourceIcon)}}else{titleText=ISQ.Data.breakWords(title)}if(obj.answerObject.answerNum==0&&!obj.translated){var previousQuestion=ISQ.Widget.Query.getCurrentQuestionFromTrail();if(previousQuestion){var backDiv=createDiv(document.body,".answerBackLinkContainer");var backLink=createLink({text:ISQ.Widget.getStaticText("back"),parent:backDiv,onclick:function(){ISQ.Widget.Query.popQuestionFromTrail();ISQ.Widget.Query.tempQuestionTrailId=null;if(ISQ.Widget.Query.typeTimer){ISQ.Widget.Query.typeTimer.cancel()}if(ISQ.Cnf.faqData&&this.question.tag==ISQ.Cnf.initialText){clearNode(ISQ.Widget.HTML.answerPane);ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.HTML.queryField.value=ISQ.Cnf.initialText;ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnClearSearchField)}else{if(!this.question.isTagAnId){ISQ.Widget.Query.ask(this.question.tag,ISQ.Widget.Query.enumTextQuerySource.linkedAnswer);ISQ.Widget.Query.clearTextboxOnInteraction=false}else{ISQ.Widget.Query.tempQuestionTrailId=this.question.tag;ISQ.Widget.Query.getAnswerById(this.question.tag)}}}});backLink.question=previousQuestion;ISQ.Widget.HTML.answerPane.insertBefore(backDiv,ISQ.Widget.HTML.answerPane.firstChild)}}var tdiv=createDiv(titleTd,".titleText");tdiv.innerHTML="<h3>"+titleText+"</h3>";tdiv.setAttribute("tabindex","5");if(obj.answerObject.context!=null&&ISQ.Widget.Query.contextCategories){var d=createDiv(titleTd,".answerContextContainer");for(var ndx in obj.answerObject.context){if((ISQ.Widget.Query.contextCategories[ndx]&&ISQ.Widget.Query.contextCategories[ndx].flags&ISQ.Widget.enumKBCategoriesFlags.visibleInWidget)!=ISQ.Widget.enumKBCategoriesFlags.visibleInWidget){continue}createElement("span",d,".answerContext").innerHTML=obj.answerObject.context[ndx]}}var translationIcon=null;if(obj.showTranslateIcon&&ISQ.Cnf.translationEnabled){var dir=obj.visible?direction:null;translationIcon=ISQ.Widget.Translation.createTranslationIcon(tableId,obj.translationProvider,direction,obj.visible);
if(translationIcon!==null){padding="&padding-"+(externalSourceIconShown?textAlign:textAlignOpp)+": 5px;";td=createTd(titleTr,"","top",".answerIcon &.globe "+padding);td.appendChild(translationIcon)}}var thumbIcon=null;var showFaqLikes=!ISQ.Http.browser.isIE7&&obj.isFAQ&&ISQ.Http.hashArguments.showlikes!=="false"&&ISQ.Http.urlArguments.showlikes!=="false";if(showFaqLikes){padding=translationIcon?"":"&padding-"+textAlign+": 5px;";td=createTd(titleTr,"","top",".answerIcon"+padding);thumbIcon=nanoRep.FAQ.Likes.buildThumbUpIcon(obj.answerObject.id,td,obj.answerObject.likes,direction==="rtl",ISQ.Cnf.cacheVar,ISQ.Widget.account,ISQ.Cnf.kbId,ISQ.Widget.isPreview,null,ISQ.Widget.referer.normal)}}if(summary){if(obj.answerObject.externalSourceType){summary=ISQ.Widget.Query.parseExternalSourceSummary(summary,obj.answerObject.externalSourceType)}summaryBuilder.push(summary)}ISQ.Widget.Query.appendAttachments(obj.answerObject.attachments,summaryBuilder);var answerFooterScript=null;if(summary&&(!ISQ.Cnf.showFooterOnlyOnLastAnswer||obj.answerObject.answerNum===ISQ.Widget.Query.numberOfTopics-1)){var replacerResult=ISQ.Widget.replacePlaceholders(obj.footer,ISQ.Widget.API.getCustomParams(),"{{","}}");if(replacerResult.success){answerFooterScript=ISQ.Widget.replacePlaceholders(ISQ.Cnf.answerFooterScript,ISQ.Widget.API.getCustomParams(),"{{","}}");if(answerFooterScript.success){answerFooterScript=answerFooterScript.text;summaryBuilder.push('<div class="answerFooter">');summaryBuilder.push(replacerResult.text);summaryBuilder.push("</div>")}else{answerFooterScript=null}}}var answerText=summaryBuilder.join("");var summaryTr=createRow(tbody,".summaryRow");var summaryTd=createTd(summaryTr,"","top",".answerBody");summaryTd.setAttribute("tabindex","5");if(!obj.isFAQ&&ISQ.Widget.state===ISQ.Widget.enumState.questions&&ISQ.Widget.userActive&&!obj.answerObject.externalSourceType){var row=createRow(tbody);var td=createTd(row,"","","");var likesContainer=createDiv(td,".articlelikeContainer");var likeDiv=createDiv(likesContainer,".iLike");var dislikeDiv=createDiv(likesContainer,".iDontLike");
ISQ.Widget.Thumb.Rememberer.addIcon(likeDiv,ISQ.Widget.Query.lastQuerySent,obj.answerObject.id,obj.answerObject.keywordsetId,obj.visible,obj.answerObject.likes,"up");ISQ.Widget.Thumb.Rememberer.addIcon(dislikeDiv,ISQ.Widget.Query.lastQuerySent,obj.answerObject.id,obj.answerObject.keywordsetId,obj.visible,0,"down")}if(obj.isFAQ&&titleTd){titleTd.onclick=function(){if(summaryTr.className.indexOf("collapsed")==-1){titleTd.className="answerTitle collapsed";summaryTr.className="summaryRow collapsed";ISQ.Widget.FAQ.removeThumbsForFAQarticle(summaryTr);ISQ.Widget.HTML.dynamicSize_sendMessage()}else{if(summaryTd.innerHTML){titleTd.className="answerTitle expanded";summaryTr.className="summaryRow expanded";if(summaryTr.likes){ISQ.Widget.FAQ.BuildThumbsForFAQarticle(summaryTr.likes.results,summaryTr,summaryTr.likes.likeIcon)}ISQ.Widget.HTML.dynamicSize_sendMessage()}else{if(titleTd.clickDisabled){return}titleTd.clickDisabled=true;ISQ.Widget.Query.pendingRequest=true;_session().getAnswerById(function(response){titleTd.clickDisabled=false;ISQ.Widget.Query.responseHandler(response,function(results){ISQ.Widget.FAQ.buildAnswer(results,titleTd,thumbIcon)})},obj.answerObject.id,ISQ.Widget.Query.activeRequestId,false,"FAQ")}}};titleTd.summaryTr=summaryTr;titleTd.summaryTd=summaryTd;tdiv.onkeyup=function(event4ff){var _event=ISQ.Html.getDomEvent(event4ff);if(_event.domEvent.keyCode==13){titleTd.onclick()}}}if(obj.collapsed){if(titleTd){titleTd.className="answerTitle collapsed"}summaryTr.className="summaryRow collapsed"}if(answerText){var parts=answerText.split(ISQ.Tools.pagerSeperator);if(parts.length>1){ISQ.Widget.Query.addAnswerPager(parts,summaryTd,tableId,direction)}else{summaryTd.innerHTML=answerText}}if(obj.answerObject.summaryScript){eval(obj.answerObject.summaryScript)}if(answerFooterScript&&(obj.answerObject.answerNum===ISQ.Widget.Query.numberOfTopics-1||!ISQ.Cnf.showFooterOnlyOnLastAnswer)){eval(answerFooterScript)}if(answerText){ISQ.Widget.Query.resizeSingleAnswerElements(summaryTd,true)}if(!obj.visible){tbody.parentNode.style.display="none"
}return tbody.parentNode};ISQ.Widget.Query.addAnswerPager=function(m,r,t,c){var j=[];ISQ.Widget.HTML.answerPane.style.display="block";var w=ISQ.CSS.getElementWidth(r,false);ISQ.Widget.HTML.answerPane.style.display="none";var n=c==="rtl";var f=ISQ.Http.browser.app==="ff";var v=ISQ.Http.browser.app==="chrome"||ISQ.Http.browser.app==="safari"||(ISQ.Http.browser.isMobile&&!f)||ISQ.Http.browser.isIE7;var b=createDiv(r,".pagedContainer");b.style.width=w+"px";var s=createTable(b,m.length*w+"px","","table-layout:fixed;direction:inherit;");var u=createRow(s,"top");var d;var l=function(z){j[z].style.height="auto";o(j[z].offset,0,function(){for(var A=0;A<j.length;A++){if(A!==z){j[A].style.height=0}}ISQ.Widget.HTML.dynamicSize_sendMessage();if(ISQ.Http.browser.isMobile||ISQ.Http.browser.isIE){var B=b.scrollLeft;ISQ.Widget.HTML.answerPane.restorePagerScroll=function(){try{b.scrollLeft=B}catch(C){}}}});ISQ.Widget.HTML.contentWrapper.scrollTop=0;var x=ISQ.Widget.HTML.answerPane.childNodes;for(var y=0;y<x.length;y++){if(!x[y].id.startsWith(t)){x[y].style.display=(z==0&&x[y].id.indexOf("true")>-1?"inline-table":"none")}}ISQ.Widget.HTML.dynamicSize_sendMessage()};var a=null;var h=ISQ.Widget.HTML.answerPane;do{a=ISQ.CSS.getValue(h,"background-color");h=h.parentNode}while(!a&&h!==document.body);if(!a){a="#FFF"}ISQ.CSS.addNewStyle(".answerTable .pagerLink.next, .answerTable .pagerLink.prev {display:block; color: "+a+"}");for(var g=0;g<m.length;g++){td=createTd(u);d=createDiv(td,"width:100%");var k=new ISQ.GUI.Pagination({page:g,pageSize:1,total:m.length,clickHandler:new ISQ.Handler(l),next:ISQ.Widget.Localize.array.next,prev:ISQ.Widget.Localize.array.prev});createDiv(d).innerHTML=m[g];td.style.width=w+"px";if(g>0){d.style.height=0}j[g]=d;if(n&&v){d.offset=w*(m.length-g-1)}else{d.offset=w*g}k.draw(createDiv(d,".pager"))}var e=70,p=3,q=7;var o=function(C,B,z){var A=Math.abs(b.scrollLeft);C=Math.abs(C);var y=Math.abs(A-C);if(y>p){delta=Math.min(e,Math.max(Math.floor(y/q),p))}else{delta=1}switch(B){case -1:z();return;case 0:if(C>A){B=1}else{if(!(n&&f)){delta*=-1
}B=2}break;case 1:if(C<=A){delta=0;B=-1}else{if(n&&f){delta*=-1}}break;case 2:if(C<A){if(!(n&&f)){delta*=-1}}else{delta=0;B=-1}break}if(delta!=0){b.scrollLeft+=delta}setTimeout(function(){o(C,B,z)},10)}};ISQ.Widget.Query.contentWrapperScroll=function(){var a=0;if(!ISQ.Widget.Query.currentAnswers){return}iteration(ISQ.Widget.Query.currentAnswers,function(b){var g;var e=b.peekElement;var f=ISQ.Html.position(b.answerTable).y;var c=f<ISQ.Widget.HTML.contentWrapper.scrollTop+ISQ.Widget.HTML.contentWrapper.offsetTop;var d=f>ISQ.Widget.HTML.contentWrapper.scrollTop+ISQ.Widget.HTML.contentWrapper.offsetHeight;if(c||d){if(!e){e=createDiv(ISQ.Widget.HTML.answerPane,".answerPeek");e.onclick=function(){ISQ.Widget.Query.scrollToElement(b.answerTable)};b.peekElement=e;ISQ.CSS.setWidthIncludingPadding(e,ISQ.Widget.HTML.answerPane.offsetWidth-ISQ.CSS.getPaddingWidth(ISQ.Widget.HTML.answerPane))}if(c){g=ISQ.Widget.HTML.contentWrapper.offsetTop+(a*ISQ.Widget.Query.peekElementHeight)+2;e.innerHTML="&#9650; "+b.title}else{g=ISQ.Widget.HTML.contentWrapper.offsetTop+ISQ.Widget.HTML.contentWrapper.offsetHeight-((3-a)*ISQ.Widget.Query.peekElementHeight)+2;e.innerHTML="&#9660; "+b.title}e.style.top=g+"px";e.style.display="block"}else{if(e){e.style.display="none"}}a++})};ISQ.Widget.Query.scrollToElement=function(a){var b=ISQ.Html.position(a).y-ISQ.Widget.HTML.contentWrapper.offsetTop;var c=b<ISQ.Widget.HTML.contentWrapper.scrollTop;var d=b>ISQ.Widget.HTML.contentWrapper.scrollTop+30;if(!c&&!d){if(ISQ.Widget.Query.scrollInterval){clearInterval(ISQ.Widget.Query.scrollInterval);ISQ.Widget.Query.scrollInterval=null}return}if(!ISQ.Widget.Query.scrollInterval){ISQ.Widget.Query.scrollInterval=setInterval(function(){ISQ.Widget.Query.scrollToElement(a)},1);return}if(d){ISQ.Widget.HTML.contentWrapper.scrollTop+=10}else{ISQ.Widget.HTML.contentWrapper.scrollTop-=10}};ISQ.Widget.Query.appendAttachments=function(b,d){if(!b){return}d.push('<ul class="attachments">');var a=b.split(",");for(var c=0;c<a.length;c++){d.push("<li>");ISQ.Widget.Query.buildAttachmentLink(a[c],d);
d.push("</li>")}d.push("</ul>")};ISQ.Widget.Query.buildAttachmentLink=function(c,b){var a=c.indexOf("/");if(a==-1){return}b.push('<a href="');b.push("http://");b.push(c.substring(0,a));b.push(".s3.amazonaws.com/");b.push(c.substring(a+1));b.push('" target="_blank">');ISQ.Data.breakWords(c.substring(c.lastIndexOf("/")+1),b);b.push("</a>")};ISQ.Widget.Query.toTranslateContent=function(b,c){if(!ISQ.Cnf.translationEnabled||ISQ.Cnf.translationDetectionOnly){return false}if(!ISQ.Widget.TranslationHelper.languageEnabled){return false}if(ISQ.Widget.Query.popularSuggestions_clicked){ISQ.Widget.Query.popularSuggestions_clicked=false;return false}if(!c){c=ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage)}if(!c){return false}var a=ISQ.Tools.getUniformLanguageCode(b);return c!=a};ISQ.Widget.Query.getFader=function(){if(ISQ.Widget.Query.fader===null){ISQ.Widget.Query.fader=new VisualEffects.Fade(ISQ.Widget.HTML.answerPane);ISQ.Widget.Query.fader.fadeOutEvent.addHandler(ISQ.Widget.Query.fader_fadeOutHandler);ISQ.Widget.Query.fader.fadeInEvent.addHandler(ISQ.Widget.Query.fader_fadeInHandler)}return ISQ.Widget.Query.fader};ISQ.Widget.Query.displayAnswers=function(d){var a=(ISQ.Widget.iChat.instance&&ISQ.Widget.iChat.instance.available())||(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action===ISQ.Widget.enumCustomLinkStats.countChatEscalation);if(ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.Query.chatInviteContent&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.inviteChat&&a){var b=createDiv(null,".chatInviteDiv");b.innerHTML=ISQ.Widget.Query.chatInviteContent;ISQ.Widget.HTML.answerPane.insertBefore(b,ISQ.Widget.HTML.answerPane.firstChild);ISQ.Widget.Query.chatInviteContent=null;if(ISQ.Widget.iChat.instance&&ISQ.Widget.iChat.instance.available()){b.onclick=function(){ISQ.Widget.Chat.requestChat(ISQ.Widget.enumChatEscalationActions.inviteChat)}}else{b.onclick=function(){b.style.display="none";ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customChat,ISQ.Widget.enumChatEscalationActions.inviteChat)
}}}if(!d&&ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.userActive){ISQ.Widget.Query.showActionBar()}ISQ.Widget.HTML.answerPane.style.display="block";if(ISQ.Http.browser.full!=="safari3"){ISQ.Widget.HTML.contentWrapper.scrollTop=0}ISQ.Widget.HTML.dynamicSize_sendMessage();if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.answerPane)){var c=ISQ.Widget.Query.getFader();c.fadeIn(200,true)}else{ISQ.Widget.Query.fader_fadeInHandler()}if(a&&ISQ.Widget.state===ISQ.Widget.enumState.questions&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.pushChat&&!ISQ.Widget.Query.chatPushAnswers.pushed){ISQ.Widget.Query.chatPushAnswers.pushed=true;if(ISQ.Widget.iChat.instance&&ISQ.Widget.iChat.instance.available()){ISQ.Widget.Chat.requestChat(ISQ.Widget.enumChatEscalationActions.pushChat)}else{ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customChat,ISQ.Widget.enumChatEscalationActions.pushChat)}}ISQ.Widget.Query.resizeAnswerElements()};ISQ.Widget.Query.showActionBar=function(){var d=null;var b=null;var c=null;if(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action!==ISQ.Widget.enumCustomLinkStats.countChatEscalation){d=c=_("customLink")}else{d=_("repByEmail")}d.innerHTML=ISQ.Widget.getStaticText("email");d.setAttribute("tabindex","6");var j=false;switch(ISQ.Cnf.showChatConfiguration){case ISQ.Widget.enumShowChatConfiguration.always:j=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.hide;break;case ISQ.Widget.enumShowChatConfiguration.selectedAnswers:j=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.normal;break;case ISQ.Widget.enumShowChatConfiguration.selectedAnswers_and_noAnswers:j=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.normal||ISQ.Widget.Query.firstAnswerId===-1;break}if(j){if(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action===ISQ.Widget.enumCustomLinkStats.countChatEscalation){b=c=_("customChat")}else{if(ISQ.Widget.iChat.instance&&ISQ.Widget.iChat.instance.available()){b=_("repByChat")
}}if(b){b.innerHTML=ISQ.Widget.getStaticText("chat");b.setAttribute("tabindex","7")}}if(c){c.href=ISQ.Widget.Query.buildCustomLink(ISQ.Cnf.customEscalationLink);switch(ISQ.Cnf.customEscalationLink_target){case ISQ.Widget.enumCustomLinkTarget.CurrentPage:c.target="_top";break;case ISQ.Widget.enumCustomLinkTarget.NewTab:c.target="_blank";break;case ISQ.Widget.enumCustomLinkTarget.Popup:c.target="_blank";break;case ISQ.Widget.enumCustomLinkTarget.Widget:c.target="_self";break;default:c.target="_blank";break}}_("customLink").style.display="none";_("repByEmail").style.display="none";_("customChat").style.display="none";_("repByChat").style.display="none";_("actionBarSep").style.display="none";if(b){b.style.display="block";if(ISQ.Widget.Chat.chatConfig.showEmailButton){_("actionBarSep").style.display="block";d.style.display="block"}}else{d.style.display="block"}ISQ.Widget.HTML.showActionBar();if(ISQ.Widget.HTML.pendingShowActionBar){return}var a=_("actionBarText");a.innerHTML="";var l=ISQ.Widget.HTML.actionBarQuery.offsetWidth;var g=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.actionBarQuery,"padding-left");if(g){l-=parseInt(g)}var h=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.actionBarQuery,"padding-right");if(h){l-=parseInt(h)}var e=ISQ.CSS.getElementStyle(a,"margin-left");if(e){l-=parseInt(e)}var f=ISQ.CSS.getElementStyle(a,"margin-right");if(f){l-=parseInt(f)}l=l-_("repByEmail").offsetWidth-_("actionBarSep").offsetWidth-_("repByChat").offsetWidth;var k=ISQ.Cnf.customAskRepByText||ISQ.Widget.getStaticText("askBy");ISQ.Data.autoEllipseText(k,l,a,null,null,"#actionBarWrapper")};ISQ.Widget.Query.buildCustomLink=function(d){var c=d.replace("{QUERY}",encodeURIComponent(_query(true)));var a=nanoRep.Widget.API.getCustomParams();for(var b in a){c=c.replace("{"+b+"}",encodeURIComponent(a[b]));c=c.replace("{!"+b+"}",a[b])}c=c.replace(/\{.*?\}/g,"");return c};ISQ.Widget.Query.hideAnswers=function(c,a,d){ISQ.Widget.Query.fader_clearAnswers=a;ISQ.Widget.Query.fader_tempXml=c;ISQ.Widget.FAQ.shown=false;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.answerPane)){var b=ISQ.Widget.Query.getFader();
b.fadeOut(200)}else{ISQ.Widget.Query.fader_fadeOutHandler()}if(ISQ.Cnf.translationEnabled){ISQ.Widget.Translation.toggleTranslationTooltip(null,false)}};ISQ.Widget.Query.resizeSingleAnswerElements=function(b,a,f){if(f){ISQ.Widget.Query.resizeToWidth=f}else{ISQ.Widget.Query.resizeToWidth=0}for(var d=0;d<ISQ.Widget.Query.resizeableTags.length;++d){var c=b.getElementsByTagName(ISQ.Widget.Query.resizeableTags[d]);for(var e=0;e<c.length;++e){if(!ISQ.Widget.HTML.isTeaser){ISQ.Widget.Query.resizeAnswerElement(c[e])}if(a){if(!ISQ.Widget.Query.elementsToResize){ISQ.Widget.Query.elementsToResize=new Array()}ISQ.Widget.Query.elementsToResize.push(c[e])}if(ISQ.Widget.Query.resizeableTags[d]==="IMG"){c[e].style.visibility="hidden";c[e].onload=function(){this.loaded=true;this.setAttribute("loaded","true");this.style.visibility="visible";if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.currentlyResizing){return}ISQ.Widget.Query.resizeAnswerElement(this)}}}}};ISQ.Widget.Query.resizeAnswerElements=function(){if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.currentlyResizing){return}if(!ISQ.Widget.Query.resizeToWidth){var b=ISQ.CSS.getElementWidth(ISQ.Widget.HTML.answerPane)-ISQ.CSS.getPaddingWidth(ISQ.Widget.HTML.answerPane);ISQ.Widget.Query.resizeToWidth=b}if(!ISQ.Widget.Query.elementsToResize){return}for(var a=0;a<ISQ.Widget.Query.elementsToResize.length;++a){ISQ.Widget.Query.resizeAnswerElement(ISQ.Widget.Query.elementsToResize[a])}};ISQ.Widget.Query.resizeAnswerElement=function(c){if(ISQ.Widget.Query.resizeToWidth<=0){return}if(c.nodeName==="IMG"){var f=c.getAttribute("loaded")==="true";if(!f&&!c.loaded){return}}ISQ.Widget.HTML.dynamicSize_sendMessage();var e=parseInt(c.getAttribute("lastResizeWidth"));if(!isNaN(e)){if(e===ISQ.Widget.Query.resizeToWidth){return}}else{if(c.lastResizeWidth===ISQ.Widget.Query.resizeToWidth){return}}c.lastResizeWidth=ISQ.Widget.Query.resizeToWidth;c.setAttribute("lastResizeWidth",ISQ.Widget.Query.resizeToWidth);var b=c.getAttribute("widthChanged")==="true";var k=c.offsetWidth;if(k===0){return
}if(k>ISQ.Widget.Query.resizeToWidth||b){var a=c.getAttribute("_ratio");if(!a){var d=c.offsetHeight;a=d/k;c.setAttribute("_ratio",a)}else{a=parseFloat(a)}var j=c.getAttribute("originalWidth");if(!j){j=k;c.setAttribute("originalWidth",j)}else{j=parseFloat(j)}var h=ISQ.Widget.Query.resizeToWidth-5;if(h>j){h=j}var g=parseInt(a*h);c.style.width=h+"px";c.style.height=g+"px";c.setAttribute("widthChanged","true");c.setAttribute("width",h+"px");c.setAttribute("height",g+"px")}};ISQ.Widget.Query.fader_clearAnswers=false;ISQ.Widget.Query.fader_tempXml=null;ISQ.Widget.Query.fader_callback=null;ISQ.Widget.Query.fader_fadeOutHandler=function(){if(ISQ.Widget.Query.fader_clearAnswers){clearNode(ISQ.Widget.HTML.answerPane)}else{ISQ.Widget.HTML.answerPane.style.display="none";ISQ.Widget.HTML.dynamicSize_sendMessage()}ISQ.Widget.Query.fader_clearAnswers=false;ISQ.Widget.Query.firstAnswerId=-1;if(ISQ.Widget.Query.fader_tempXml){ISQ.Widget.Query.processAnswers(ISQ.Widget.Query.fader_tempXml);ISQ.Widget.Query.fader_tempXml=null}if(typeof(ISQ.Widget.Query.fader_callback)==="function"){ISQ.Widget.Query.fader_callback();ISQ.Widget.Query.fader_callback=null}};ISQ.Widget.Query.fader_fadeInHandler=function(){ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.HTML.fixContentWidths();if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.showNext()}if(ISQ.Cnf.answerPeeksEnabled){ISQ.Widget.Query.contentWrapperScroll()}};ISQ.Widget.getStaticText=function(b){var a;if(ISQ.Cnf.translationEnabled&&ISQ.Widget.TranslationHelper.detectedLanguage&&ISQ.Widget.TranslationHelper.staticTranslationsEnum[b]){a=ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum[b])}else{if(!a){a=ISQ.Cnf[b]}}if(!a||(ISQ.Cnf.translationEnabled&&((ISQ.Cnf.uiLanguageCode&&ISQ.Widget.TranslationHelper.detectedLanguage!==ISQ.Cnf.uiLanguageCode)||(ISQ.Widget.TranslationHelper.detectedLanguage&&ISQ.Widget.TranslationHelper.detectedLanguage!==ISQ.Cnf.kbLanguageCode)))){a=ISQ.Widget.Localize.array[b]}return a};ISQ.Widget.setInitialTexts=function(){if(ISQ.Cnf.customEmailButtonText){ISQ.Widget.Localize.array.email=ISQ.Cnf.customEmailButtonText.Trim()
}if(ISQ.Cnf.customAskRepByText){ISQ.Widget.Localize.array.askBy=ISQ.Cnf.customAskRepByText.Trim()}if(ISQ.Cnf.customChatButtonText){ISQ.Widget.Localize.array.chat=ISQ.Cnf.customChatButtonText.Trim()}if(ISQ.Cnf.customNoAnswersText){ISQ.Widget.Localize.array.searchMsgNOResults=ISQ.Cnf.customNoAnswersText.Trim();var a=ISQ.Data.getDBAnswerAsHtml(ISQ.Cnf.customNoAnswersText.Trim(),true,null,null,null,ISQ.Widget.referer.normal);ISQ.Widget.Localize.array.searchMsgNOResults=a.text;ISQ.Widget.Localize.array.searchMsgNOResultsScript=a.script}if(ISQ.Cnf.titleTeaserText){ISQ.Widget.Localize.array.titleTeaserText=ISQ.Cnf.titleTeaserText.Trim()}if(ISQ.Cnf.titleNormalText){ISQ.Widget.Localize.array.titleNormalText=ISQ.Cnf.titleNormalText.Trim()}ISQ.Widget.setTitle()};ISQ.Widget.setTitle=function(){var a;if(ISQ.Widget.customTitle){a=ISQ.Widget.customTitle}if(ISQ.Widget.HTML.isTeaser&&(!ISQ.Widget.isFloat||ISQ.Widget.HTML.currentWidth!==ISQ.Cnf.floatCollapsed_WidgetSize[0])){if(ISQ.Widget.customTeaserText){a=ISQ.Widget.customTeaserText}else{if(!ISQ.Widget.customTitle){a=ISQ.Widget.getStaticText("titleTeaserText")}}ISQ.Widget.HTML.titleWrapper.style.cursor="pointer"}else{if(ISQ.Widget.customTitle){a=ISQ.Widget.customTitle}else{a=ISQ.Widget.getStaticText("titleNormalText")}ISQ.Widget.HTML.titleWrapper.style.cursor="default"}ISQ.Widget.HTML.titleText.innerHTML=a};ISQ.Widget.onCustomerLogoLoad=function(){var c=ISQ.Cnf.customerBrandingLogo_img;var a=_("customerLogo");a.src=c.src;var b=_("widgetFooter");if(ISQ.Widget.HTML.currentlyResizing||ISQ.Widget.HTML.isTeaser){a.pendingResize=true;return}a.pendingResize=false;a.style.display="block";if(b.offsetHeight<c.height){b.style.height=c.height+"px";ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()}else{var d=Math.floor(b.offsetHeight/2)-Math.floor(c.height/2)+"px";a.style.marginTop=d;if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.lineHeight=b.offsetHeight+"px"}}ISQ.Widget.HTML.Mobile.setPositions()};ISQ.Widget.Translation=initializeNS("ISQ.Widget.Translation");
ISQ.Widget.Translation.createTranslationIcon=function(e,a,b,f){var d=createLink({style:f?".translationIcon":".translationIconOff",onclick:function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,false);ISQ.Widget.Translation.toggleAnswerTranlsationVisibility(e);if(ISQ.Widget.HTML.answerPane.restorePagerScroll){ISQ.Widget.HTML.answerPane.restorePagerScroll()}}});d.onmouseover=function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,true)};d.onmouseout=function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,false)};if(ISQ.Widget.Translation.translationTooltipDiv===null){ISQ.Widget.Translation.translationTooltipDiv=createDiv(document.body,".translationTooltip")}if(b){ISQ.Widget.Translation.translationTooltipDiv.style.direction=b}var c=new Array();c.push(ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum.translatedFrom));c.push("<p dir=ltr>");switch(a){case ISQ.Translation.Infra.providerEnum.Microsoft:c.push("Translation powered by Microsoft&reg; Translator");break;case ISQ.Translation.Infra.providerEnum.GoogleV1:case ISQ.Translation.Infra.providerEnum.GoogleV2:c.push("Translation powered by <img src='/widget/skins/googleLogo.png?cv=1' align='absmiddle' alt=''/>");break}c.push("</p>");ISQ.Widget.Translation.translationTooltipDiv.innerHTML=c.join("");return d};ISQ.Widget.Translation.toggleTranslationTooltip=function(a,d){if(!ISQ.Widget.Translation.translationTooltipDiv){return}var e=ISQ.Widget.Translation.translationTooltipDiv;if(d){if(!a){return}var c=ISQ.Html.position(a);var g=ISQ.Html.screenSize().w;var f=e.offsetWidth;var b=(c.x-f/2+8);b=b<0?0:b+f>g?g-f:b;e.style.left=b+"px";e.style.top=(c.y+20-ISQ.Widget.HTML.contentWrapper.scrollTop)+"px";e.style.visibility="visible"}else{e.style.visibility="hidden"}};ISQ.Widget.Translation.toggleAnswerTranlsationVisibility=function(e){var a=e+"true";var b=e+"false";var c=_(a,true);var d=_(b,true);if(c&&d){var f=c.style.display;c.style.display=d.style.display;d.style.display=f;ISQ.Widget.Query.resizeSingleAnswerElements(d,false);
ISQ.Widget.HTML.dynamicSize_sendMessage()}};ISQ.Widget.Translation.translationFailedHandler=function(b,a){var c=null;var d=a==null?"":ISQ.Translation.Infra.getProviderName(a);switch(b){case ISQ.Translation.Infra.failureEnum.DetectionTimeout:c="Language detection has timed out using provider: "+d;break;case ISQ.Translation.Infra.failureEnum.DetectionApiFallback:c="Language detection: falling back from provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationTimeout:c="Translation has timed out using provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationApiFallback:c="Translation: falling back to provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationDead:c="Both API Providers have failed. Translations are now turned off.";ISQ.Cnf.translationEnabled=false;if(ISQ.Widget.Query.answerTranslator){ISQ.Widget.Query.answerTranslator.translationFailed();ISQ.Widget.Query.answerTranslator=null}else{if(ISQ.Widget.Query.queryTranslator){ISQ.Widget.Query.queryTranslator.translationFailed();ISQ.Widget.Query.queryTranslator=null}}break}_session().translationFailed(b,c,a,null)};ISQ.Widget.Translation.translationTooltipDiv=null;ISQ.Widget.Query.parseExternalSourceTitle=function(g,f,e){var b="",a="",c="";switch(f){case"twitter":g=ISQ.Data.parseTwitterStatus(g);b="twitterSourceIcon";a="This answer's source is Twitter";c="http://www.twitter.com/"+e;break}var d=createLink({style:".answerSourceIcon "+b,title:a,href:c,target:"_blank"});return{title:g,sourceIcon:d}};ISQ.Widget.Query.parseExternalSourceSummary=function(b,a){switch(a){case"twitter":return(new Date(ISQ.Tools.Time.toClientTicks(b))).ToString("%d/%m/%y   %H:%M")}};ISQ.Widget.Thumb={};ISQ.Widget.Thumb.send=function(a,c,e){if(!a){return}var d=_query(true);if(!d){if(ISQ.Widget.Query.currentAnswers&&ISQ.Widget.Query.currentAnswers.length!=0){d=ISQ.Widget.Query.currentAnswers[0].title}}if(!d){return}ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));if(ISQ.Widget.reportEvents){var b="";iteration(ISQ.Widget.Query.currentAnswers,function(f){if(f.id===a){b=f.title;
return false}});ISQ.Widget.CDC.sendMessage("subject=event&type=like&query="+ISQ.Tools.Base64.encodeString(d)+"&answer="+ISQ.Tools.Base64.encodeString(b))}ISQ.Widget.HTML.hideActionBar();if(ISQ.Widget.TranslationHelper.detectedLanguage!=ISQ.Widget.Query.kbLanguageCode&&ISQ.Widget.Query.lastQueryTranslation){d=ISQ.Widget.Query.lastQueryTranslation}_session().thumbClicked(ISQ.Widget.Thumb.parseResponse,a,c,d,ISQ.Widget.Query.kbLanguageCode,e)};ISQ.Widget.Thumb.parseResponse=function(a){var b=a.xml.getElementsByTagName("Result")[0];var e=b.getAttribute("type");if(e!=="thumb-up"&&e!=="thumb-down"){return}var c=(e=="thumb-up")?"up":"down";var d=b.getAttribute("topicId");ISQ.Widget.Thumb.Rememberer.set(d,c)};ISQ.Widget.Thumb.Rememberer={};ISQ.Widget.Thumb.Rememberer.idArray=new Array();ISQ.Widget.Thumb.Rememberer.queryArray=new Array();ISQ.Widget.Thumb.Rememberer.currentQuery="";ISQ.Widget.Thumb.Rememberer.addIcon=function(g,h,j,d,k,e,c){var b="thumbUpApplied";var a="thumbUp";if(c=="down"){b="thumbDownApplied";a="thumbDown"}if(typeof(ISQ.Widget.Thumb.Rememberer.queryArray[" "+h])==="undefined"){ISQ.Widget.Thumb.Rememberer.queryArray[" "+h]=new Array()}else{if(ISQ.Widget.Thumb.Rememberer.currentQuery!==h){delete ISQ.Widget.Thumb.Rememberer.queryArray[" "+h];ISQ.Widget.Thumb.Rememberer.queryArray[" "+h]=new Array()}}ISQ.Widget.Thumb.Rememberer.currentQuery=h;ISQ.Widget.Thumb.Rememberer.queryArray[" "+h].push(j);var f=null;if(typeof(ISQ.Widget.Thumb.Rememberer.idArray[j])!=="undefined"&&typeof(ISQ.Widget.Thumb.Rememberer.idArray[j])!=="undefined"&&(ISQ.Widget.Thumb.Rememberer.idArray[j]==="1"||ISQ.Widget.Thumb.Rememberer.idArray[j]==="2")){f=createLink({parent:g});if((ISQ.Widget.Thumb.Rememberer.idArray[j]==="1"&&c=="up")||(ISQ.Widget.Thumb.Rememberer.idArray[j]==="2"&&c=="down")){f.className=b}else{f.className=a}}else{f=createLink({parent:g,onclick:function(){if(c=="up"){ISQ.Widget.Thumb.send(j,d,nanoRep.FAQ.Likes.enumFeedback.positive)}else{ISQ.Widget.Thumb.Rememberer.dislikeOptions(this,j,d,ISQ.Widget.Thumb.send)}},title:(c=="up")?nanoRep.FAQ.Localization.like:nanoRep.FAQ.Localization.dislike});
f.id=ISQ.Widget.Thumb.Rememberer.getIconElement(j,k,c);f.oppositeId=ISQ.Widget.Thumb.Rememberer.getIconElement(j,k,(c=="up")?"down":"up");f.className=a;f.widgetAnswer=true}if(c=="down"){return}if(ISQ.Widget.Localize.array.dir==="rtl"){createDiv(g,".newLikesRightEdge");f.likesCounter=createDiv(g,".newlikes");f.style["float"]="right";f.likesCounter.className+=" newlikesRTL";if(f.style.setProperty){f.style.setProperty("float","right")}else{f.style.setAttribute("float","right")}}else{createDiv(g,".newLikesLeftEdge");f.likesCounter=createDiv(g,".newlikes")}f.likesCounter.innerHTML=(e)?e:"0"};ISQ.Widget.Thumb.Rememberer.dislikeOptions=function(b,f,c,a){var e=ISQ.Widget.Localize.array.dir==="rtl";var d={};d.thumbDown=b;d.thumbDown.newPosition={left:"-1px",top:"-135px"};nanoRep.FAQ.Likes.saveData(d,f,e,null,null,null,null,null,a,c);nanoRep.FAQ.Likes.toggleDislikeOptions(false,e)};ISQ.Widget.Thumb.Rememberer.set=function(j,f){if(!ISQ.Widget.Thumb.Rememberer.queryArray[" "+ISQ.Widget.Thumb.Rememberer.currentQuery]){return}var h=ISQ.Widget.Thumb.Rememberer.queryArray[" "+ISQ.Widget.Thumb.Rememberer.currentQuery].length;for(var g=0;g<h;++g){var e=ISQ.Widget.Thumb.Rememberer.queryArray[" "+ISQ.Widget.Thumb.Rememberer.currentQuery][g];var a=_(ISQ.Widget.Thumb.Rememberer.getIconElement(e,true,f),true);var c=_(ISQ.Widget.Thumb.Rememberer.getIconElement(e,false,f),true);var b=_(ISQ.Widget.Thumb.Rememberer.getIconElement(e,true,(f=="up")?"down":"up"),true);var d=_(ISQ.Widget.Thumb.Rememberer.getIconElement(e,false,(f=="up")?"down":"up"),true);if(e==j){if(a!==null){ISQ.Widget.Thumb.Rememberer.disableLikeIcon(a,f);a.style.cursor="default";a.title="";b.className+=(f=="up")?" opacity20":" opacity30";b.title=""}if(c!==null){ISQ.Widget.Thumb.Rememberer.disableLikeIcon(c,f);c.style.cursor="default";c.title="";d.className+=(f=="up")?" opacity20":" opacity30";d.title=""}if(!ISQ.Widget.Thumb.Rememberer.idArray[j]){ISQ.Widget.Thumb.Rememberer.idArray[j]={}}ISQ.Widget.Thumb.Rememberer.idArray[j]=(f=="up")?"1":"2"}else{if(a!==null){a.className+=(f=="up")?" opacity20":" opacity30";
a.title="";b.className+=(f=="up")?" opacity20":" opacity30";b.title="";a.onclick=b.onclick=null}if(c!==null){c.className+=(f=="up")?" opacity20":" opacity30";c.title="";d.className+=(f=="up")?" opacity20":" opacity30";d.title="";c.onclick=d.onclick=null}}}ISQ.Widget.Thumb.Rememberer.currentQuery=""};ISQ.Widget.Thumb.Rememberer.isIdThumbed=function(b,a){return(typeof(ISQ.Widget.Thumb.Rememberer.idArray[b][a])!=="undefined"&&(ISQ.Widget.Thumb.Rememberer.idArray[b][a]==="1"||ISQ.Widget.Thumb.Rememberer.idArray[b][a]==="2"))};ISQ.Widget.Thumb.Rememberer.disableLikeIcon=function(a,c){var b="thumbUpApplied";if(c=="down"){b="thumbDownApplied"}a.className=b;a.onclick=null;a.title="";var d=_(a.oppositeId);if(d){d.onclick=null;d.title=""}};ISQ.Widget.Thumb.Rememberer.getIconElement=function(b,c,a){return"thumb"+a+"Image"+b+c};ISQ.Widget.Escalate={};ISQ.Widget.Escalate.enumType={email:0,customEmail:1,customChat:2,chat:3,customEmail_fromContactForm:4};ISQ.Widget.Escalate.toEmail=function(){if(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action!==ISQ.Widget.enumCustomLinkStats.countChatEscalation){_("customLink").onclick()}else{_("repByEmail").onclick()}};ISQ.Widget.Escalate.send=function(e,a,c){if(typeof(a)==="undefined"){a=null}if(typeof(c)==="undefined"){c=false}if(a){c=true}ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));var d=_query(true);if(ISQ.Widget.Query.lastWrittenQuery){if(ISQ.Widget.Query.typeTimer){ISQ.Widget.Query.typeTimer.cancel();ISQ.Widget.Query.clearTextboxOnInteraction=false}d=ISQ.Widget.Query.lastWrittenQuery;if(e!=ISQ.Widget.Escalate.enumType.customEmail_fromContactForm){ISQ.Widget.HTML.queryField.value=ISQ.Widget.Query.lastWrittenQuery}}if(!c&&!d){return}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.stop_()}if(e!==ISQ.Widget.Escalate.enumType.chat){ISQ.Widget.HTML.Mobile.hideAddressbar();if(e===ISQ.Widget.Escalate.enumType.customEmail){ISQ.Widget.state=ISQ.Widget.enumState.customLink}else{ISQ.Widget.state=ISQ.Widget.enumState.contactForm}ISQ.Widget.HTML.hideActionBar()
}ISQ.Widget.Query.lastQuerySent="";_session().escalateQuestion(ISQ.Widget.Escalate.parseResponse,ISQ.Widget.Query.firstAnswerId,d,ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage),ISQ.Widget.Query.lastQueryTranslation,e,a);if(e===ISQ.Widget.Escalate.enumType.customEmail||e===ISQ.Widget.Escalate.enumType.customChat){if(ISQ.Cnf.customEscalationLink_target===ISQ.Widget.enumCustomLinkTarget.Popup||(e===ISQ.Widget.Escalate.enumType.customChat&&a!=ISQ.Widget.enumChatEscalationActions.normal)){var f=800,b=600;if(ISQ.Cnf.customLinkPopupSize!=null){f=ISQ.Cnf.customLinkPopupSize[0];b=ISQ.Cnf.customLinkPopupSize[1]}window.open(ISQ.Widget.Query.buildCustomLink(ISQ.Cnf.customEscalationLink),"nr_escalationWindow","height="+b+",width="+f);return false}else{return true}}};ISQ.Widget.Escalate.parseResponse=function(d){ISQ.Widget.Log.add("post question response received");if(d.xml===null){ISQ.Widget.Log.add("Error parsing escalation response");return}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){ISQ.Widget.HTML.contentWrapper.scrollTop=0}try{var f=d.xml.getElementsByTagName("Result")[0];var j=f.getAttribute("type");var g,h,b;var b=d.token.tag;switch(b.escType){case ISQ.Widget.Escalate.enumType.email:b.escType="email";break;case ISQ.Widget.Escalate.enumType.customEmail:b.escType="customEmail";break;case ISQ.Widget.Escalate.enumType.customChat:b.escType="customChat";break;case ISQ.Widget.Escalate.enumType.chat:b.escType="chat";break}switch(j){case"noAction":if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=escalation&query="+ISQ.Tools.Base64.encodeString(b.query)+"&esctype="+b.escType)}g=f.getElementsByTagName("Text");h="";var c="";if(g.length>0){h=g[0].firstChild.nodeValue;c=g[0].getAttribute("status")}if(c){if(c==="readOnly"){h=ISQ.Cnf.readOnlyModeAlert||ISQ.Widget.Localize.array.readOnlyModeAlert;if(!h){h=ISQ.Widget.Texts.en["readOnlyModeAlert"]}}else{if(c==="success"){h=ISQ.Cnf.topicPostConfirmationText||ISQ.Widget.Localize.array.topicPostConfirmationText;if(!h){h=ISQ.Widget.Texts.en["topicPostConfirmationText"]
}}else{h=""}}if(h&&ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.initialUiLanguage)){ISQ.Translation.Infra.translate(h,null,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(ISQ.Widget.Escalate.showThankYouMessage))}else{if(h){ISQ.Widget.Escalate.showThankYouMessage(h)}}return}if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){ISQ.Widget.state=ISQ.Widget.enumState.questions}break;case"contactForm":if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=contactForm&query="+ISQ.Tools.Base64.encodeString(b.query))}ISQ.Widget.ContactForm.detectedLanguageKBExists=(f.getAttribute("detectedLanguageKBExists")==="True");ISQ.Widget.ContactForm.show(f.childNodes[0].nodeValue,f.childNodes[1].nodeValue);break;case"customLink":if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=escalation&query="+ISQ.Tools.Base64.encodeString(b.query)+"&esctype="+b.escType)}break}}catch(a){ISQ.Widget.Log.add("Escalate.parseResponse:"+a.message,ISQ.Widget.Log.statusEnum.RED)}};ISQ.Widget.Escalate.showThankYouMessage=function(a){ISQ.Widget.state=ISQ.Widget.enumState.questions;if(ISQ.Cnf.limited){ISQ.Widget.HTML.queryField.style.display="none";ISQ.Widget.HTML.queryField.style.visibility="hidden"}ISQ.Widget.Query.displayAnswers(true);ISQ.Widget.HTML.answerPane.style.display="block";ISQ.Widget.HTML.answerPane.innerHTML=a;ISQ.Widget.ContactForm.thankYouShown=true;ISQ.Widget.ContactForm.closeComplete()};ISQ.Widget.ContactForm={};ISQ.Widget.ContactForm.fader=null;ISQ.Widget.ContactForm.fader_submit=false;ISQ.Widget.ContactForm.blockedCreditCardReplacement="*";ISQ.Widget.ContactForm.closed=false;ISQ.Widget.ContactForm.thankYouShown=false;ISQ.Widget.ContactForm.canceled=false;ISQ.Widget.ContactForm.detectedLanguageKBExists=null;ISQ.Widget.ContactForm.preview=null;ISQ.Widget.ContactForm.preDefinedValues=[];ISQ.Widget.ContactForm.mSessionOpenTimer=null;ISQ.Widget.ContactForm.show=function(b,a){if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=showingContactForm",true);ISQ.Widget.HTML.contentWrapper.style.overflowY="hidden"
}ISQ.Widget.ContactForm.preview=new ISQ.WebForms.PreviewContact({container:_("contactForm"),hCancel:new ISQ.Handler(ISQ.Widget.ContactForm.onCancel),hSubmit:new ISQ.Handler(ISQ.Widget.ContactForm.onSubmit),hCSS:new ISQ.Handler(ISQ.Widget.ContactForm.FormLoaded),allowedFileExtensions:a});ISQ.Widget.HTML.answerPane.style.display="none";ISQ.Widget.ContactForm.preview.show(b);ISQ.Widget.ContactForm.preview.populateValues(ISQ.Widget.ContactForm.preDefinedValues,_query(true,false));ISQ.Widget.state=ISQ.Widget.enumState.contactForm;ISQ.Widget.ContactForm.thankYouShown=false;ISQ.Widget.ContactForm.closed=false;ISQ.Widget.ContactForm.canceled=false;_("answerPane").style.width="auto";_("contentArea").style.width="100%"};ISQ.Widget.ContactForm.close=function(c,b){if(ISQ.Widget.ContactForm.mSessionOpenTimer){clearTimeout(ISQ.Widget.ContactForm.mSessionOpenTimer);ISQ.Widget.ContactForm.mSessionOpenTimer=null;_session().stopOpenConnection()}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=hidingContactForm",true);ISQ.Widget.HTML.contentWrapper.style.overflowY="auto"}if(ISQ.Http.browser.isMobile&&!ISQ.Widget.sendingCDCMessages){var a=ISQ.Html.position(ISQ.Widget.HTML.contentWrapper).x;window.scrollTo(ISQ.Html.getScroll("left"),0)}else{if(!ISQ.Widget.isFloat&&ISQ.Widget.sendingCDCMessages){ISQ.Widget.CDC.sendMessage("subject=goUp")}}ISQ.Widget.ContactForm.fader_submit=c===true;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.contactForm)&&!b&&ISQ.Widget.ContactForm.fader){ISQ.Widget.ContactForm.fader.fadeOut(100)}else{ISQ.Widget.ContactForm.fadeOutHandler()}};ISQ.Widget.ContactForm.getPreDefinedValues=function(){if(!ISQ.Widget.ContactForm.preDefinedValues){return[]}var a=[];for(var b in ISQ.Widget.ContactForm.preDefinedValues){a[ISQ.Widget.ContactForm.preDefinedValues[b].name]=ISQ.Widget.ContactForm.preDefinedValues[b].value}return a};ISQ.Widget.ContactForm.mResizeContactForm=null;ISQ.Widget.ContactForm.FormLoaded=function(b,a){_session().initOpenConnection();if(ISQ.Widget.ContactForm.mSessionOpenTimer){clearTimeout(ISQ.Widget.ContactForm.mSessionOpenTimer)
}ISQ.Widget.ContactForm.mSessionOpenTimer=setTimeout(function(){_session().stopOpenConnection();ISQ.Widget.ContactForm.mSessionOpenTimer=null},60*1000*60);if(ISQ.Widget.HTML.isTeaser){ISQ.Widget.ContactForm.mResizeContactForm=function(){ISQ.Widget.ContactForm.FormLoaded(b,a)};ISQ.Widget.HTML.toNormal();return}if(ISQ.Http.browser.isTablet){ISQ.Widget.CDC.sendMessage("subject=showingContactForm")}if(ISQ.Http.browser.isIE7&&!a){setTimeout(function(){ISQ.Widget.ContactForm.FormLoaded(b,true)},500);return}if(b&&b.stopFadeEffect){ISQ.Widget.HTML.contactForm.style.display="block";ISQ.Widget.ContactForm.fadeInHandler()}else{if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.contactForm)){if(ISQ.Widget.ContactForm.fader===null){ISQ.Widget.ContactForm.fader=new VisualEffects.Fade(ISQ.Widget.HTML.contactForm);ISQ.Widget.ContactForm.fader.fadeOutEvent.addHandler(ISQ.Widget.ContactForm.fadeOutHandler);ISQ.Widget.ContactForm.fader.fadeInEvent.addHandler(ISQ.Widget.ContactForm.fadeInHandler)}ISQ.Widget.ContactForm.fader.setOpacity(0);ISQ.Widget.HTML.contactForm.style.display="block";ISQ.Widget.ContactForm.fader.fadeIn(200,true)}else{ISQ.Widget.HTML.contactForm.style.display="block";ISQ.Widget.ContactForm.fadeInHandler()}}if(b&&b.doScrollTop){if(!ISQ.Widget.sendingCDCMessages){window.scrollTo(0,0)}else{ISQ.Widget.CDC.sendMessage("subject=goUp")}}};ISQ.Widget.ContactForm.fadeInHandler=function(){if(ISQ.Cnf.showFooterWithContactForm===false){ISQ.Widget.HTML.footerWrapper.style.display="none"}ISQ.Widget.HTML.searchWrapper.style.display="none";ISQ.Widget.ContactForm.updateWidgetHeight()};ISQ.Widget.ContactForm.fadeOutHandler=function(){ISQ.Widget.HTML.searchWrapper.style.display="block";ISQ.Widget.HTML.contactForm.style.display="none";if(!ISQ.Widget.ContactForm.fader_submit){var a=ISQ.Widget.HTML.queryField.value.Trim().length==0;ISQ.Widget.Query.displayAnswers(a);if(ISQ.Widget.HTML.answerPane.restorePagerScroll){ISQ.Widget.HTML.answerPane.restorePagerScroll()}}else{ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.HTML.queryField.value=""
}if(ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){ISQ.Widget.CDC.sendMessage("subject=setMinWidth&width=0")}ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.HTML.searchWrapper.style.display="block";if(ISQ.Cnf.showFooterWithContactForm===false){ISQ.Widget.HTML.footerWrapper.style.display="block"}ISQ.Widget.ContactForm.closed=true;ISQ.Widget.ContactForm.closeComplete()};ISQ.Widget.ContactForm.updateWidgetHeight=function(a){ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage(false,ISQ.Widget.isFloat)};ISQ.Widget.ContactForm.onSubmit=function(b,a){if(!b){ISQ.Widget.ContactForm.updateWidgetHeight()}else{ISQ.Widget.Log.add("contactForm submit");ISQ.Widget.ContactForm.send(a);ISQ.Widget.ContactForm.close(true);ISQ.Widget.ContactForm.preview.dispose();ISQ.Widget.ContactForm.preview=null}};ISQ.Widget.ContactForm.onCancel=function(a){if(ISQ.Cnf.limited){return}ISQ.Widget.Log.add("contactForm cancel");ISQ.Widget.ContactForm.canceled=true;ISQ.Widget.ContactForm.close();ISQ.Widget.ContactForm.preview.dispose();ISQ.Widget.ContactForm.preview=null};ISQ.Widget.ContactForm.send=function(a){if(ISQ.Widget.Query.toTranslateContent(ISQ.Widget.Query.kbLanguageCode)){if(!ISQ.Widget.ContactForm.detectedLanguageKBExists){new ISQ.Widget.TranslationHelper.SubmittedFormTranslator({fromLanguage:ISQ.Widget.TranslationHelper.detectedLanguage,toLanguage:ISQ.Widget.Query.kbLanguageCode,contactForm:a,question:_query(true),handler:new ISQ.Handler(ISQ.Widget.ContactForm.send_internal)})}else{ISQ.Widget.ContactForm.send_internal(a,true)}}else{ISQ.Widget.ContactForm.send_internal(a)}};ISQ.Widget.ContactForm.externalIframe=null;ISQ.Widget.ContactForm.externalTimer=null;ISQ.Widget.ContactForm.send_internal=function(a,b){ISQ.Widget.Query.currentAnswers=null;if(a.postUrl){ISQ.Widget.ContactForm.externalIframe=ISQ.Html.createInvisibleIframe(new ISQ.Handler(function(e){ISQ.Html._doc=e;if(a.postUrl.startsWith("http://")&&"https:"==document.location.protocol){a.postUrl=a.postUrl.replace("http://","https://")}var c=createElement("form",e.body);
c.action=a.postUrl;c.method="post";if(a.redirectParam){var g=a.redirectParam;var d="https:"==document.location.protocol?"https://":"http://";createInput("hidden",g,c,d+ISQ.Http.domain(true)+"/common/contactForm/thankyou.html");ISQ.Widget.ContactForm.externalTimer=setTimeout(function(){ISQ.Widget.ContactForm.postToExternal_fail()},10000)}else{ISQ.Widget.ContactForm.externalTimer=setTimeout(function(){ISQ.Widget.ContactForm.postToExternalThankYou()},3000)}for(var f in a.values){createInput("hidden",a.values[f].name,c,a.values[f].value)}c.submit();ISQ.Html._doc=document},this))}else{_session().sendContactForm(ISQ.Widget.Escalate.parseResponse,ISQ.Widget.Query.firstAnswerId,a.values,_query(true),b?ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage):"",ISQ.Cnf.blockCreditCardNumbers?ISQ.Widget.ContactForm.blockedCreditCardReplacement:null,ISQ.Widget.Escalate.enumType.email)}};ISQ.Widget.ContactForm.postToExternal_fail=function(){if(ISQ.Widget.ContactForm.externalIframe){if(ISQ.Widget.ContactForm.externalIframe.parentNode){ISQ.Widget.ContactForm.externalIframe.parentNode.removeChild(ISQ.Widget.ContactForm.externalIframe)}ISQ.Widget.ContactForm.externalIframe=null}var a=ISQ.Widget.Localize.array.loginError;if(!a){a=ISQ.Widget.Texts.en["loginError"]}if(a&&ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.initialUiLanguage)){ISQ.Translation.Infra.translate(a,null,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(ISQ.Widget.Escalate.showThankYouMessage))}else{if(a){ISQ.Widget.Escalate.showThankYouMessage(a)}}};ISQ.Widget.ContactForm.postToExternalThankYou=function(){clearTimeout(ISQ.Widget.ContactForm.externalTimer);if(ISQ.Widget.ContactForm.externalIframe){if(ISQ.Widget.ContactForm.externalIframe.parentNode){ISQ.Widget.ContactForm.externalIframe.parentNode.removeChild(ISQ.Widget.ContactForm.externalIframe)}ISQ.Widget.ContactForm.externalIframe=null}var a=ISQ.Cnf.topicPostConfirmationText||ISQ.Widget.Localize.array.topicPostConfirmationText;if(!a){a=ISQ.Widget.Texts.en["topicPostConfirmationText"]
}if(a&&ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.initialUiLanguage)){ISQ.Translation.Infra.translate(a,null,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(ISQ.Widget.Escalate.showThankYouMessage))}else{if(a){ISQ.Widget.Escalate.showThankYouMessage(a)}}ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customEmail_fromContactForm,null,true)};ISQ.Widget.ContactForm.closeComplete=function(){if(!ISQ.Widget.ContactForm.closed||(!ISQ.Widget.ContactForm.thankYouShown&&!ISQ.Widget.ContactForm.canceled)){return}ISQ.Widget.HTML.highlightSearchFieldError();ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()};ISQ.Widget.ContactForm.incomingPreDefinedValuesFromMessage=function(a){var d=a.split(ISQ.Widget.APIKeyEndDelimiter);var c;for(var b=0;b<d.length;++b){c=d[b].split("(");if(c.length===3){ISQ.Widget.ContactForm.reportPreDefinedValue(ISQ.Http.Cookies.decode64(c[0]),ISQ.Http.Cookies.decode64(c[1]),ISQ.Http.Cookies.decode64(c[2]))}else{ISQ.Widget.ContactForm.reportPreDefinedValue(ISQ.Http.Cookies.decode64(c[0]),ISQ.Http.Cookies.decode64(c[1]))}}if((ISQ.Widget.state&ISQ.Widget.enumState.contactForm)!==0&&ISQ.Widget.ContactForm.preview){ISQ.Widget.ContactForm.preview.populateValues(ISQ.Widget.ContactForm.preDefinedValues,_query(true,false))}};ISQ.Widget.ContactForm.reportPreDefinedValue=function(a,c,b){b=b||"text";ISQ.Widget.ContactForm.preDefinedValues[a]=new ISQ.Widget.ContactForm.preDefinedValue(a,c,b)};ISQ.Widget.ContactForm.preDefinedValue=function(a,c,b){this.name=a;this.value=c;this.type=b};ISQ.Widget.ContactForm.preDefinedValue.prototype.name="";ISQ.Widget.ContactForm.preDefinedValue.prototype.value="";ISQ.Widget.ContactForm.preDefinedValue.prototype.type="";ISQ.Widget.CDC={};ISQ.Widget.CDC.lastMessage="load";ISQ.Widget.CDC.waitingForFrameToLoad=false;ISQ.Widget.CDC.nextMessage="";ISQ.Widget.CDC.user=null;ISQ.Widget.CDC.messageOrdinal_cdc2=0;ISQ.Widget.CDC.init=function(){var a;if(ISQ.Widget.isPreview){a=window.location.protocol+"//"+ISQ.Http.domain(true)}else{a=ISQ.Widget.referer.normal.substring(0,ISQ.Widget.referer.normal.indexOf("/",8))
}if(ISQ.Widget.sendingCDCMessages){if(ISQ.Widget.supportsPostMessage){ISQ.Widget.cdcVersion="3"}switch(ISQ.Widget.cdcVersion){case"1":case"2":break;case"3":ISQ.Widget.CDC.user=new ISQ.CDC.User({targetWindowName:"parent",proxyIFrameUrl:ISQ.Widget.cdcFrame,allowMessagesFrom:a,server:window.location.protocol+"//"+window.location.host});break}}if(!ISQ.Widget.CDC.user){ISQ.Widget.CDC.user=new ISQ.CDC.User({allowMessagesFrom:a})}ISQ.Widget.CDC.user.incomingMessageEvent.addHandler(ISQ.Widget.CDC.incomingMessage)};ISQ.Widget.CDC.incomingMessage=function(message){switch(message.subject){case"api":var formData=message.form;if(formData){if(ISQ.Http.browser.isMobile&&!ISQ.Widget.HTML.Mobile.adjustableEmbedWidth){ISQ.Widget.HTML.Mobile.formPredefinedData=formData}else{ISQ.Widget.ContactForm.incomingPreDefinedValuesFromMessage(formData)}}var custParams=message.customparams;if(custParams){ISQ.Widget.API.customParams=ISQ.Widget.CDC_getKeyValueArrayFromMessage(custParams,true)}var context=message.context;if(context){_session().setContext(ISQ.Widget.CDC_getKeyValueArrayFromMessage(context))}break;case"cnf":if(!ISQ.Cnf){ISQ.Cnf=[]}ISQ.Cnf.push(message.data);var finished=message.finished;if(finished){var completeCnf=ISQ.Cnf.join("");if(!completeCnf){return}ISQ.Cnf=eval("("+ISQ.Http.Cookies.decode64(completeCnf)+")");setTimeout(function(){ISQ.Widget.Cnf.postDownload()},0)}break;case"refreshSize":ISQ.Widget.HTML.resizeHandler(null,true);break;case"setHeight":ISQ.Widget.HTML.resizeHandler({w:ISQ.Html.screenSize().w,h:parseInt(message.size)},true);break;case"dynamicSizeRequest":ISQ.Widget.HTML.dynamicSize_sendMessage();break;case"openContactForm":var contactFormData=message.data?ISQ.Http.Cookies.decode64(message.data):null;if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){if((ISQ.Widget.state&ISQ.Widget.enumState.contactForm)===0){break}if(!contactFormData){break}ISQ.Widget.ContactForm.close(false,true)}if(contactFormData){ISQ.Widget.ContactForm.show(contactFormData)}else{ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email,null,true)
}break;case"customize":if(message.bgcolor){_("widgetTitleWrapper").style.backgroundColor=message.bgcolor;_("widgetContainer").style.borderColor=message.bgcolor}if(message.title){ISQ.Widget.customTitle=message.title;ISQ.Widget.HTML.titleText.innerHTML=message.title}break;case"startChat":if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){break}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.AutoQuestions.stop_()}var countStatsOnly=message.countstatsonly;if(countStatsOnly){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.enumChatEscalationActions.normal);break}if(!ISQ.Widget.iChat.instance||!ISQ.Widget.iChat.instance.available()){break}ISQ.Widget.Chat.requestChat();break;case"ask":if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){break}var q=message.question||"";ISQ.Widget.userActive=true;ISQ.Widget.Query.ask(q,ISQ.Widget.Query.enumTextQuerySource.api);if(ISQ.Widget.isFloat){setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=userWrites")},0)}break;case"askById":if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){break}var id=message.questionid||"";var sender=message.sender||"";if(id.length===0){break}ISQ.Widget.userActive=true;ISQ.Widget.Query.clearQuestionTrail();ISQ.Widget.Query.getAnswerById(id);ISQ.Widget.Query.clearTextboxOnInteraction=true;if(ISQ.Widget.isFloat){setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=userWrites")},0)}break;case"mobileOpenNewWindow":ISQ.Widget.HTML.Mobile.beforeOpeningWidget();break;case"closesession":_session().closeSession();setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=sessionclosed")},0);break;case"faqData":ISQ.Widget.FAQ.dataReady(ISQ.Http.Cookies.decode64(message.data));break;case"chatResumeApproved":ISQ.Widget.Chat.resumeChat(true);break;case"preventChatResuming":ISQ.Widget.Chat.preventChatResuming();break;case"chat":if(!ISQ.Widget.iChat.instance){return}ISQ.Widget.iChat.instance.handleCDCMessage(message);break;case"visitorId":if(!ISQ.Widget.iChat.instance){return
}ISQ.Widget.iChat.instance.setVisitorId(message.data);break}};ISQ.Widget.CDC.sendMessage=function(d,c){if(!ISQ.Widget.sendingCDCMessages){return}if(!d){return}c=c===true;d+="&widget="+(ISQ.Widget.isFloat?"float":"embed");if(ISQ.Widget.CDC.lastMessage===d&&!c){return}var b,a;switch(ISQ.Widget.cdcVersion){case"1":if(ISQ.Widget.CDC.waitingForFrameToLoad){ISQ.Widget.CDC.nextMessage=d;return}ISQ.Widget.CDC.waitingForFrameToLoad=true;ISQ.Widget.CDC.nextMessage="";b=_("iframeContainer");a=ISQ.Widget.CDC.createIFrame(b);if(ISQ.Http.browser.app==="opera"){a.onload=ISQ.Widget.CDC.frameOnload}else{if(document.addEventListener){a.addEventListener("load",ISQ.Widget.CDC.cdc1_frameLoad,true)}else{if(document.attachEvent){a.attachEvent("onload",ISQ.Widget.CDC.cdc1_frameLoad)}}}a.src=ISQ.Widget.cdcFrame+"?"+d;b.appendChild(a);var e;while(b.childNodes.length!==1){e=b.firstChild;if(ISQ.Http.browser.app==="opera"){e.onload=null}else{if(document.addEventListener){e.removeEventListener("load",ISQ.Widget.CDC.cdc1_frameLoad,true)}else{if(document.attachEvent){e.detachEvent("onload",ISQ.Widget.CDC.cdc1_frameLoad)}}}b.removeChild(e)}b=null;ISQ.Widget.CDC.lastMessage=d;break;case"2":b=_("iframeContainer");a=ISQ.Widget.CDC.createIFrame(b);if(ISQ.Http.browser.app==="opera"){a.onload=ISQ.Widget.CDC.cdc2_frameLoad}else{if(document.addEventListener){a.addEventListener("load",ISQ.Widget.CDC.cdc2_frameLoad,true)}else{if(document.attachEvent){a.attachEvent("onload",ISQ.Widget.CDC.cdc2_frameLoad)}}}a.src=ISQ.Widget.cdcFrame+"#"+d+"&ord="+(++ISQ.Widget.CDC.messageOrdinal_cdc2);b.appendChild(a);break;case"3":ISQ.Widget.CDC.user.sendMessage(d);break}};ISQ.Widget.CDC.cdc2_frameLoad=function(){var a=this;setTimeout(function(){if(a.parentNode){a.parentNode.removeChild(a)}},1000)};ISQ.Widget.CDC.cdc1_frameLoad=function(a){ISQ.Widget.CDC.waitingForFrameToLoad=false;if(ISQ.Widget.CDC.nextMessage!==""){ISQ.Widget.CDC.sendMessage(ISQ.Widget.CDC.nextMessage)}};ISQ.Widget.CDC.createIFrame=function(b){var a=createElement("iframe",null,"visibility:hidden;z-index:-1;border:0px;height:1px;width:1px;background:transparent;");
a.id="cdcFrame"+new Date().getTime();a.setAttribute("allowTransparency",true);a.setAttribute("frameBorder",false);return a};ISQ.Widget.Chat=initializeNS("ISQ.Widget.Chat");ISQ.Widget.Chat.enumChatLineType={user:0,agent:1,quickAnswer:2};ISQ.Widget.Chat.intuitiveInput=null;ISQ.Widget.Chat.chatStartAction=null;ISQ.Widget.Chat.selectedLinksToAnswers=null;ISQ.Widget.Chat.linksToAnswersBaseId=new Date().getTime();ISQ.Widget.Chat.widgetFooterContent=null;ISQ.Widget.Chat.mobileCss="";ISQ.Widget.Chat.chatConfig={};ISQ.Widget.Chat.init=function(){var chatConfig=ISQ.Widget.Chat.chatConfig=eval("("+ISQ.Cnf.chatConfiguration+")");switch(chatConfig.active){case"nR":ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.nR({account:ISQ.Widget.account,config:chatConfig,hIncomingMessage:new ISQ.Handler(ISQ.Widget.Chat.incomingMessageHandler),hChatStarted:new ISQ.Handler(ISQ.Widget.Chat.chatStartedHandler),hChatEnded:new ISQ.Handler(ISQ.Widget.Chat.chatStoppedHandler),hAgentTyping:new ISQ.Handler(ISQ.Widget.Chat.agentTypingHandler),hResumingChat:new ISQ.Handler(ISQ.Widget.Chat.chatResumed),hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested),hChatAvailableChanged:new ISQ.Handler(ISQ.Widget.Chat.chatAvailableChanged),hConnectionError:new ISQ.Handler(ISQ.Widget.Chat.connectionError)});break;case"LP":ISQ.Tools.FileLoader.load("/widget/scripts/livePersonV3.js",new ISQ.Handler(function(tag){ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.LP({config:chatConfig,hIncomingMessage:new ISQ.Handler(ISQ.Widget.Chat.incomingMessageHandler),hChatStarted:new ISQ.Handler(ISQ.Widget.Chat.chatStartedHandler),hChatEnded:new ISQ.Handler(ISQ.Widget.Chat.chatStoppedHandler),hAgentTyping:new ISQ.Handler(ISQ.Widget.Chat.agentTypingHandler),hResumingChat:new ISQ.Handler(ISQ.Widget.Chat.chatResumed),hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested),hChatAvailableChanged:new ISQ.Handler(ISQ.Widget.Chat.chatAvailableChanged),hConnectionError:new ISQ.Handler(ISQ.Widget.Chat.connectionError),hShowActionBar:new ISQ.Handler(ISQ.Widget.Query.showActionBar)})
}),this);break;case"LiveChatInc":if(!chatConfig.LiveChatInc){return}ISQ.Tools.FileLoader.load("/widget/scripts/livechatinc.js",new ISQ.Handler(function(tag){ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.LiveChatInc({config:chatConfig,hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested)})}),this);break;case"SnapEngage":if(!chatConfig.SnapEngage){return}ISQ.Tools.FileLoader.load("/widget/scripts/snapengage.js",new ISQ.Handler(function(tag){ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.SnapEngage({config:chatConfig,hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested)})}),this);break;case"Zopim":if(!chatConfig.Zopim){return}ISQ.Tools.FileLoader.load("/widget/scripts/zopim.js",new ISQ.Handler(function(tag){ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.Zopim({config:chatConfig,hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested)})}),this);break;case"Olark":if(!chatConfig.Olark){return}ISQ.Tools.FileLoader.load("/widget/scripts/olark.js",new ISQ.Handler(function(tag){ISQ.Widget.Chat.settingUI();new ISQ.Widget.Chat.Olark({config:chatConfig,hChatRequested:new ISQ.Handler(ISQ.Widget.Chat.chatRequested)})}),this);break;default:return}};ISQ.Widget.Chat.settingUI=function(){ISQ.Widget.Chat.mobileCss=ISQ.Http.browser.isMobile?" &.mobile":"";ISQ.Widget.Chat.intuitiveInput=new ISQ.GUI.IntuitiveInput({input:_("txtChatInput"),onTimeElapsedHandler:new ISQ.Handler(ISQ.Widget.Chat.chatInput_userTypes),enterKeyHandler:new ISQ.Handler(ISQ.Widget.Chat.chatInput_enterKeyup),onBeginWritingHandler:new ISQ.Handler(function(){ISQ.Widget.iChat.instance.userTyping(true)})});ISQ.Data.autoEllipseText(ISQ.Widget.getStaticText("closeChat"),69,_("closeChat"));_("btnSendChat").value=_("ancEmailChatSend").innerHTML=ISQ.Widget.getStaticText("sendChat");_("emailChatLink").innerHTML=ISQ.Widget.getStaticText("emailChat");_("ancEmailChatCancel").innerHTML=ISQ.Widget.getStaticText("cancel")};ISQ.Widget.Chat.chatResumed=function(){ISQ.Widget.Log.add("resuming chat");ISQ.Widget.Chat.requestChat()};ISQ.Widget.Chat.requestChat=function(a){if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){return false
}if(!ISQ.Widget.iChat.instance.available()){this.chatAvailableChanged(false);return false}else{ISQ.Widget.Chat.intuitiveInput.enable();ISQ.Widget.state=ISQ.Widget.enumState.chat;if(typeof(a)==="undefined"){a=ISQ.Widget.enumChatEscalationActions.normal}ISQ.Widget.Chat.chatStartAction=a;ISQ.Widget.HTML.Mobile.hideAddressbar();return ISQ.Widget.iChat.instance.requestChat()}};ISQ.Widget.Chat.chatAvailableChanged=function(a){if(ISQ.Widget.state==ISQ.Widget.enumState.chat&&!a&&!ISQ.Widget.iChat.instance.inChat()){ISQ.Widget.Chat.endChat(false,true);ISQ.Widget.Escalate.toEmail()}if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=chatavailable&value="+a)}};ISQ.Widget.Chat.perpareForIntegratedChat=function(b,a){ISQ.Widget.HTML.searchWrapper.style.display="none";ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));ISQ.Widget.HTML.answerPane.style.display="none";ISQ.Widget.HTML.chatPane.style.display="block";if(ISQ.Widget.Chat.intuitiveInput){ISQ.Widget.Chat.intuitiveInput.resetValue()}ISQ.Widget.HTML.dynamicSize_sendMessage();clearNode(ISQ.Widget.HTML.chatPane)};ISQ.Widget.Chat.chatRequested=function(a){switch(a){case ISQ.Widget.iChat.enumRequestChatStatus.inChat:return;case ISQ.Widget.iChat.enumRequestChatStatus.popup:_("repByChat").href=arguments[1];ISQ.Widget.HTML.hideActionBar(function(){ISQ.Widget.state=ISQ.Widget.enumState.questions});ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.Chat.chatStartAction);break;case ISQ.Widget.iChat.enumRequestChatStatus.preChat:if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=startChat")}ISQ.Widget.Query.hidePopularSuggestions(_("searchSuggestions"));ISQ.Widget.state=ISQ.Widget.enumState.chatSurvey;ISQ.Widget.HTML.actionBarQuery.style.display="none";ISQ.Widget.HTML.chatInputWrapper.style.display="none";ISQ.Widget.HTML.showActionBar();break;case ISQ.Widget.iChat.enumRequestChatStatus.requestingChat:ISQ.Widget.Chat.perpareForIntegratedChat();ISQ.Widget.HTML.actionBarQuery.style.display="none";ISQ.Widget.state=ISQ.Widget.enumState.chat;
ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.HTML.chatStatus.originalText=(ISQ.Widget.Chat.chatConfig&&ISQ.Widget.Chat.chatConfig.initialStatus)?ISQ.Widget.Chat.chatConfig.initialStatus:ISQ.Widget.getStaticText("chatCallingStatus");_("chatStatusWrapper").style.display="block";ISQ.Widget.HTML.Mobile.setScrollPaddingHeight(true);ISQ.Widget.HTML.showActionBar();if(ISQ.Widget.iChat.instance.supportingEmailChat()&&!ISQ.Widget.Chat.chatConfig.hideSendToEmail){_("emailChatLink").style.display="block"}else{_("emailChatLink").style.display="none"}_("actionBarChat").style.display="block";if(ISQ.Cnf.customerBrandingLogo){_("customerLogo").style.display="none"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="none"}ISQ.Widget.HTML.chatInputWrapper.style.display="block";if(ISQ.Http.browser.isIPhone){++document.body.scrollTop}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=startChat")}ISQ.Widget.HTML.resizeHandler();ISQ.Widget.iChat.instance.sendMessage(_query(true));ISQ.Widget.HTML.dynamicSize_sendMessage();if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=requestChat")}if(ISQ.Widget.iChat.instance.userActive()){clearNode(_("chatPane"));ISQ.Widget.Chat.appendMyLine(_query(true))}break;case ISQ.Widget.iChat.enumRequestChatStatus.newChat:break;case ISQ.Widget.iChat.enumRequestChatStatus.resumingChat:ISQ.Widget.CDC.sendMessage("subject=chatResumeRequest");break}};ISQ.Widget.Chat.resumeChat=function(a){if(a){var b=ISQ.Widget.iChat.instance.pendingMessages();if(b){_it(b,function(c){ISQ.Widget.Chat.incomingMessageHandler(c)})}}};ISQ.Widget.Chat.preventChatResuming=function(){ISQ.Widget.iChat.instance.setChatNotActive();ISQ.Widget.Chat.endChat(false,true);return false};ISQ.Widget.Chat.incomingMessageHandler=function(e){var f=new Array();var c;var b=_("chatStatusSystem");switch(e.type){case ISQ.Widget.iChat.enumMessageType.visitor_id:case ISQ.Widget.iChat.enumMessageType.agent_id:ISQ.Widget.Chat.appendSuggestionsToGUI(e);break;case ISQ.Widget.iChat.enumMessageType.visitor_text:if(e.resuming){ISQ.Widget.Chat.appendMyLine(e.text)
}clearNode(b);return;case ISQ.Widget.iChat.enumMessageType.agent_text:clearNode(b);var d="chatLine_"+Math.floor(Math.random()*1000000);var a=createDiv(null,".chatLine");createDiv(a,".agentIcon");c=createDiv(a,".padded "+ISQ.Widget.Chat.mobileCss+" &.agent");c.id=d;f.push("<span class='chatAgentName'>");f.push(ISQ.Widget.iChat.instance.agentName());f.push(":</span> ");f.push(e.text);c.innerHTML=f.join("");ISQ.Widget.Chat.appendLine(a,d);break;case ISQ.Widget.iChat.enumMessageType.system:var d="chatLine_"+Math.floor(Math.random()*1000000);c=createDiv(null,".padded chatSysMsg");c.id=d;c.innerHTML=e.text;b.style.display="block";clearNode(b);b.appendChild(c);break}ISQ.Widget.HTML.resizeHandler()};ISQ.Widget.Chat.chatStartedHandler=function(){if(!ISQ.Widget.iChat.instance.resumingChat()){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.Chat.chatStartAction)}ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.HTML.chatStatus.originalText=ISQ.Widget.getStaticText("chattingNow")+'<span dir="ltr" class="chatStatusAgentName">'+ISQ.Widget.iChat.instance.agentName()+"</span>";if(ISQ.Http.browser.isIE9){ISQ.Widget.HTML.contentWrapper.style.overflow="auto"}if(ISQ.Widget.iChat.instance.resumingChat()){ISQ.Widget.HTML.scrollContentToBottom()}_session().initOpenConnection()};ISQ.Widget.Chat.agentTypingHandler=function(a){if(!a){ISQ.Widget.HTML.chatStatus.className="agentTyping";ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chattingNow")+'<span dir="ltr" class="chatStatusAgentName">'+ISQ.Widget.iChat.instance.agentName()+"</span>"}else{ISQ.Widget.HTML.chatStatus.className="";ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.iChat.instance.agentName()+ISQ.Widget.getStaticText("chatTyping")}};ISQ.Widget.Chat.chatStoppedHandler=function(a){if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0){return}if(a){ISQ.Widget.Chat.endChat(false,true)}else{ISQ.Widget.state=ISQ.Widget.enumState.chatEnded;ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chatClosed");_("chatPane").innerHTML+=ISQ.Widget.getStaticText("chatClosed")+".<br/>";
ISQ.Widget.Chat.intuitiveInput.disable()}_session().stopOpenConnection()};ISQ.Widget.Chat.connectionError=function(){ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chatConnectionError");_("chatPane").innerHTML+=ISQ.Widget.getStaticText("chatConnectionError")+".<br/>"};ISQ.Widget.Chat.ignoreSendingLineOnEnter=false;ISQ.Widget.Chat.pendingSuggestions=null;ISQ.Widget.Chat.hideSuggestionDiv=function(){ISQ.Widget.Chat.ignoreSendingLineOnEnter=false;if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){if(ISQ.Widget.isFloat){ISQ.Widget.HTML.footerWrapper.style.visibility="visible"}else{if(ISQ.Widget.Chat.widgetFooterContent){ISQ.Widget.HTML.widgetFooter.innerHTML=ISQ.Widget.Chat.widgetFooterContent}}}};ISQ.Widget.Chat.chatInput_userTypes=function(b,a){ISQ.Widget.iChat.instance.userTyping(false);if(!a){return}if(!b){ISQ.Widget.Query.hidePopularSuggestions(_("chatSuggestions"));ISQ.Widget.Chat.hideSuggestionDiv();return}ISQ.Widget.Query.popularSuggestions(b,{container:_("chatSuggestions"),maxResults:2,eventsHandler:function(e,c,d){if(e!=="click"){return}ISQ.Widget.Chat.hideSuggestionDiv();ISQ.Widget.Chat.intuitiveInput.resetValue();_session().getAnswerById(ISQ.Widget.Chat.getAnswerById_response,c,++ISQ.Widget.Query.activeRequestId)},documentEventsHandler:function(d,c){if(d==="up"&&c===-1){ISQ.Widget.Chat.ignoreSendingLineOnEnter=false}else{if(d==="down"){ISQ.Widget.Chat.ignoreSendingLineOnEnter=true}}},onDrawHandler:function(){if(!ISQ.Widget.Chat.intuitiveInput.value()){ISQ.Widget.Chat.hideSuggestionDiv()}if(ISQ.Http.browser.isMobile){var c=ISQ.CSS.getElementHeight(_("chatSuggestions"),true);_("chatSuggestions").style.top=(-c)+"px"}if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){if(ISQ.Widget.isFloat){ISQ.Widget.HTML.footerWrapper.style.visibility="hidden"}else{ISQ.Widget.Chat.widgetFooterContent=ISQ.Widget.HTML.widgetFooter.innerHTML;ISQ.Widget.HTML.widgetFooter.innerHTML=""}}},verbose:true})};ISQ.Widget.Chat.chatInput_enterKeyup=function(){if(ISQ.Widget.Chat.ignoreSendingLineOnEnter){return false}ISQ.Widget.Chat.sendLine()
};ISQ.Widget.Chat.quickAnswerPicked=function(a){ISQ.Widget.Chat.appendSuggestionsToGUI(a);ISQ.Widget.iChat.instance.sendAnswerId(a)};ISQ.Widget.Chat.sendButtonClicked=function(){ISQ.Widget.Query.hidePopularSuggestions(_("chatSuggestions"));ISQ.Widget.Chat.sendLine()};ISQ.Widget.Chat.sendLine=function(){ISQ.Widget.Chat.hideSuggestionDiv();var a=_("txtChatInput").value.Trim();if(!a){return}ISQ.Widget.Chat.intuitiveInput.resetValue();if(ISQ.Cnf.blockCreditCardNumbers){a=ISQ.Data.blockCreditCardNumbers(a,ISQ.Widget.ContactForm.blockedCreditCardReplacement)}ISQ.Widget.iChat.instance.sendMessage(a);ISQ.Widget.Chat.appendMyLine(a)};ISQ.Widget.Chat.appendSuggestionsToGUI=function(b){if(!b.body){return}var d=ISQ.Data.getDBAnswerAsHtml(b.body,false,ISQ.Widget.Chat.appendLinksToNanoRepQuestions,null,null,ISQ.Widget.referer.normal).text;d=d.replaceAll(ISQ.Tools.pagerSeperator,"");var a="";var e=ISQ.Data.uniqueId();div=createDiv(null,".quickAnswer");div.id="chatSDiv_"+e;var c=new Array();c.push("<div class='quickAnswerHeading'>");c.push(ISQ.Widget.getStaticText("quickAnswer"));c.push("</div> ");c.push("<div class='quickAnswerContainer'>");c.push("<table cellpadding='0' cellspacing='0'>");c.push("<tr valign='top' onclick='ISQ.Widget.Chat.toggleQuickAnswer(\""+e+"\")' style='cursor:pointer'>");c.push("<td class='quickAnswerExpandIcon'><div class='quickAnswerExpand' id='quickAnswerExpand_"+e+"'></div></td>");c.push("<td class='quickAnswerTitle'>");c.push(b.title);c.push("<td></tr></table>");c.push("<div class='quickAnswerBody' id='quickAnswerBody_"+e+"'>");c.push(d);if(b.attachments){ISQ.Widget.Query.appendAttachments(b.attachments,c)}c.push("</div>");c.push("</div>");div.innerHTML=c.join("");ISQ.Widget.Chat.appendLine(div,div.id);ISQ.Widget.Chat.toggleQuickAnswer(e)};ISQ.Widget.Chat.appendLinksToNanoRepQuestions=function(c,a,d){var b="linkToAnswer_"+(ISQ.Widget.Chat.linksToAnswersBaseId++);c.push("<a id='");c.push(b);c.push("' href='javascript:void(0)' onclick='ISQ.Widget.Chat.questionLinkClicked(this, \"");c.push(a);c.push("\")'>");
c.push(d);c.push("</a>")};ISQ.Widget.Chat.questionLinkClicked=function(b,a){if(!ISQ.Widget.Chat.selectedLinksToAnswers){ISQ.Widget.Chat.selectedLinksToAnswers=new Array()}if(ISQ.Widget.Chat.selectedLinksToAnswers[b.id]===true){return}ISQ.Widget.Chat.selectedLinksToAnswers[b.id]=true;_session().getAnswerById(ISQ.Widget.Chat.getAnswerById_response,a,++ISQ.Widget.Query.activeRequestId)};ISQ.Widget.Chat.getAnswerById_response=function(d){if((ISQ.Widget.state&ISQ.Widget.enumState.chat)===0){return}ISQ.Widget.Log.add("Chat question link response: Parsing answers");if(d.xml===null){ISQ.Widget.Log.add("Chat question link response: Illegal xml");return}var e=d.xml.getElementsByTagName("Results");if(e.length===0){ISQ.Widget.Log.add("Chat question link response: Illegal xml");return}var f=e[0];var c=f.getAttribute("requestId");if(ISQ.Widget.Query.activeRequestId!=c){ISQ.Widget.Log.add("Chat question link response: Request Id doesn't match. sent: "+ISQ.Widget.Query.activeRequestId+", received: "+c);return}var j=f.getElementsByTagName("Topic");if(j.length===0){ISQ.Widget.Log.add("Chat question link response: no results");return}var h=j[0].getElementsByTagName("title")[0].firstChild.nodeValue;var g=j[0].getElementsByTagName("Summary")[0].firstChild.nodeValue;var a=j[0].getElementsByTagName("attachments").length!=0?j[0].getElementsByTagName("attachments")[0].firstChild.nodeValue:"";var b=j[0].getAttribute("id");ISQ.Widget.Chat.quickAnswerPicked({id:b,title:h,body:g,attachments:a})};ISQ.Widget.Chat.appendMyLine=function(e){if(!e){return}var d=new Array();var f=Math.floor(Math.random()*1000000);var c="chatLine_"+f;var a=createDiv(null,".chatLine");createDiv(a,".clientIcon");var b=createDiv(a,".padded "+ISQ.Widget.Chat.mobileCss+" &.client");b.id=c;b.uniqueId=f;d.push("<b class='chatMe'>");d.push(ISQ.Widget.Localize.array.me);d.push(":</b> ");d.push(e);b.innerHTML=d.join("");ISQ.Widget.Chat.appendLine(a,c);return b};ISQ.Widget.Chat.appendLine=function(d,c){var b=_("chatPane");var l=ISQ.Widget.HTML.contentWrapper;b.appendChild(d);ISQ.Widget.HTML.fixContentWidths();
if(c){if(ISQ.Http.browser.isMobile&&(window.top===window||self===self.top)){var e=ISQ.Http.browser.app=="ff";var f=ISQ.Html.position(c);var g=ISQ.Html.screenSize();g.h-=(ISQ.Widget.HTML.Mobile.incrementedBottom+50);var j=e?document.documentElement.scrollTop:document.body.scrollTop;var a=j+g.h;if(f.y<j||f.y>a){if(e){document.documentElement.scrollTop=f.y}else{document.body.scrollTop=f.y}}}else{var h=b.scrollHeight;var k=l.offsetHeight;if(h>k){l.scrollTop=_(c).offsetTop-b.offsetTop}}}};ISQ.Widget.Chat.toggleQuickAnswer=function(c){var b=_("quickAnswerExpand_"+c);var a=_("quickAnswerBody_"+c);if(a.style.display==="none"){a.style.display="block";b.className="quickAnswerExpand"}else{a.style.display="none";b.className="quickAnswerExpand quickAnswerCollapsed"}};ISQ.Widget.Chat.prepereSurveyPane=function(){ISQ.Widget.state=ISQ.Widget.enumState.chatSurvey;ISQ.Widget.HTML.answerPane.style.display="none";ISQ.Widget.HTML.searchWrapper.style.display="none";clearNode(ISQ.Widget.HTML.chatPane);ISQ.Widget.HTML.chatPane.style.display="block";ISQ.Widget.Query.hidePopularSuggestions(_("chatSuggestions"));ISQ.Widget.HTML.actionBarQuery.style.display="none";ISQ.Widget.HTML.chatInputWrapper.style.display="none";ISQ.Widget.HTML.showActionBar()};ISQ.Widget.Chat.endChat=function(d,b){if(!b&&!d&&!confirm(ISQ.Widget.Localize.array.confirmEndChat)){return}ISQ.Widget.iChat.instance.endChat();ISQ.Widget.Query.hidePopularSuggestions(_("chatSuggestions"));var a=!d&&(!_query(true)||!ISQ.Widget.userActive);ISQ.Widget.Chat.pendingSuggestions=null;ISQ.Widget.HTML.searchWrapper.style.display="block";_("chatStatusWrapper").style.display="none";ISQ.Widget.HTML.Mobile.setScrollPaddingHeight(false);try{ISQ.Widget.Query.setFocus()}catch(c){}if(!a){ISQ.Widget.HTML.answerPane.style.display="block"}_("chatPane").style.display="none";ISQ.Widget.HTML.contentWrapper.scrollTop=0;if(!a&&_query(true,false)&&ISQ.Widget.userActive){ISQ.Widget.HTML.showActionBar()}else{ISQ.Widget.HTML.hideActionBar(null,true)}ISQ.Widget.HTML.actionBarQuery.style.display="block";_("actionBarChat").style.display="none";
_("footerChatLink").style.display="none";if(ISQ.Cnf.customerBrandingLogo){_("customerLogo").style.display="block"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="block"}ISQ.Widget.HTML.chatInputWrapper.style.display="none";if(ISQ.Widget.HTML.answerPane.restorePagerScroll){ISQ.Widget.HTML.answerPane.restorePagerScroll()}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=endChat")}ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage();ISQ.Widget.state=ISQ.Widget.enumState.questions;if(!ISQ.Widget.userActive&&!ISQ.Widget.FAQ.shown){ISQ.Widget.FAQ.show(ISQ.Widget.FAQ.behavior.OnNoResuls)}ISQ.Widget.Chat.emailChat_txtToggle(false);_session().chatEnded()};ISQ.Widget.Chat.pageUnload=function(){};ISQ.Widget.Chat.emailChat_Show=function(){ISQ.Widget.HTML.txtEmailChat.defaultValue=ISQ.Widget.HTML.txtEmailChat.value=ISQ.Widget.Localize.array.enterEmail;ISQ.Widget.Chat.emailChat_txtToggle(true)};ISQ.Widget.Chat.emailChat_Hide=function(){ISQ.Widget.Chat.emailChat_txtToggle(false)};ISQ.Widget.Chat.emailChat_txtFocus=function(){if(ISQ.Widget.HTML.txtEmailChat.value==ISQ.Widget.HTML.txtEmailChat.defaultValue){ISQ.Widget.HTML.txtEmailChat.value=""}};ISQ.Widget.Chat.emailChat_txtBlur=function(){if(ISQ.Widget.HTML.txtEmailChat.value==""){ISQ.Widget.HTML.txtEmailChat.value=ISQ.Widget.HTML.txtEmailChat.defaultValue}};ISQ.Widget.Chat.emailChat_txtToggle=function(a){if(ISQ.Widget.Chat.chatConfig.hideSendToEmail){_("emailChatLink").style.display="none";_("emailChatContainer").style.display="none"}else{if(a){_("emailChatLink").style.display="none";_("emailChatContainer").style.display="block"}else{_("emailChatLink").style.display="block";_("emailChatContainer").style.display="none"}}};ISQ.Widget.Chat.emailChat_Send=function(){if(ISQ.Cnf.chatHideSendToMail){return}var a=ISQ.Widget.HTML.txtEmailChat.value;if(!a){return}if(!ISQ.Data.checkString(a,"email")){alert(ISQ.Widget.Localize.array.emailValidation);return}ISQ.Widget.iChat.instance.emailChat(a);alert(ISQ.Widget.getStaticText("emailChatSent"));
ISQ.Widget.Chat.emailChat_txtToggle(false)};ISQ.Widget.enumCustomLinkTarget={CurrentPage:0,NewTab:1,Popup:2,Widget:3};ISQ.Widget.enumShowChatConfiguration={always:0,selectedAnswers:1,selectedAnswers_and_noAnswers:2};ISQ.Widget.enumChatEscalationActions={hide:0,normal:1,showChatOption:2,inviteChat:3,pushChat:4};ISQ.Widget.enumCustomLinkStats={none:0,countTicketEscalation:1,countChatEscalation:2};ISQ.Widget.enumKBCategoriesFlags={none:0,visibleInWidget:1,autoLearn:2,all:3};ISQ.Widget.API={};ISQ.Widget.API.customParams=null;ISQ.Widget.API.getCurrentURL=function(){return ISQ.Widget.referer.normal};ISQ.Widget.API.getCustomParams=function(){return ISQ.Widget.API.customParams||{}};ISQ.Widget.API.openContactForm=function(){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email)};ISQ.Widget.API.updateContext=function(d,b){var c=null;if(!b){c=_session().mContexts}if(!c||b===true){c=d}else{for(var a in d){c[a.toLowerCase()]=d[a]}}_session().setContext(c||[])};ISQ.Widget.API.reAsk=function(){ISQ.Widget.Query.timerElapsedHandler(_query(true),true)};ISQ.Widget.API.runPageScript=function(a){if(!a){return}ISQ.Widget.CDC.sendMessage("subject=pagescript&data="+ISQ.Tools.Base64.encodeString(a))};