
(function($){$.fn.tipuedrop=function(options){var set=$.extend({'show':5,'speed':300,'newWindow':false,'mode':'static','contentLocation':'tipuedrop/tipuedrop_content.json'},options);return this.each(function(){var tipuedrop_in={pages:[]};var lastText='';if(set.mode=='static')
{tipuedrop_in=$.extend({},tipuedrop);}
$(this).keypress(function(event)
{if(event.which==13)
{event.preventDefault();return false;}}).keyup(function(event)
{if(set.mode=='json')
{$this=$(this);if($this.val().length<2)
{$('#tipue_drop_content').fadeOut(set.speed);return;}
else if(lastText==$this.val())
return;if(tipuedrop_in.pages.length==0)
{$('#tipue_drop_content').html('<div class="tipue_drop_no_items">Loading...</div>');$('#tipue_drop_content').fadeIn(set.speed);}
typewatch(function(){lastText=$this.val();$.getJSON(set.contentLocation+'?q='+lastText,function(json)
{tipuedrop_in=$.extend({},json);if(event.which==27)
$('#tipue_drop_content').fadeOut(set.speed);else
getTipuedrop($this);});},100);}});function getTipuedrop($obj)
{if($obj.val())
{var out='';var c=0;for(var i=0;i<tipuedrop_in.pages.length;i++)
{var pat=new RegExp($obj.val(),'i');if((tipuedrop_in.pages[i].title.search(pat)!=-1||tipuedrop_in.pages[i].text.search(pat)!=-1||tipuedrop_in.pages[i].tags.search(pat)!=-1)&&c<set.show)
{out+='<a href="'+tipuedrop_in.pages[i].loc+'"';if(set.newWindow)
{out+=' target="_blank"';}
out+='><div class="tipue_drop_item"><div class="tipue_drop_left"><img src="'+tipuedrop_in.pages[i].thumb+'" class="tipue_drop_image"></div><div class="tipue_drop_right"><div class="tipue_drop_right_title">'+tipuedrop_in.pages[i].title+'</div><div class="tipue_drop_right_text">'+tipuedrop_in.pages[i].text+'</div></div><div style="clear: both;"></div></div></a>';c++;}}
if(c==0)
{out+='<div class="tipue_drop_no_items">Nothing found</div>';}
$('#tipue_drop_content').html(out);$('#tipue_drop_content').fadeIn(set.speed);}
else
{$('#tipue_drop_content').fadeOut(set.speed);}}
$('html').click(function(){$('#tipue_drop_content').fadeOut(set.speed);});});};var typewatch=(function(){var timer=0;return function(callback,ms){clearTimeout(timer);timer=setTimeout(callback,ms);}})();})(jQuery);