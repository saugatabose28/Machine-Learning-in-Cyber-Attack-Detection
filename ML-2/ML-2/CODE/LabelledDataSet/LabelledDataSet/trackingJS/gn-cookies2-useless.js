function getCookieVal(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1)endstr=document.cookie.length;return unescape(document.cookie.substring(offset,endstr))}function FixCookieDate(date){var base=new Date(0);var skew=base.getTime();if(skew>0)date.setTime(date.getTime()-skew)}
function GetCookie(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;while(i<clen){var j=i+alen;if(document.cookie.substring(i,j)==arg)return getCookieVal(j);i=document.cookie.indexOf(" ",i)+1;if(i==0)break}return null}function SetCookie(name,value,expires,path,domain,secure){var foo=name+"="+escape(value)+(expires?"; expires="+expires.toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"; secure":"");document.cookie=foo}
function DeleteCookie(name,path,domain){if(GetCookie(name))document.cookie=name+"="+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}
function Querystring(qs){this.params={};this.paramNames=new Array;if(qs==null)qs=location.search.substring(1,location.search.length);if(qs.length==0)return;qs=qs.replace(/\+/g," ");var args=qs.split("&");for(var i=0;i<args.length;i++){var pair=args[i].split("=");var name=decodeURIComponent(pair[0]);this.paramNames.push(name);var value=pair.length==2?decodeURIComponent(pair[1]):name;this.params[name]=value}}
Querystring.prototype.get=function(key,default_){var value=this.params[key];return value!=null?value:default_};Querystring.prototype.contains=function(key){var value=this.params[key];return value!=null};function getCookieDate(numDays){var expdate=new Date;FixCookieDate(expdate);expdate.setTime(expdate.getTime()+numDays*24*60*60*1E3);return expdate}var COOKIE_EXP_DAYS=180;function setTurnCookie(name,value){var expdate=getCookieDate(COOKIE_EXP_DAYS);SetCookie(name,value,expdate,"/","")}
var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function encodeBase64(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;var utftext="";input=input.replace(/\r\n/g,"\n");for(var n=0;n<input.length;n++){var c=input.charCodeAt(n);if(c<128)utftext+=String.fromCharCode(c);else if(c>127&&c<2048){utftext+=String.fromCharCode(c>>6|192);utftext+=String.fromCharCode(c&63|128)}else{utftext+=String.fromCharCode(c>>12|224);utftext+=String.fromCharCode(c>>6&63|128);utftext+=String.fromCharCode(c&63|128)}}input=utftext;while(i<input.length){chr1=
input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=(chr1&3)<<4|chr2>>4;enc3=(chr2&15)<<2|chr3>>6;enc4=chr3&63;if(isNaN(chr2))enc3=enc4=64;else if(isNaN(chr3))enc4=64;output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4)}return output};